// @bun
var eW=Object.create;var{getPrototypeOf:ZV,defineProperty:c1,getOwnPropertyNames:BZ,getOwnPropertyDescriptor:$V}=Object,AZ=Object.prototype.hasOwnProperty;var YV=(Z,$,Y)=>{Y=Z!=null?eW(ZV(Z)):{};const Q=$||!Z||!Z.__esModule?c1(Y,"default",{value:Z,enumerable:!0}):Y;for(let W of BZ(Z))if(!AZ.call(Q,W))c1(Q,W,{get:()=>Z[W],enumerable:!0});return Q},PZ=new WeakMap,QV=(Z)=>{var $=PZ.get(Z),Y;if($)return $;if($=c1({},"__esModule",{value:!0}),Z&&typeof Z==="object"||typeof Z==="function")BZ(Z).map((Q)=>!AZ.call($,Q)&&c1($,Q,{get:()=>Z[Q],enumerable:!(Y=$V(Z,Q))||Y.enumerable}));return PZ.set(Z,$),$};var O=(Z,$)=>()=>($||Z(($={exports:{}}).exports,$),$.exports);var WV=(Z,$)=>{for(var Y in $)c1(Z,Y,{get:$[Y],enumerable:!0,configurable:!0,set:(Q)=>$[Y]=()=>Q})};var VV=(Z,$)=>()=>(Z&&($=Z(Z=0)),$);var f4=O((uH,U$)=>{var S8=Object.prototype.hasOwnProperty,H$=Object.prototype.toString,V$=Object.defineProperty,J$=Object.getOwnPropertyDescriptor,X$=function Z($){if(typeof Array.isArray==="function")return Array.isArray($);return H$.call($)==="[object Array]"},K$=function Z($){if(!$||H$.call($)!=="[object Object]")return!1;var Y=S8.call($,"constructor"),Q=$.constructor&&$.constructor.prototype&&S8.call($.constructor.prototype,"isPrototypeOf");if($.constructor&&!Y&&!Q)return!1;var W;for(W in $);return typeof W==="undefined"||S8.call($,W)},z$=function Z($,Y){if(V$&&Y.name==="__proto__")V$($,Y.name,{enumerable:!0,configurable:!0,value:Y.newValue,writable:!0});else $[Y.name]=Y.newValue},w$=function Z($,Y){if(Y==="__proto__"){if(!S8.call($,Y))return;else if(J$)return J$($,Y).value}return $[Y]};U$.exports=function Z(){var $,Y,Q,W,V,J,K=arguments[0],w=1,L=arguments.length,F=!1;if(typeof K==="boolean")F=K,K=arguments[1]||{},w=2;if(K==null||typeof K!=="object"&&typeof K!=="function")K={};for(;w<L;++w)if($=arguments[w],$!=null){for(Y in $)if(Q=w$(K,Y),W=w$($,Y),K!==W){if(F&&W&&(K$(W)||(V=X$(W)))){if(V)V=!1,J=Q&&X$(Q)?Q:[];else J=Q&&K$(Q)?Q:{};z$(K,{name:Y,newValue:Z(F,J,W)})}else if(typeof W!=="undefined")z$(K,{name:Y,newValue:W})}}return K}});var F$=O((dH,q$)=>{var f0=(Z)=>Z!==null&&typeof Z==="object"&&typeof Z.pipe==="function";f0.writable=(Z)=>f0(Z)&&Z.writable!==!1&&typeof Z._write==="function"&&typeof Z._writableState==="object";f0.readable=(Z)=>f0(Z)&&Z.readable!==!1&&typeof Z._read==="function"&&typeof Z._readableState==="object";f0.duplex=(Z)=>f0.writable(Z)&&f0.readable(Z);f0.transform=(Z)=>f0.duplex(Z)&&typeof Z._transform==="function";q$.exports=f0});var M$=O((lH,hV)=>{hV.exports={name:"gaxios",version:"6.7.0",description:"A simple common HTTP client specifically for Google APIs and services.",main:"build/src/index.js",types:"build/src/index.d.ts",files:["build/src"],scripts:{lint:"gts check",test:"c8 mocha build/test","presystem-test":"npm run compile","system-test":"mocha build/system-test --timeout 80000",compile:"tsc -p .",fix:"gts fix",prepare:"npm run compile",pretest:"npm run compile",webpack:"webpack","prebrowser-test":"npm run compile","browser-test":"node build/browser-test/browser-test-runner.js",docs:"compodoc src/","docs-test":"linkinator docs","predocs-test":"npm run docs","samples-test":"cd samples/ && npm link ../ && npm test && cd ../",prelint:"cd samples; npm link ../; npm install",clean:"gts clean",precompile:"gts clean"},repository:"googleapis/gaxios",keywords:["google"],engines:{node:">=14"},author:"Google, LLC",license:"Apache-2.0",devDependencies:{"@babel/plugin-proposal-private-methods":"^7.18.6","@compodoc/compodoc":"1.1.19","@types/cors":"^2.8.6","@types/express":"^4.16.1","@types/extend":"^3.0.1","@types/mocha":"^9.0.0","@types/multiparty":"0.0.36","@types/mv":"^2.1.0","@types/ncp":"^2.0.1","@types/node":"^20.0.0","@types/node-fetch":"^2.5.7","@types/sinon":"^17.0.0","@types/tmp":"0.2.6","@types/uuid":"^10.0.0","abort-controller":"^3.0.0",assert:"^2.0.0",browserify:"^17.0.0",c8:"^8.0.0",cors:"^2.8.5",execa:"^5.0.0",express:"^4.16.4","form-data":"^4.0.0",gts:"^5.0.0","is-docker":"^2.0.0",karma:"^6.0.0","karma-chrome-launcher":"^3.0.0","karma-coverage":"^2.0.0","karma-firefox-launcher":"^2.0.0","karma-mocha":"^2.0.0","karma-remap-coverage":"^0.1.5","karma-sourcemap-loader":"^0.4.0","karma-webpack":"5.0.0",linkinator:"^3.0.0",mocha:"^8.0.0",multiparty:"^4.2.1",mv:"^2.1.1",ncp:"^2.0.0",nock:"^13.0.0","null-loader":"^4.0.0",puppeteer:"^19.0.0",sinon:"^18.0.0","stream-browserify":"^3.0.0",tmp:"0.2.3","ts-loader":"^8.0.0",typescript:"^5.1.6",webpack:"^5.35.0","webpack-cli":"^4.0.0"},dependencies:{extend:"^3.0.2","https-proxy-agent":"^7.0.1","is-stream":"^2.0.0","node-fetch":"^2.6.9",uuid:"^10.0.0"}}});var N$=O((G$)=>{Object.defineProperty(G$,"__esModule",{value:!0});G$.pkg=void 0;G$.pkg=M$()});var y4=O((R0)=>{function vV(Z,$){switch(Z){case"stream":return $;case"json":return JSON.parse(JSON.stringify($));case"arraybuffer":return JSON.parse(Buffer.from($).toString("utf8"));case"blob":return JSON.parse($.text());default:return $}}function L$(Z){function Y(V){if(!V)return;for(let J of Object.keys(V)){if(/^authentication$/i.test(J))V[J]="<<REDACTED> - See `errorRedactor` option in `gaxios` for configuration>.";if(/^authorization$/i.test(J))V[J]="<<REDACTED> - See `errorRedactor` option in `gaxios` for configuration>.";if(/secret/i.test(J))V[J]="<<REDACTED> - See `errorRedactor` option in `gaxios` for configuration>."}}function Q(V,J){if(typeof V==="object"&&V!==null&&typeof V[J]==="string"){const K=V[J];if(/grant_type=/i.test(K)||/assertion=/i.test(K)||/secret/i.test(K))V[J]="<<REDACTED> - See `errorRedactor` option in `gaxios` for configuration>."}}function W(V){if(typeof V==="object"&&V!==null){if("grant_type"in V)V.grant_type="<<REDACTED> - See `errorRedactor` option in `gaxios` for configuration>.";if("assertion"in V)V.assertion="<<REDACTED> - See `errorRedactor` option in `gaxios` for configuration>.";if("client_secret"in V)V.client_secret="<<REDACTED> - See `errorRedactor` option in `gaxios` for configuration>."}}if(Z.config){Y(Z.config.headers),Q(Z.config,"data"),W(Z.config.data),Q(Z.config,"body"),W(Z.config.body);try{const V=new kV.URL("",Z.config.url);if(V.searchParams.has("token"))V.searchParams.set("token","<<REDACTED> - See `errorRedactor` option in `gaxios` for configuration>.");if(V.searchParams.has("client_secret"))V.searchParams.set("client_secret","<<REDACTED> - See `errorRedactor` option in `gaxios` for configuration>.");Z.config.url=V.toString()}catch(V){}}if(Z.response)L$({config:Z.response.config}),Y(Z.response.headers),Q(Z.response,"data"),W(Z.response.data);return Z}var fV=R0&&R0.__importDefault||function(Z){return Z&&Z.__esModule?Z:{default:Z}},I$;Object.defineProperty(R0,"__esModule",{value:!0});R0.GaxiosError=R0.GAXIOS_ERROR_SYMBOL=void 0;R0.defaultErrorRedactor=L$;var kV=import.meta.require("url"),k4=N$(),R$=fV(f4());R0.GAXIOS_ERROR_SYMBOL=Symbol.for(`${k4.pkg.name}-gaxios-error`);class v4 extends Error{static[(I$=R0.GAXIOS_ERROR_SYMBOL,Symbol.hasInstance)](Z){if(Z&&typeof Z==="object"&&R0.GAXIOS_ERROR_SYMBOL in Z&&Z[R0.GAXIOS_ERROR_SYMBOL]===k4.pkg.version)return!0;return Function.prototype[Symbol.hasInstance].call(v4,Z)}constructor(Z,$,Y,Q){var W;super(Z);if(this.config=$,this.response=Y,this.error=Q,this[I$]=k4.pkg.version,this.config=R$.default(!0,{},$),this.response)this.response.config=R$.default(!0,{},this.response.config);if(this.response){try{this.response.data=vV(this.config.responseType,(W=this.response)===null||W===void 0?void 0:W.data)}catch(V){}this.status=this.response.status}if(Q&&"code"in Q&&Q.code)this.code=Q.code;if($.errorRedactor)$.errorRedactor({config:this.config,response:this.response})}}R0.GaxiosError=v4});var O$=O((T$)=>{async function yV(Z){let $=C$(Z);if(!Z||!Z.config||!$&&!Z.config.retry)return{shouldRetry:!1};$=$||{},$.currentRetryAttempt=$.currentRetryAttempt||0,$.retry=$.retry===void 0||$.retry===null?3:$.retry,$.httpMethodsToRetry=$.httpMethodsToRetry||["GET","HEAD","PUT","OPTIONS","DELETE"],$.noResponseRetries=$.noResponseRetries===void 0||$.noResponseRetries===null?2:$.noResponseRetries,$.retryDelayMultiplier=$.retryDelayMultiplier?$.retryDelayMultiplier:2,$.timeOfFirstRequest=$.timeOfFirstRequest?$.timeOfFirstRequest:Date.now(),$.totalTimeout=$.totalTimeout?$.totalTimeout:Number.MAX_SAFE_INTEGER,$.maxRetryDelay=$.maxRetryDelay?$.maxRetryDelay:Number.MAX_SAFE_INTEGER;const Y=[[100,199],[408,408],[429,429],[500,599]];if($.statusCodesToRetry=$.statusCodesToRetry||Y,Z.config.retryConfig=$,!await($.shouldRetry||bV)(Z))return{shouldRetry:!1,config:Z.config};const W=gV($);Z.config.retryConfig.currentRetryAttempt+=1;const V=$.retryBackoff?$.retryBackoff(Z,W):new Promise((J)=>{setTimeout(J,W)});if($.onRetryAttempt)$.onRetryAttempt(Z);return await V,{shouldRetry:!0,config:Z.config}}function bV(Z){var $;const Y=C$(Z);if(Z.name==="AbortError"||(($=Z.error)===null||$===void 0?void 0:$.name)==="AbortError")return!1;if(!Y||Y.retry===0)return!1;if(!Z.response&&(Y.currentRetryAttempt||0)>=Y.noResponseRetries)return!1;if(!Z.config.method||Y.httpMethodsToRetry.indexOf(Z.config.method.toUpperCase())<0)return!1;if(Z.response&&Z.response.status){let Q=!1;for(let[W,V]of Y.statusCodesToRetry){const J=Z.response.status;if(J>=W&&J<=V){Q=!0;break}}if(!Q)return!1}if(Y.currentRetryAttempt=Y.currentRetryAttempt||0,Y.currentRetryAttempt>=Y.retry)return!1;return!0}function C$(Z){if(Z&&Z.config&&Z.config.retryConfig)return Z.config.retryConfig;return}function gV(Z){var $;const Q=(Z.currentRetryAttempt?0:($=Z.retryDelay)!==null&&$!==void 0?$:100)+(Math.pow(Z.retryDelayMultiplier,Z.currentRetryAttempt)-1)/2*1000,W=Z.totalTimeout-(Date.now()-Z.timeOfFirstRequest);return Math.min(Q,W,Z.maxRetryDelay)}Object.defineProperty(T$,"__esModule",{value:!0});T$.getRetryConfig=yV});var B$=O((S$)=>{Object.defineProperty(S$,"__esModule",{value:!0});S$.default=void 0;var nH=S$.default="ffffffff-ffff-ffff-ffff-ffffffffffff"});var E$=O((A$)=>{Object.defineProperty(A$,"__esModule",{value:!0});A$.default=void 0;var oH=A$.default="00000000-0000-0000-0000-000000000000"});var h$=O((_$)=>{Object.defineProperty(_$,"__esModule",{value:!0});_$.default=void 0;var tH=_$.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i});var t1=O((f$)=>{function dV(Z){return Z&&Z.__esModule?Z:{default:Z}}function lV(Z){return typeof Z==="string"&&uV.default.test(Z)}Object.defineProperty(f$,"__esModule",{value:!0});f$.default=void 0;var uV=dV(h$()),eH=f$.default=lV});var s1=O((v$)=>{function pV(Z){return Z&&Z.__esModule?Z:{default:Z}}function iV(Z){if(!cV.default(Z))throw TypeError("Invalid UUID");let $;const Y=new Uint8Array(16);return Y[0]=($=parseInt(Z.slice(0,8),16))>>>24,Y[1]=$>>>16&255,Y[2]=$>>>8&255,Y[3]=$&255,Y[4]=($=parseInt(Z.slice(9,13),16))>>>8,Y[5]=$&255,Y[6]=($=parseInt(Z.slice(14,18),16))>>>8,Y[7]=$&255,Y[8]=($=parseInt(Z.slice(19,23),16))>>>8,Y[9]=$&255,Y[10]=($=parseInt(Z.slice(24,36),16))/1099511627776&255,Y[11]=$/4294967296&255,Y[12]=$>>>24&255,Y[13]=$>>>16&255,Y[14]=$>>>8&255,Y[15]=$&255,Y}Object.defineProperty(v$,"__esModule",{value:!0});v$.default=void 0;var cV=pV(t1()),$U=v$.default=iV});var p0=O((g$)=>{function aV(Z){return Z&&Z.__esModule?Z:{default:Z}}function b$(Z,$=0){return(W0[Z[$+0]]+W0[Z[$+1]]+W0[Z[$+2]]+W0[Z[$+3]]+"-"+W0[Z[$+4]]+W0[Z[$+5]]+"-"+W0[Z[$+6]]+W0[Z[$+7]]+"-"+W0[Z[$+8]]+W0[Z[$+9]]+"-"+W0[Z[$+10]]+W0[Z[$+11]]+W0[Z[$+12]]+W0[Z[$+13]]+W0[Z[$+14]]+W0[Z[$+15]]).toLowerCase()}function oV(Z,$=0){const Y=b$(Z,$);if(!nV.default(Y))throw TypeError("Stringified UUID is invalid");return Y}Object.defineProperty(g$,"__esModule",{value:!0});g$.default=void 0;g$.unsafeStringify=b$;var nV=aV(t1()),W0=[];for(let Z=0;Z<256;++Z)W0.push((Z+256).toString(16).slice(1));var QU=g$.default=oV});var A8=O((u$)=>{function sV(Z){return Z&&Z.__esModule?Z:{default:Z}}function eV(){if(P8>B8.length-16)tV.default.randomFillSync(B8),P8=0;return B8.slice(P8,P8+=16)}Object.defineProperty(u$,"__esModule",{value:!0});u$.default=eV;var tV=sV(import.meta.require("crypto")),B8=new Uint8Array(256),P8=B8.length});var u4=O((d$)=>{function QJ(Z){return Z&&Z.__esModule?Z:{default:Z}}function WJ(Z,$,Y){let Q=$&&Y||0;const W=$||new Array(16);Z=Z||{};let{node:V,clockseq:J}=Z;if(!Z._v6){if(!V)V=b4;if(J==null)J=j8}if(V==null||J==null){const S=Z.random||(Z.rng||$J.default)();if(V==null){if(V=[S[0],S[1],S[2],S[3],S[4],S[5]],!b4&&!Z._v6)V[0]|=1,b4=V}if(J==null){if(J=(S[6]<<8|S[7])&16383,j8===void 0&&!Z._v6)j8=J}}let K=Z.msecs!==void 0?Z.msecs:Date.now(),w=Z.nsecs!==void 0?Z.nsecs:m4+1;const L=K-g4+(w-m4)/1e4;if(L<0&&Z.clockseq===void 0)J=J+1&16383;if((L<0||K>g4)&&Z.nsecs===void 0)w=0;if(w>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");g4=K,m4=w,j8=J,K+=12219292800000;const F=((K&268435455)*1e4+w)%4294967296;W[Q++]=F>>>24&255,W[Q++]=F>>>16&255,W[Q++]=F>>>8&255,W[Q++]=F&255;const C=K/4294967296*1e4&268435455;W[Q++]=C>>>8&255,W[Q++]=C&255,W[Q++]=C>>>24&15|16,W[Q++]=C>>>16&255,W[Q++]=J>>>8|128,W[Q++]=J&255;for(let S=0;S<6;++S)W[Q+S]=V[S];return $||YJ.unsafeStringify(W)}Object.defineProperty(d$,"__esModule",{value:!0});d$.default=void 0;var $J=QJ(A8()),YJ=p0(),b4,j8,g4=0,m4=0,JU=d$.default=WJ});var d4=O((c$)=>{function XJ(Z){return Z&&Z.__esModule?Z:{default:Z}}function KJ(Z){const $=typeof Z==="string"?VJ.default(Z):Z,Y=zJ($);return typeof Z==="string"?JJ.unsafeStringify(Y):Y}function zJ(Z,$=!1){return Uint8Array.of((Z[6]&15)<<4|Z[7]>>4&15,(Z[7]&15)<<4|(Z[4]&240)>>4,(Z[4]&15)<<4|(Z[5]&240)>>4,(Z[5]&15)<<4|(Z[0]&240)>>4,(Z[0]&15)<<4|(Z[1]&240)>>4,(Z[1]&15)<<4|(Z[2]&240)>>4,96|Z[2]&15,Z[3],Z[8],Z[9],Z[10],Z[11],Z[12],Z[13],Z[14],Z[15])}Object.defineProperty(c$,"__esModule",{value:!0});c$.default=KJ;var VJ=XJ(s1()),JJ=p0()});var l4=O((p$)=>{function qJ(Z){return Z&&Z.__esModule?Z:{default:Z}}function FJ(Z){Z=unescape(encodeURIComponent(Z));const $=[];for(let Y=0;Y<Z.length;++Y)$.push(Z.charCodeAt(Y));return $}function DJ(Z,$,Y){function Q(W,V,J,K){var w;if(typeof W==="string")W=FJ(W);if(typeof V==="string")V=UJ.default(V);if(((w=V)===null||w===void 0?void 0:w.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let L=new Uint8Array(16+W.length);if(L.set(V),L.set(W,V.length),L=Y(L),L[6]=L[6]&15|$,L[8]=L[8]&63|128,J){K=K||0;for(let F=0;F<16;++F)J[K+F]=L[F];return J}return HJ.unsafeStringify(L)}try{Q.name=Z}catch(W){}return Q.DNS=MJ,Q.URL=GJ,Q}Object.defineProperty(p$,"__esModule",{value:!0});p$.URL=p$.DNS=void 0;p$.default=DJ;var HJ=p0(),UJ=qJ(s1()),MJ=p$.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",GJ=p$.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8"});var o$=O((n$)=>{function LJ(Z){return Z&&Z.__esModule?Z:{default:Z}}function CJ(Z){if(Array.isArray(Z))Z=Buffer.from(Z);else if(typeof Z==="string")Z=Buffer.from(Z,"utf8");return RJ.default.createHash("md5").update(Z).digest()}Object.defineProperty(n$,"__esModule",{value:!0});n$.default=void 0;var RJ=LJ(import.meta.require("crypto")),wU=n$.default=CJ});var e$=O((t$)=>{function r$(Z){return Z&&Z.__esModule?Z:{default:Z}}Object.defineProperty(t$,"__esModule",{value:!0});t$.default=void 0;var TJ=r$(l4()),OJ=r$(o$()),SJ=TJ.default("v3",48,OJ.default),UU=t$.default=SJ});var Y9=O((Z9)=>{function BJ(Z){return Z&&Z.__esModule?Z:{default:Z}}Object.defineProperty(Z9,"__esModule",{value:!0});Z9.default=void 0;var PJ=BJ(import.meta.require("crypto")),FU=Z9.default={randomUUID:PJ.default.randomUUID}});var X9=O((V9)=>{function W9(Z){return Z&&Z.__esModule?Z:{default:Z}}function EJ(Z,$,Y){if(Q9.default.randomUUID&&!$&&!Z)return Q9.default.randomUUID();Z=Z||{};const Q=Z.random||(Z.rng||AJ.default)();if(Q[6]=Q[6]&15|64,Q[8]=Q[8]&63|128,$){Y=Y||0;for(let W=0;W<16;++W)$[Y+W]=Q[W];return $}return jJ.unsafeStringify(Q)}Object.defineProperty(V9,"__esModule",{value:!0});V9.default=void 0;var Q9=W9(Y9()),AJ=W9(A8()),jJ=p0(),GU=V9.default=EJ});var w9=O((K9)=>{function xJ(Z){return Z&&Z.__esModule?Z:{default:Z}}function hJ(Z){if(Array.isArray(Z))Z=Buffer.from(Z);else if(typeof Z==="string")Z=Buffer.from(Z,"utf8");return _J.default.createHash("sha1").update(Z).digest()}Object.defineProperty(K9,"__esModule",{value:!0});K9.default=void 0;var _J=xJ(import.meta.require("crypto")),NU=K9.default=hJ});var F9=O((U9)=>{function H9(Z){return Z&&Z.__esModule?Z:{default:Z}}Object.defineProperty(U9,"__esModule",{value:!0});U9.default=void 0;var fJ=H9(l4()),kJ=H9(w9()),vJ=fJ.default("v5",80,kJ.default),RU=U9.default=vJ});var D9=O((G9)=>{function M9(Z){return Z&&Z.__esModule?Z:{default:Z}}function mJ(Z={},$,Y=0){let Q=bJ.default({...Z,_v6:!0},new Uint8Array(16));if(Q=gJ.default(Q),$){for(let W=0;W<16;W++)$[Y+W]=Q[W];return $}return yJ.unsafeStringify(Q)}Object.defineProperty(G9,"__esModule",{value:!0});G9.default=mJ;var yJ=p0(),bJ=M9(u4()),gJ=M9(d4())});var I9=O((N9)=>{function cJ(Z){return Z&&Z.__esModule?Z:{default:Z}}function pJ(Z){const $=typeof Z==="string"?dJ.default(Z):Z,Y=iJ($);return typeof Z==="string"?lJ.unsafeStringify(Y):Y}function iJ(Z){return Uint8Array.of((Z[3]&15)<<4|Z[4]>>4&15,(Z[4]&15)<<4|(Z[5]&240)>>4,(Z[5]&15)<<4|Z[6]&15,Z[7],(Z[1]&15)<<4|(Z[2]&240)>>4,(Z[2]&15)<<4|(Z[3]&240)>>4,16|(Z[0]&240)>>4,(Z[0]&15)<<4|(Z[1]&240)>>4,Z[8],Z[9],Z[10],Z[11],Z[12],Z[13],Z[14],Z[15])}Object.defineProperty(N9,"__esModule",{value:!0});N9.default=pJ;var dJ=cJ(s1()),lJ=p0()});var O9=O((C9)=>{function rJ(Z){return Z&&Z.__esModule?Z:{default:Z}}function tJ(Z,$,Y){Z=Z||{};let Q=$&&Y||0;const W=$||new Uint8Array(16),V=Z.random||(Z.rng||aJ.default)(),J=Z.msecs!==void 0?Z.msecs:Date.now();let K=Z.seq!==void 0?Z.seq:null,w=L9,L=R9;if(J>S0&&Z.msecs===void 0){if(S0=J,K!==null)w=null,L=null}if(K!==null){if(K>2147483647)K=2147483647;w=K>>>19&4095,L=K&524287}if(w===null||L===null)w=V[6]&127,w=w<<8|V[7],L=V[8]&63,L=L<<8|V[9],L=L<<5|V[10]>>>3;if(J+1e4>S0&&K===null){if(++L>524287){if(L=0,++w>4095)w=0,S0++}}else S0=J;return L9=w,R9=L,W[Q++]=S0/1099511627776&255,W[Q++]=S0/4294967296&255,W[Q++]=S0/16777216&255,W[Q++]=S0/65536&255,W[Q++]=S0/256&255,W[Q++]=S0&255,W[Q++]=w>>>4&15|112,W[Q++]=w&255,W[Q++]=L>>>13&63|128,W[Q++]=L>>>5&255,W[Q++]=L<<3&255|V[10]&7,W[Q++]=V[11],W[Q++]=V[12],W[Q++]=V[13],W[Q++]=V[14],W[Q++]=V[15],$||oJ.unsafeStringify(W)}Object.defineProperty(C9,"__esModule",{value:!0});C9.default=void 0;var aJ=rJ(A8()),oJ=p0(),R9=null,L9=null,S0=0,OU=C9.default=tJ});var B9=O((S9)=>{function eJ(Z){return Z&&Z.__esModule?Z:{default:Z}}function ZX(Z){if(!sJ.default(Z))throw TypeError("Invalid UUID");return parseInt(Z.slice(14,15),16)}Object.defineProperty(S9,"__esModule",{value:!0});S9.default=void 0;var sJ=eJ(t1()),PU=S9.default=ZX});var A9=O((J0)=>{function q0(Z){return Z&&Z.__esModule?Z:{default:Z}}Object.defineProperty(J0,"__esModule",{value:!0});Object.defineProperty(J0,"MAX",{enumerable:!0,get:function(){return $X.default}});Object.defineProperty(J0,"NIL",{enumerable:!0,get:function(){return YX.default}});Object.defineProperty(J0,"parse",{enumerable:!0,get:function(){return QX.default}});Object.defineProperty(J0,"stringify",{enumerable:!0,get:function(){return WX.default}});Object.defineProperty(J0,"v1",{enumerable:!0,get:function(){return VX.default}});Object.defineProperty(J0,"v1ToV6",{enumerable:!0,get:function(){return JX.default}});Object.defineProperty(J0,"v3",{enumerable:!0,get:function(){return XX.default}});Object.defineProperty(J0,"v4",{enumerable:!0,get:function(){return KX.default}});Object.defineProperty(J0,"v5",{enumerable:!0,get:function(){return zX.default}});Object.defineProperty(J0,"v6",{enumerable:!0,get:function(){return wX.default}});Object.defineProperty(J0,"v6ToV1",{enumerable:!0,get:function(){return HX.default}});Object.defineProperty(J0,"v7",{enumerable:!0,get:function(){return UX.default}});Object.defineProperty(J0,"validate",{enumerable:!0,get:function(){return qX.default}});Object.defineProperty(J0,"version",{enumerable:!0,get:function(){return FX.default}});var $X=q0(B$()),YX=q0(E$()),QX=q0(s1()),WX=q0(p0()),VX=q0(u4()),JX=q0(d4()),XX=q0(e$()),KX=q0(X9()),zX=q0(F9()),wX=q0(D9()),HX=q0(I9()),UX=q0(O9()),qX=q0(t1()),FX=q0(B9())});var c4=O((E9)=>{Object.defineProperty(E9,"__esModule",{value:!0});E9.GaxiosInterceptorManager=void 0;class j9 extends Set{}E9.GaxiosInterceptorManager=j9});var h9=O((EU,x9)=>{function DX(Z){if(Z=String(Z),Z.length>100)return;var $=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(Z);if(!$)return;var Y=parseFloat($[1]),Q=($[2]||"ms").toLowerCase();switch(Q){case"years":case"year":case"yrs":case"yr":case"y":return Y*GX;case"weeks":case"week":case"w":return Y*MX;case"days":case"day":case"d":return Y*K1;case"hours":case"hour":case"hrs":case"hr":case"h":return Y*S1;case"minutes":case"minute":case"mins":case"min":case"m":return Y*O1;case"seconds":case"second":case"secs":case"sec":case"s":return Y*T1;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return Y;default:return}}function NX(Z){var $=Math.abs(Z);if($>=K1)return Math.round(Z/K1)+"d";if($>=S1)return Math.round(Z/S1)+"h";if($>=O1)return Math.round(Z/O1)+"m";if($>=T1)return Math.round(Z/T1)+"s";return Z+"ms"}function IX(Z){var $=Math.abs(Z);if($>=K1)return E8(Z,$,K1,"day");if($>=S1)return E8(Z,$,S1,"hour");if($>=O1)return E8(Z,$,O1,"minute");if($>=T1)return E8(Z,$,T1,"second");return Z+" ms"}function E8(Z,$,Y,Q){var W=$>=Y*1.5;return Math.round(Z/Y)+" "+Q+(W?"s":"")}var T1=1000,O1=T1*60,S1=O1*60,K1=S1*24,MX=K1*7,GX=K1*365.25;x9.exports=function(Z,$){$=$||{};var Y=typeof Z;if(Y==="string"&&Z.length>0)return DX(Z);else if(Y==="number"&&isFinite(Z))return $.long?IX(Z):NX(Z);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(Z))}});var p4=O((_U,f9)=>{function RX(Z){Y.debug=Y,Y.default=Y,Y.coerce=w,Y.disable=V,Y.enable=W,Y.enabled=J,Y.humanize=h9(),Y.destroy=L,Object.keys(Z).forEach((F)=>{Y[F]=Z[F]}),Y.names=[],Y.skips=[],Y.formatters={};function $(F){let C=0;for(let S=0;S<F.length;S++)C=(C<<5)-C+F.charCodeAt(S),C|=0;return Y.colors[Math.abs(C)%Y.colors.length]}Y.selectColor=$;function Y(F){let C,S=null,v,y;function j(...E){if(!j.enabled)return;const B=j,b=Number(new Date),u=b-(C||b);if(B.diff=u,B.prev=C,B.curr=b,C=b,E[0]=Y.coerce(E[0]),typeof E[0]!=="string")E.unshift("%O");let n=0;E[0]=E[0].replace(/%([a-zA-Z%])/g,(_,g)=>{if(_==="%%")return"%";n++;const c=Y.formatters[g];if(typeof c==="function"){const A=E[n];_=c.call(B,A),E.splice(n,1),n--}return _}),Y.formatArgs.call(B,E),(B.log||Y.log).apply(B,E)}if(j.namespace=F,j.useColors=Y.useColors(),j.color=Y.selectColor(F),j.extend=Q,j.destroy=Y.destroy,Object.defineProperty(j,"enabled",{enumerable:!0,configurable:!1,get:()=>{if(S!==null)return S;if(v!==Y.namespaces)v=Y.namespaces,y=Y.enabled(F);return y},set:(E)=>{S=E}}),typeof Y.init==="function")Y.init(j);return j}function Q(F,C){const S=Y(this.namespace+(typeof C==="undefined"?":":C)+F);return S.log=this.log,S}function W(F){Y.save(F),Y.namespaces=F,Y.names=[],Y.skips=[];let C;const S=(typeof F==="string"?F:"").split(/[\s,]+/),v=S.length;for(C=0;C<v;C++){if(!S[C])continue;if(F=S[C].replace(/\*/g,".*?"),F[0]==="-")Y.skips.push(new RegExp("^"+F.slice(1)+"$"));else Y.names.push(new RegExp("^"+F+"$"))}}function V(){const F=[...Y.names.map(K),...Y.skips.map(K).map((C)=>"-"+C)].join(",");return Y.enable(""),F}function J(F){if(F[F.length-1]==="*")return!0;let C,S;for(C=0,S=Y.skips.length;C<S;C++)if(Y.skips[C].test(F))return!1;for(C=0,S=Y.names.length;C<S;C++)if(Y.names[C].test(F))return!0;return!1}function K(F){return F.toString().substring(2,F.toString().length-2).replace(/\.\*\?$/,"*")}function w(F){if(F instanceof Error)return F.stack||F.message;return F}function L(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return Y.enable(Y.load()),Y}f9.exports=RX});var v9=O((k9,x8)=>{function LX(){if(typeof window!=="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let Z;return typeof document!=="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!=="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!=="undefined"&&navigator.userAgent&&(Z=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(Z[1],10)>=31||typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function CX(Z){if(Z[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+Z[0]+(this.useColors?"%c ":" ")+"+"+x8.exports.humanize(this.diff),!this.useColors)return;const $="color: "+this.color;Z.splice(1,0,$,"color: inherit");let Y=0,Q=0;Z[0].replace(/%[a-zA-Z%]/g,(W)=>{if(W==="%%")return;if(Y++,W==="%c")Q=Y}),Z.splice(Q,0,$)}function TX(Z){try{if(Z)k9.storage.setItem("debug",Z);else k9.storage.removeItem("debug")}catch($){}}function OX(){let Z;try{Z=k9.storage.getItem("debug")}catch($){}if(!Z&&typeof process!=="undefined"&&"env"in process)Z=process.env.DEBUG;return Z}function SX(){try{return localStorage}catch(Z){}}k9.formatArgs=CX;k9.save=TX;k9.load=OX;k9.useColors=LX;k9.storage=SX();k9.destroy=(()=>{let Z=!1;return()=>{if(!Z)Z=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}})();k9.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];k9.log=console.debug||console.log||(()=>{});x8.exports=p4()(k9);var{formatters:PX}=x8.exports;PX.j=function(Z){try{return JSON.stringify(Z)}catch($){return"[UnexpectedJSONParseError]: "+$.message}}});var b9={};WV(b9,{default:()=>gX,createSupportsColor:()=>i4});import n4 from"process";import fX from"os";import y9 from"tty";function L0(Z,$=globalThis.Deno?globalThis.Deno.args:n4.argv){const Y=Z.startsWith("-")?"":Z.length===1?"-":"--",Q=$.indexOf(Y+Z),W=$.indexOf("--");return Q!==-1&&(W===-1||Q<W)}function kX(){if("FORCE_COLOR"in r){if(r.FORCE_COLOR==="true")return 1;if(r.FORCE_COLOR==="false")return 0;return r.FORCE_COLOR.length===0?1:Math.min(Number.parseInt(r.FORCE_COLOR,10),3)}}function vX(Z){if(Z===0)return!1;return{level:Z,hasBasic:!0,has256:Z>=2,has16m:Z>=3}}function yX(Z,{streamIsTTY:$,sniffFlags:Y=!0}={}){const Q=kX();if(Q!==void 0)h8=Q;const W=Y?h8:Q;if(W===0)return 0;if(Y){if(L0("color=16m")||L0("color=full")||L0("color=truecolor"))return 3;if(L0("color=256"))return 2}if("TF_BUILD"in r&&"AGENT_NAME"in r)return 1;if(Z&&!$&&W===void 0)return 0;const V=W||0;if(r.TERM==="dumb")return V;if(n4.platform==="win32"){const J=fX.release().split(".");if(Number(J[0])>=10&&Number(J[2])>=10586)return Number(J[2])>=14931?3:2;return 1}if("CI"in r){if("GITHUB_ACTIONS"in r||"GITEA_ACTIONS"in r)return 3;if(["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","BUILDKITE","DRONE"].some((J)=>(J in r))||r.CI_NAME==="codeship")return 1;return V}if("TEAMCITY_VERSION"in r)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(r.TEAMCITY_VERSION)?1:0;if(r.COLORTERM==="truecolor")return 3;if(r.TERM==="xterm-kitty")return 3;if("TERM_PROGRAM"in r){const J=Number.parseInt((r.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(r.TERM_PROGRAM){case"iTerm.app":return J>=3?3:2;case"Apple_Terminal":return 2}}if(/-256(color)?$/i.test(r.TERM))return 2;if(/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(r.TERM))return 1;if("COLORTERM"in r)return 1;return V}function i4(Z,$={}){const Y=yX(Z,{streamIsTTY:Z&&Z.isTTY,...$});return vX(Y)}var r,h8,bX,gX;var g9=VV(()=>{({env:r}=n4);if(L0("no-color")||L0("no-colors")||L0("color=false")||L0("color=never"))h8=0;else if(L0("color")||L0("colors")||L0("color=true")||L0("color=always"))h8=1;bX={stdout:i4({isTTY:y9.isatty(1)}),stderr:i4({isTTY:y9.isatty(2)})},gX=bX});var l9=O((u9,k8)=>{function uX(){return"colors"in u9.inspectOpts?Boolean(u9.inspectOpts.colors):mX.isatty(process.stderr.fd)}function dX(Z){const{namespace:$,useColors:Y}=this;if(Y){const Q=this.color,W="\x1B[3"+(Q<8?Q:"8;5;"+Q),V=`  ${W};1m${$} \x1B[0m`;Z[0]=V+Z[0].split("\n").join("\n"+V),Z.push(W+"m+"+k8.exports.humanize(this.diff)+"\x1B[0m")}else Z[0]=lX()+$+" "+Z[0]}function lX(){if(u9.inspectOpts.hideDate)return"";return new Date().toISOString()+" "}function cX(...Z){return process.stderr.write(f8.formatWithOptions(u9.inspectOpts,...Z)+"\n")}function pX(Z){if(Z)process.env.DEBUG=Z;else delete process.env.DEBUG}function iX(){return process.env.DEBUG}function nX(Z){Z.inspectOpts={};const $=Object.keys(u9.inspectOpts);for(let Y=0;Y<$.length;Y++)Z.inspectOpts[$[Y]]=u9.inspectOpts[$[Y]]}var mX=import.meta.require("tty"),f8=import.meta.require("util");u9.init=nX;u9.log=cX;u9.formatArgs=dX;u9.save=pX;u9.load=iX;u9.useColors=uX;u9.destroy=f8.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");u9.colors=[6,2,3,4,5,1];try{const Z=(g9(),QV(b9));if(Z&&(Z.stderr||Z).level>=2)u9.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221]}catch(Z){}u9.inspectOpts=Object.keys(process.env).filter((Z)=>{return/^debug_/i.test(Z)}).reduce((Z,$)=>{const Y=$.substring(6).toLowerCase().replace(/_([a-z])/g,(W,V)=>{return V.toUpperCase()});let Q=process.env[$];if(/^(yes|on|true|enabled)$/i.test(Q))Q=!0;else if(/^(no|off|false|disabled)$/i.test(Q))Q=!1;else if(Q==="null")Q=null;else Q=Number(Q);return Z[Y]=Q,Z},{});k8.exports=p4()(u9);var{formatters:m9}=k8.exports;m9.o=function(Z){return this.inspectOpts.colors=this.useColors,f8.inspect(Z,this.inspectOpts).split("\n").map(($)=>$.trim()).join(" ")};m9.O=function(Z){return this.inspectOpts.colors=this.useColors,f8.inspect(Z,this.inspectOpts)}});var o4=O((yU,a4)=>{if(typeof process==="undefined"||process.type==="renderer"||!1||process.__nwjs)a4.exports=v9();else a4.exports=l9()});var i9=O((F0)=>{async function p9(Z){let $=0;const Y=[];for await(let Q of Z)$+=Q.length,Y.push(Q);return Buffer.concat(Y,$)}async function VK(Z){const Y=(await p9(Z)).toString("utf8");try{return JSON.parse(Y)}catch(Q){const W=Q;throw W.message+=` (input: ${Y})`,W}}function JK(Z,$={}){const Q=((typeof Z==="string"?Z:Z.href).startsWith("https:")?WK:QK).request(Z,$),W=new Promise((V,J)=>{Q.once("response",V).once("error",J).end()});return Q.then=W.then.bind(W),Q}var $K=F0&&F0.__createBinding||(Object.create?function(Z,$,Y,Q){if(Q===void 0)Q=Y;var W=Object.getOwnPropertyDescriptor($,Y);if(!W||("get"in W?!$.__esModule:W.writable||W.configurable))W={enumerable:!0,get:function(){return $[Y]}};Object.defineProperty(Z,Q,W)}:function(Z,$,Y,Q){if(Q===void 0)Q=Y;Z[Q]=$[Y]}),YK=F0&&F0.__setModuleDefault||(Object.create?function(Z,$){Object.defineProperty(Z,"default",{enumerable:!0,value:$})}:function(Z,$){Z.default=$}),c9=F0&&F0.__importStar||function(Z){if(Z&&Z.__esModule)return Z;var $={};if(Z!=null){for(var Y in Z)if(Y!=="default"&&Object.prototype.hasOwnProperty.call(Z,Y))$K($,Z,Y)}return YK($,Z),$};Object.defineProperty(F0,"__esModule",{value:!0});F0.req=F0.json=F0.toBuffer=void 0;var QK=c9(import.meta.require("http")),WK=c9(import.meta.require("https"));F0.toBuffer=p9;F0.json=VK;F0.req=JK});var t9=O((G0)=>{var a9=G0&&G0.__createBinding||(Object.create?function(Z,$,Y,Q){if(Q===void 0)Q=Y;var W=Object.getOwnPropertyDescriptor($,Y);if(!W||("get"in W?!$.__esModule:W.writable||W.configurable))W={enumerable:!0,get:function(){return $[Y]}};Object.defineProperty(Z,Q,W)}:function(Z,$,Y,Q){if(Q===void 0)Q=Y;Z[Q]=$[Y]}),XK=G0&&G0.__setModuleDefault||(Object.create?function(Z,$){Object.defineProperty(Z,"default",{enumerable:!0,value:$})}:function(Z,$){Z.default=$}),o9=G0&&G0.__importStar||function(Z){if(Z&&Z.__esModule)return Z;var $={};if(Z!=null){for(var Y in Z)if(Y!=="default"&&Object.prototype.hasOwnProperty.call(Z,Y))a9($,Z,Y)}return XK($,Z),$},KK=G0&&G0.__exportStar||function(Z,$){for(var Y in Z)if(Y!=="default"&&!Object.prototype.hasOwnProperty.call($,Y))a9($,Z,Y)};Object.defineProperty(G0,"__esModule",{value:!0});G0.Agent=void 0;var zK=o9(import.meta.require("net")),n9=o9(import.meta.require("http")),wK=import.meta.require("https");KK(i9(),G0);var k0=Symbol("AgentBaseInternalState");class r9 extends n9.Agent{constructor(Z){super(Z);this[k0]={}}isSecureEndpoint(Z){if(Z){if(typeof Z.secureEndpoint==="boolean")return Z.secureEndpoint;if(typeof Z.protocol==="string")return Z.protocol==="https:"}const{stack:$}=new Error;if(typeof $!=="string")return!1;return $.split("\n").some((Y)=>Y.indexOf("(https.js:")!==-1||Y.indexOf("node:https:")!==-1)}incrementSockets(Z){if(this.maxSockets===1/0&&this.maxTotalSockets===1/0)return null;if(!this.sockets[Z])this.sockets[Z]=[];const $=new zK.Socket({writable:!1});return this.sockets[Z].push($),this.totalSocketCount++,$}decrementSockets(Z,$){if(!this.sockets[Z]||$===null)return;const Y=this.sockets[Z],Q=Y.indexOf($);if(Q!==-1){if(Y.splice(Q,1),this.totalSocketCount--,Y.length===0)delete this.sockets[Z]}}getName(Z){if(typeof Z.secureEndpoint==="boolean"?Z.secureEndpoint:this.isSecureEndpoint(Z))return wK.Agent.prototype.getName.call(this,Z);return super.getName(Z)}createSocket(Z,$,Y){const Q={...$,secureEndpoint:this.isSecureEndpoint($)},W=this.getName(Q),V=this.incrementSockets(W);Promise.resolve().then(()=>this.connect(Z,Q)).then((J)=>{if(this.decrementSockets(W,V),J instanceof n9.Agent)return J.addRequest(Z,Q);this[k0].currentSocket=J,super.createSocket(Z,$,Y)},(J)=>{this.decrementSockets(W,V),Y(J)})}createConnection(){const Z=this[k0].currentSocket;if(this[k0].currentSocket=void 0,!Z)throw new Error("No socket was returned in the `connect()` function");return Z}get defaultPort(){return this[k0].defaultPort??(this.protocol==="https:"?443:80)}set defaultPort(Z){if(this[k0])this[k0].defaultPort=Z}get protocol(){return this[k0].protocol??(this.isSecureEndpoint()?"https:":"http:")}set protocol(Z){if(this[k0])this[k0].protocol=Z}}G0.Agent=r9});var s9=O((P1)=>{function qK(Z){return new Promise(($,Y)=>{let Q=0;const W=[];function V(){const F=Z.read();if(F)L(F);else Z.once("readable",V)}function J(){Z.removeListener("end",K),Z.removeListener("error",w),Z.removeListener("readable",V)}function K(){J(),v8("onend"),Y(new Error("Proxy connection ended before receiving CONNECT response"))}function w(F){J(),v8("onerror %o",F),Y(F)}function L(F){W.push(F),Q+=F.length;const C=Buffer.concat(W,Q),S=C.indexOf("\r\n\r\n");if(S===-1){v8("have not received end of HTTP headers yet..."),V();return}const v=C.slice(0,S).toString("ascii").split("\r\n"),y=v.shift();if(!y)return Z.destroy(),Y(new Error("No header received from proxy CONNECT response"));const j=y.split(" "),E=+j[1],B=j.slice(2).join(" "),b={};for(let u of v){if(!u)continue;const n=u.indexOf(":");if(n===-1)return Z.destroy(),Y(new Error(`Invalid header from proxy CONNECT response: "${u}"`));const k=u.slice(0,n).toLowerCase(),_=u.slice(n+1).trimStart(),g=b[k];if(typeof g==="string")b[k]=[g,_];else if(Array.isArray(g))g.push(_);else b[k]=_}v8("got proxy server response: %o %o",y,b),J(),$({connect:{statusCode:E,statusText:B,headers:b},buffered:C})}Z.on("error",w),Z.on("end",K),V()})}var HK=P1&&P1.__importDefault||function(Z){return Z&&Z.__esModule?Z:{default:Z}};Object.defineProperty(P1,"__esModule",{value:!0});P1.parseProxyResponse=void 0;var UK=HK(o4()),v8=UK.default("https-proxy-agent:parse-proxy-response");P1.parseProxyResponse=qK});var QY=O((C0)=>{function LK(Z){Z.resume()}function ZY(Z,...$){const Y={};let Q;for(Q in Z)if(!$.includes(Q))Y[Q]=Z[Q];return Y}var FK=C0&&C0.__createBinding||(Object.create?function(Z,$,Y,Q){if(Q===void 0)Q=Y;var W=Object.getOwnPropertyDescriptor($,Y);if(!W||("get"in W?!$.__esModule:W.writable||W.configurable))W={enumerable:!0,get:function(){return $[Y]}};Object.defineProperty(Z,Q,W)}:function(Z,$,Y,Q){if(Q===void 0)Q=Y;Z[Q]=$[Y]}),MK=C0&&C0.__setModuleDefault||(Object.create?function(Z,$){Object.defineProperty(Z,"default",{enumerable:!0,value:$})}:function(Z,$){Z.default=$}),$Y=C0&&C0.__importStar||function(Z){if(Z&&Z.__esModule)return Z;var $={};if(Z!=null){for(var Y in Z)if(Y!=="default"&&Object.prototype.hasOwnProperty.call(Z,Y))FK($,Z,Y)}return MK($,Z),$},YY=C0&&C0.__importDefault||function(Z){return Z&&Z.__esModule?Z:{default:Z}};Object.defineProperty(C0,"__esModule",{value:!0});C0.HttpsProxyAgent=void 0;var r4=$Y(import.meta.require("net")),e9=$Y(import.meta.require("tls")),GK=YY(import.meta.require("assert")),DK=YY(o4()),NK=t9(),IK=import.meta.require("url"),RK=s9(),e1=DK.default("https-proxy-agent");class t4 extends NK.Agent{constructor(Z,$){super($);this.options={path:void 0},this.proxy=typeof Z==="string"?new IK.URL(Z):Z,this.proxyHeaders=$?.headers??{},e1("Creating new HttpsProxyAgent instance: %o",this.proxy.href);const Y=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),Q=this.proxy.port?parseInt(this.proxy.port,10):this.proxy.protocol==="https:"?443:80;this.connectOpts={ALPNProtocols:["http/1.1"],...$?ZY($,"headers"):null,host:Y,port:Q}}async connect(Z,$){const{proxy:Y}=this;if(!$.host)throw new TypeError('No "host" provided');let Q;if(Y.protocol==="https:"){e1("Creating `tls.Socket`: %o",this.connectOpts);const C=this.connectOpts.servername||this.connectOpts.host;Q=e9.connect({...this.connectOpts,servername:C})}else e1("Creating `net.Socket`: %o",this.connectOpts),Q=r4.connect(this.connectOpts);const W=typeof this.proxyHeaders==="function"?this.proxyHeaders():{...this.proxyHeaders},V=r4.isIPv6($.host)?`[${$.host}]`:$.host;let J=`CONNECT ${V}:${$.port} HTTP/1.1\r\n`;if(Y.username||Y.password){const C=`${decodeURIComponent(Y.username)}:${decodeURIComponent(Y.password)}`;W["Proxy-Authorization"]=`Basic ${Buffer.from(C).toString("base64")}`}if(W.Host=`${V}:${$.port}`,!W["Proxy-Connection"])W["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close";for(let C of Object.keys(W))J+=`${C}: ${W[C]}\r\n`;const K=RK.parseProxyResponse(Q);Q.write(`${J}\r\n`);const{connect:w,buffered:L}=await K;if(Z.emit("proxyConnect",w),this.emit("proxyConnect",w,Z),w.statusCode===200){if(Z.once("socket",LK),$.secureEndpoint){e1("Upgrading socket connection to TLS");const C=$.servername||$.host;return e9.connect({...ZY($,"host","path","port"),socket:Q,servername:C})}return Q}Q.destroy();const F=new r4.Socket({writable:!1});return F.readable=!0,Z.once("socket",(C)=>{e1("Replaying proxy buffer for failed request"),GK.default(C.listenerCount("data")>0),C.push(L),C.push(null)}),F}}t4.protocols=["http","https"];C0.HttpsProxyAgent=t4});var FY=O((X0)=>{function fK(){return typeof window!=="undefined"&&!!window}function kK(){return fK()&&!!window.fetch}function vK(){return typeof Buffer!=="undefined"}function zY(Z,$){return!!qY(Z,$)}function qY(Z,$){$=$.toLowerCase();for(let Y of Object.keys((Z===null||Z===void 0?void 0:Z.headers)||{}))if($===Y.toLowerCase())return Z.headers[Y];return}var CK=X0&&X0.__createBinding||(Object.create?function(Z,$,Y,Q){if(Q===void 0)Q=Y;var W=Object.getOwnPropertyDescriptor($,Y);if(!W||("get"in W?!$.__esModule:W.writable||W.configurable))W={enumerable:!0,get:function(){return $[Y]}};Object.defineProperty(Z,Q,W)}:function(Z,$,Y,Q){if(Q===void 0)Q=Y;Z[Q]=$[Y]}),TK=X0&&X0.__setModuleDefault||(Object.create?function(Z,$){Object.defineProperty(Z,"default",{enumerable:!0,value:$})}:function(Z,$){Z.default=$}),OK=X0&&X0.__importStar||function(Z){if(Z&&Z.__esModule)return Z;var $={};if(Z!=null){for(var Y in Z)if(Y!=="default"&&Object.prototype.hasOwnProperty.call(Z,Y))CK($,Z,Y)}return TK($,Z),$},H1=X0&&X0.__classPrivateFieldGet||function(Z,$,Y,Q){if(Y==="a"&&!Q)throw new TypeError("Private accessor was defined without a getter");if(typeof $==="function"?Z!==$||!Q:!$.has(Z))throw new TypeError("Cannot read private member from an object whose class did not declare it");return Y==="m"?Q:Y==="a"?Q.call(Z):Q?Q.value:$.get(Z)},SK=X0&&X0.__classPrivateFieldSet||function(Z,$,Y,Q,W){if(Q==="m")throw new TypeError("Private method is not writable");if(Q==="a"&&!W)throw new TypeError("Private accessor was defined without a setter");if(typeof $==="function"?Z!==$||!W:!$.has(Z))throw new TypeError("Cannot write private member to an object whose class did not declare it");return Q==="a"?W.call(Z,Y):W?W.value=Y:$.set(Z,Y),Y},g8=X0&&X0.__importDefault||function(Z){return Z&&Z.__esModule?Z:{default:Z}},B1,w1,WY,wY,HY,UY,y8,VY;Object.defineProperty(X0,"__esModule",{value:!0});X0.Gaxios=void 0;var PK=g8(f4()),BK=import.meta.require("https"),AK=g8(import.meta.require("node-fetch")),jK=g8(import.meta.require("querystring")),EK=g8(F$()),JY=import.meta.require("url"),b8=y4(),_K=O$(),XY=import.meta.require("stream"),xK=A9(),KY=c4(),hK=kK()?window.fetch:AK.default;class s4{constructor(Z){B1.add(this),this.agentCache=new Map,this.defaults=Z||{},this.interceptors={request:new KY.GaxiosInterceptorManager,response:new KY.GaxiosInterceptorManager}}async request(Z={}){return Z=await H1(this,B1,"m",UY).call(this,Z),Z=await H1(this,B1,"m",wY).call(this,Z),H1(this,B1,"m",HY).call(this,this._request(Z))}async _defaultAdapter(Z){const Y=await(Z.fetchImplementation||hK)(Z.url,Z),Q=await this.getResponseData(Z,Y);return this.translateResponse(Z,Y,Q)}async _request(Z={}){var $;try{let Y;if(Z.adapter)Y=await Z.adapter(Z,this._defaultAdapter.bind(this));else Y=await this._defaultAdapter(Z);if(!Z.validateStatus(Y.status)){if(Z.responseType==="stream"){let Q="";await new Promise((W)=>{(Y===null||Y===void 0?void 0:Y.data).on("data",(V)=>{Q+=V}),(Y===null||Y===void 0?void 0:Y.data).on("end",W)}),Y.data=Q}throw new b8.GaxiosError(`Request failed with status code ${Y.status}`,Z,Y)}return Y}catch(Y){const Q=Y instanceof b8.GaxiosError?Y:new b8.GaxiosError(Y.message,Z,void 0,Y),{shouldRetry:W,config:V}=await _K.getRetryConfig(Q);if(W&&V)return Q.config.retryConfig.currentRetryAttempt=V.retryConfig.currentRetryAttempt,Z.retryConfig=($=Q.config)===null||$===void 0?void 0:$.retryConfig,this._request(Z);throw Q}}async getResponseData(Z,$){switch(Z.responseType){case"stream":return $.body;case"json":{let Y=await $.text();try{Y=JSON.parse(Y)}catch(Q){}return Y}case"arraybuffer":return $.arrayBuffer();case"blob":return $.blob();case"text":return $.text();default:return this.getResponseDataFromContentType($)}}validateStatus(Z){return Z>=200&&Z<300}paramsSerializer(Z){return jK.default.stringify(Z)}translateResponse(Z,$,Y){const Q={};return $.headers.forEach((W,V)=>{Q[V]=W}),{config:Z,data:Y,headers:Q,status:$.status,statusText:$.statusText,request:{responseURL:$.url}}}async getResponseDataFromContentType(Z){let $=Z.headers.get("Content-Type");if($===null)return Z.text();if($=$.toLowerCase(),$.includes("application/json")){let Y=await Z.text();try{Y=JSON.parse(Y)}catch(Q){}return Y}else if($.match(/^text\//))return Z.text();else return Z.blob()}async*getMultipartRequest(Z,$){const Y=`--${$}--`;for(let Q of Z){const W=Q.headers["Content-Type"]||"application/octet-stream";if(yield`--${$}\r\nContent-Type: ${W}\r\n\r\n`,typeof Q.content==="string")yield Q.content;else yield*Q.content;yield"\r\n"}yield Y}}X0.Gaxios=s4;w1=s4,B1=new WeakSet,WY=function Z($,Y=[]){var Q,W;const V=new JY.URL($),J=[...Y],K=((W=(Q=process.env.NO_PROXY)!==null&&Q!==void 0?Q:process.env.no_proxy)===null||W===void 0?void 0:W.split(","))||[];for(let w of K)J.push(w.trim());for(let w of J)if(w instanceof RegExp){if(w.test(V.toString()))return!1}else if(w instanceof JY.URL){if(w.origin===V.origin)return!1}else if(w.startsWith("*.")||w.startsWith(".")){const L=w.replace(/^\*\./,".");if(V.hostname.endsWith(L))return!1}else if(w===V.origin||w===V.hostname||w===V.href)return!1;return!0},wY=async function Z($){let Y=Promise.resolve($);for(let Q of this.interceptors.request.values())if(Q)Y=Y.then(Q.resolved,Q.rejected);return Y},HY=async function Z($){let Y=Promise.resolve($);for(let Q of this.interceptors.response.values())if(Q)Y=Y.then(Q.resolved,Q.rejected);return Y},UY=async function Z($){var Y,Q,W,V;const J=PK.default(!0,{},this.defaults,$);if(!J.url)throw new Error("URL is required.");const K=J.baseUrl||J.baseURL;if(K)J.url=K.toString()+J.url;if(J.paramsSerializer=J.paramsSerializer||this.paramsSerializer,J.params&&Object.keys(J.params).length>0){let F=J.paramsSerializer(J.params);if(F.startsWith("?"))F=F.slice(1);const C=J.url.toString().includes("?")?"&":"?";J.url=J.url+C+F}if(typeof $.maxContentLength==="number")J.size=$.maxContentLength;if(typeof $.maxRedirects==="number")J.follow=$.maxRedirects;if(J.headers=J.headers||{},J.multipart===void 0&&J.data){const F=typeof FormData==="undefined"?!1:(J===null||J===void 0?void 0:J.data)instanceof FormData;if(EK.default.readable(J.data))J.body=J.data;else if(vK()&&Buffer.isBuffer(J.data)){if(J.body=J.data,!zY(J,"Content-Type"))J.headers["Content-Type"]="application/json"}else if(typeof J.data==="object"){if(!F)if(qY(J,"content-type")==="application/x-www-form-urlencoded")J.body=J.paramsSerializer(J.data);else{if(!zY(J,"Content-Type"))J.headers["Content-Type"]="application/json";J.body=JSON.stringify(J.data)}}else J.body=J.data}else if(J.multipart&&J.multipart.length>0){const F=xK.v4();J.headers["Content-Type"]=`multipart/related; boundary=${F}`;const C=new XY.PassThrough;J.body=C,XY.pipeline(this.getMultipartRequest(J.multipart,F),C,()=>{})}if(J.validateStatus=J.validateStatus||this.validateStatus,J.responseType=J.responseType||"unknown",!J.headers.Accept&&J.responseType==="json")J.headers.Accept="application/json";J.method=J.method||"GET";const w=J.proxy||((Y=process===null||process===void 0?void 0:process.env)===null||Y===void 0?void 0:Y.HTTPS_PROXY)||((Q=process===null||process===void 0?void 0:process.env)===null||Q===void 0?void 0:Q.https_proxy)||((W=process===null||process===void 0?void 0:process.env)===null||W===void 0?void 0:W.HTTP_PROXY)||((V=process===null||process===void 0?void 0:process.env)===null||V===void 0?void 0:V.http_proxy),L=H1(this,B1,"m",WY).call(this,J.url,J.noProxy);if(J.agent);else if(w&&L){const F=await H1(w1,w1,"m",VY).call(w1);if(this.agentCache.has(w))J.agent=this.agentCache.get(w);else J.agent=new F(w,{cert:J.cert,key:J.key}),this.agentCache.set(w,J.agent)}else if(J.cert&&J.key)if(this.agentCache.has(J.key))J.agent=this.agentCache.get(J.key);else J.agent=new BK.Agent({cert:J.cert,key:J.key}),this.agentCache.set(J.key,J.agent);if(typeof J.errorRedactor!=="function"&&J.errorRedactor!==!1)J.errorRedactor=b8.defaultErrorRedactor;return J},VY=async function Z(){return SK(this,w1,H1(this,w1,"f",y8)||(await Promise.resolve().then(()=>OK(QY()))).HttpsProxyAgent,"f",y8),H1(this,w1,"f",y8)};y8={value:void 0}});var P0=O((z0)=>{async function mK(Z){return z0.instance.request(Z)}var yK=z0&&z0.__createBinding||(Object.create?function(Z,$,Y,Q){if(Q===void 0)Q=Y;var W=Object.getOwnPropertyDescriptor($,Y);if(!W||("get"in W?!$.__esModule:W.writable||W.configurable))W={enumerable:!0,get:function(){return $[Y]}};Object.defineProperty(Z,Q,W)}:function(Z,$,Y,Q){if(Q===void 0)Q=Y;Z[Q]=$[Y]}),bK=z0&&z0.__exportStar||function(Z,$){for(var Y in Z)if(Y!=="default"&&!Object.prototype.hasOwnProperty.call($,Y))yK($,Z,Y)};Object.defineProperty(z0,"__esModule",{value:!0});z0.instance=z0.Gaxios=z0.GaxiosError=void 0;z0.request=mK;var MY=FY();Object.defineProperty(z0,"Gaxios",{enumerable:!0,get:function(){return MY.Gaxios}});var gK=y4();Object.defineProperty(z0,"GaxiosError",{enumerable:!0,get:function(){return gK.GaxiosError}});bK(c4(),z0);z0.instance=new MY.Gaxios});var e4=O((GY,m8)=>{(function(Z){var $,Y=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,Q=Math.ceil,W=Math.floor,V="[BigNumber Error] ",J=V+"Number primitive has more than 15 significant digits: ",K=100000000000000,w=14,L=9007199254740991,F=[1,10,100,1000,1e4,1e5,1e6,1e7,1e8,1e9,10000000000,100000000000,1000000000000,10000000000000],C=1e7,S=1e9;function v(k){var _,g,c,A=P.prototype={constructor:P,toString:null,valueOf:null},Z0=new P(1),a=20,t=4,H0=-7,M0=21,Y1=-1e7,O0=1e7,Q1=!1,d1=1,t0=0,H4={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},W1="0123456789abcdefghijklmnopqrstuvwxyz",U4=!0;function P(X,z){var H,N,q,G,R,U,M,I,D=this;if(!(D instanceof P))return new P(X,z);if(z==null){if(X&&X._isBigNumber===!0){if(D.s=X.s,!X.c||X.e>O0)D.c=D.e=null;else if(X.e<Y1)D.c=[D.e=0];else D.e=X.e,D.c=X.c.slice();return}if((U=typeof X=="number")&&X*0==0){if(D.s=1/X<0?(X=-X,-1):1,X===~~X){for(G=0,R=X;R>=10;R/=10,G++);if(G>O0)D.c=D.e=null;else D.e=G,D.c=[X];return}I=String(X)}else{if(!Y.test(I=String(X)))return c(D,I,U);D.s=I.charCodeAt(0)==45?(I=I.slice(1),-1):1}if((G=I.indexOf("."))>-1)I=I.replace(".","");if((R=I.search(/e/i))>0){if(G<0)G=R;G+=+I.slice(R+1),I=I.substring(0,R)}else if(G<0)G=I.length}else{if(B(z,2,W1.length,"Base"),z==10&&U4)return D=new P(X),D0(D,a+D.e+1,t);if(I=String(X),U=typeof X=="number"){if(X*0!=0)return c(D,I,U,z);if(D.s=1/X<0?(I=I.slice(1),-1):1,P.DEBUG&&I.replace(/^0\.0*|\./,"").length>15)throw Error(J+X)}else D.s=I.charCodeAt(0)===45?(I=I.slice(1),-1):1;H=W1.slice(0,z),G=R=0;for(M=I.length;R<M;R++)if(H.indexOf(N=I.charAt(R))<0){if(N=="."){if(R>G){G=M;continue}}else if(!q){if(I==I.toUpperCase()&&(I=I.toLowerCase())||I==I.toLowerCase()&&(I=I.toUpperCase())){q=!0,R=-1,G=0;continue}}return c(D,String(X),U,z)}if(U=!1,I=g(I,z,10,D.s),(G=I.indexOf("."))>-1)I=I.replace(".","");else G=I.length}for(R=0;I.charCodeAt(R)===48;R++);for(M=I.length;I.charCodeAt(--M)===48;);if(I=I.slice(R,++M)){if(M-=R,U&&P.DEBUG&&M>15&&(X>L||X!==W(X)))throw Error(J+D.s*X);if((G=G-R-1)>O0)D.c=D.e=null;else if(G<Y1)D.c=[D.e=0];else{if(D.e=G,D.c=[],R=(G+1)%w,G<0)R+=w;if(R<M){if(R)D.c.push(+I.slice(0,R));for(M-=w;R<M;)D.c.push(+I.slice(R,R+=w));R=w-(I=I.slice(R)).length}else R-=M;for(;R--;I+="0");D.c.push(+I)}}else D.c=[D.e=0]}P.clone=v,P.ROUND_UP=0,P.ROUND_DOWN=1,P.ROUND_CEIL=2,P.ROUND_FLOOR=3,P.ROUND_HALF_UP=4,P.ROUND_HALF_DOWN=5,P.ROUND_HALF_EVEN=6,P.ROUND_HALF_CEIL=7,P.ROUND_HALF_FLOOR=8,P.EUCLID=9,P.config=P.set=function(X){var z,H;if(X!=null)if(typeof X=="object"){if(X.hasOwnProperty(z="DECIMAL_PLACES"))H=X[z],B(H,0,S,z),a=H;if(X.hasOwnProperty(z="ROUNDING_MODE"))H=X[z],B(H,0,8,z),t=H;if(X.hasOwnProperty(z="EXPONENTIAL_AT"))if(H=X[z],H&&H.pop)B(H[0],-S,0,z),B(H[1],0,S,z),H0=H[0],M0=H[1];else B(H,-S,S,z),H0=-(M0=H<0?-H:H);if(X.hasOwnProperty(z="RANGE"))if(H=X[z],H&&H.pop)B(H[0],-S,-1,z),B(H[1],1,S,z),Y1=H[0],O0=H[1];else if(B(H,-S,S,z),H)Y1=-(O0=H<0?-H:H);else throw Error(V+z+" cannot be zero: "+H);if(X.hasOwnProperty(z="CRYPTO"))if(H=X[z],H===!!H)if(H)if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Q1=H;else throw Q1=!H,Error(V+"crypto unavailable");else Q1=H;else throw Error(V+z+" not true or false: "+H);if(X.hasOwnProperty(z="MODULO_MODE"))H=X[z],B(H,0,9,z),d1=H;if(X.hasOwnProperty(z="POW_PRECISION"))H=X[z],B(H,0,S,z),t0=H;if(X.hasOwnProperty(z="FORMAT"))if(H=X[z],typeof H=="object")H4=H;else throw Error(V+z+" not an object: "+H);if(X.hasOwnProperty(z="ALPHABET"))if(H=X[z],typeof H=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(H))U4=H.slice(0,10)=="0123456789",W1=H;else throw Error(V+z+" invalid: "+H)}else throw Error(V+"Object expected: "+X);return{DECIMAL_PLACES:a,ROUNDING_MODE:t,EXPONENTIAL_AT:[H0,M0],RANGE:[Y1,O0],CRYPTO:Q1,MODULO_MODE:d1,POW_PRECISION:t0,FORMAT:H4,ALPHABET:W1}},P.isBigNumber=function(X){if(!X||X._isBigNumber!==!0)return!1;if(!P.DEBUG)return!0;var z,H,N=X.c,q=X.e,G=X.s;Z:if({}.toString.call(N)=="[object Array]"){if((G===1||G===-1)&&q>=-S&&q<=S&&q===W(q)){if(N[0]===0){if(q===0&&N.length===1)return!0;break Z}if(z=(q+1)%w,z<1)z+=w;if(String(N[0]).length==z){for(z=0;z<N.length;z++)if(H=N[z],H<0||H>=K||H!==W(H))break Z;if(H!==0)return!0}}}else if(N===null&&q===null&&(G===null||G===1||G===-1))return!0;throw Error(V+"Invalid BigNumber: "+X)},P.maximum=P.max=function(){return SZ(arguments,-1)},P.minimum=P.min=function(){return SZ(arguments,1)},P.random=function(){var X=9007199254740992,z=Math.random()*X&2097151?function(){return W(Math.random()*X)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(H){var N,q,G,R,U,M=0,I=[],D=new P(Z0);if(H==null)H=a;else B(H,0,S);if(R=Q(H/w),Q1)if(crypto.getRandomValues){N=crypto.getRandomValues(new Uint32Array(R*=2));for(;M<R;)if(U=N[M]*131072+(N[M+1]>>>11),U>=9000000000000000)q=crypto.getRandomValues(new Uint32Array(2)),N[M]=q[0],N[M+1]=q[1];else I.push(U%100000000000000),M+=2;M=R/2}else if(crypto.randomBytes){N=crypto.randomBytes(R*=7);for(;M<R;)if(U=(N[M]&31)*281474976710656+N[M+1]*1099511627776+N[M+2]*4294967296+N[M+3]*16777216+(N[M+4]<<16)+(N[M+5]<<8)+N[M+6],U>=9000000000000000)crypto.randomBytes(7).copy(N,M);else I.push(U%100000000000000),M+=7;M=R/7}else throw Q1=!1,Error(V+"crypto unavailable");if(!Q1){for(;M<R;)if(U=z(),U<9000000000000000)I[M++]=U%100000000000000}if(R=I[--M],H%=w,R&&H)U=F[w-H],I[M]=W(R/U)*U;for(;I[M]===0;I.pop(),M--);if(M<0)I=[G=0];else{for(G=-1;I[0]===0;I.splice(0,1),G-=w);for(M=1,U=I[0];U>=10;U/=10,M++);if(M<w)G-=w-M}return D.e=G,D.c=I,D}}(),P.sum=function(){var X=1,z=arguments,H=new P(z[0]);for(;X<z.length;)H=H.plus(z[X++]);return H},g=function(){var X="0123456789";function z(H,N,q,G){var R,U=[0],M,I=0,D=H.length;for(;I<D;){for(M=U.length;M--;U[M]*=N);U[0]+=G.indexOf(H.charAt(I++));for(R=0;R<U.length;R++)if(U[R]>q-1){if(U[R+1]==null)U[R+1]=0;U[R+1]+=U[R]/q|0,U[R]%=q}}return U.reverse()}return function(H,N,q,G,R){var U,M,I,D,T,x,f,l,s=H.indexOf("."),$0=a,d=t;if(s>=0)D=t0,t0=0,H=H.replace(".",""),l=new P(N),x=l.pow(H.length-s),t0=D,l.c=z(n(j(x.c),x.e,"0"),10,q,X),l.e=l.c.length;f=z(H,N,q,R?(U=W1,X):(U=X,W1)),I=D=f.length;for(;f[--D]==0;f.pop());if(!f[0])return U.charAt(0);if(s<0)--I;else x.c=f,x.e=I,x.s=G,x=_(x,l,$0,d,q),f=x.c,T=x.r,I=x.e;if(M=I+$0+1,s=f[M],D=q/2,T=T||M<0||f[M+1]!=null,T=d<4?(s!=null||T)&&(d==0||d==(x.s<0?3:2)):s>D||s==D&&(d==4||T||d==6&&f[M-1]&1||d==(x.s<0?8:7)),M<1||!f[0])H=T?n(U.charAt(1),-$0,U.charAt(0)):U.charAt(0);else{if(f.length=M,T){for(--q;++f[--M]>q;)if(f[M]=0,!M)++I,f=[1].concat(f)}for(D=f.length;!f[--D];);for(s=0,H="";s<=D;H+=U.charAt(f[s++]));H=n(H,I,U.charAt(0))}return H}}(),_=function(){function X(N,q,G){var R,U,M,I,D=0,T=N.length,x=q%C,f=q/C|0;for(N=N.slice();T--;)M=N[T]%C,I=N[T]/C|0,R=f*M+I*x,U=x*M+R%C*C+D,D=(U/G|0)+(R/C|0)+f*I,N[T]=U%G;if(D)N=[D].concat(N);return N}function z(N,q,G,R){var U,M;if(G!=R)M=G>R?1:-1;else for(U=M=0;U<G;U++)if(N[U]!=q[U]){M=N[U]>q[U]?1:-1;break}return M}function H(N,q,G,R){var U=0;for(;G--;)N[G]-=U,U=N[G]<q[G]?1:0,N[G]=U*R+N[G]-q[G];for(;!N[0]&&N.length>1;N.splice(0,1));}return function(N,q,G,R,U){var M,I,D,T,x,f,l,s,$0,d,p,V0,M8,M4,G4,x0,l1,N0=N.s==q.s?1:-1,K0=N.c,e=q.c;if(!K0||!K0[0]||!e||!e[0])return new P(!N.s||!q.s||(K0?e&&K0[0]==e[0]:!e)?NaN:K0&&K0[0]==0||!e?N0*0:N0/0);if(s=new P(N0),$0=s.c=[],I=N.e-q.e,N0=G+I+1,!U)U=K,I=y(N.e/w)-y(q.e/w),N0=N0/w|0;for(D=0;e[D]==(K0[D]||0);D++);if(e[D]>(K0[D]||0))I--;if(N0<0)$0.push(1),T=!0;else{if(M4=K0.length,x0=e.length,D=0,N0+=2,x=W(U/(e[0]+1)),x>1)e=X(e,x,U),K0=X(K0,x,U),x0=e.length,M4=K0.length;M8=x0,d=K0.slice(0,x0),p=d.length;for(;p<x0;d[p++]=0);if(l1=e.slice(),l1=[0].concat(l1),G4=e[0],e[1]>=U/2)G4++;do{if(x=0,M=z(e,d,x0,p),M<0){if(V0=d[0],x0!=p)V0=V0*U+(d[1]||0);if(x=W(V0/G4),x>1){if(x>=U)x=U-1;f=X(e,x,U),l=f.length,p=d.length;while(z(f,d,l,p)==1)x--,H(f,x0<l?l1:e,l,U),l=f.length,M=1}else{if(x==0)M=x=1;f=e.slice(),l=f.length}if(l<p)f=[0].concat(f);if(H(d,f,p,U),p=d.length,M==-1)while(z(e,d,x0,p)<1)x++,H(d,x0<p?l1:e,p,U),p=d.length}else if(M===0)x++,d=[0];if($0[D++]=x,d[0])d[p++]=K0[M8]||0;else d=[K0[M8]],p=1}while((M8++<M4||d[0]!=null)&&N0--);if(T=d[0]!=null,!$0[0])$0.splice(0,1)}if(U==K){for(D=1,N0=$0[0];N0>=10;N0/=10,D++);D0(s,G+(s.e=D+I*w-1)+1,R,T)}else s.e=I,s.r=+T;return s}}();function q4(X,z,H,N){var q,G,R,U,M;if(H==null)H=t;else B(H,0,8);if(!X.c)return X.toString();if(q=X.c[0],R=X.e,z==null)M=j(X.c),M=N==1||N==2&&(R<=H0||R>=M0)?u(M,R):n(M,R,"0");else if(X=D0(new P(X),z,H),G=X.e,M=j(X.c),U=M.length,N==1||N==2&&(z<=G||G<=H0)){for(;U<z;M+="0",U++);M=u(M,G)}else if(z-=R,M=n(M,G,"0"),G+1>U){if(--z>0)for(M+=".";z--;M+="0");}else if(z+=G-U,z>0){if(G+1==U)M+=".";for(;z--;M+="0");}return X.s<0&&q?"-"+M:M}function SZ(X,z){var H,N,q=1,G=new P(X[0]);for(;q<X.length;q++)if(N=new P(X[q]),!N.s||(H=E(G,N))===z||H===0&&G.s===z)G=N;return G}function F4(X,z,H){var N=1,q=z.length;for(;!z[--q];z.pop());for(q=z[0];q>=10;q/=10,N++);if((H=N+H*w-1)>O0)X.c=X.e=null;else if(H<Y1)X.c=[X.e=0];else X.e=H,X.c=z;return X}c=function(){var X=/^(-?)0([xbo])(?=\w[\w.]*$)/i,z=/^([^.]+)\.$/,H=/^\.([^.]+)$/,N=/^-?(Infinity|NaN)$/,q=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(G,R,U,M){var I,D=U?R:R.replace(q,"");if(N.test(D))G.s=isNaN(D)?null:D<0?-1:1;else{if(!U){if(D=D.replace(X,function(T,x,f){return I=(f=f.toLowerCase())=="x"?16:f=="b"?2:8,!M||M==I?x:T}),M)I=M,D=D.replace(z,"$1").replace(H,"0.$1");if(R!=D)return new P(D,I)}if(P.DEBUG)throw Error(V+"Not a"+(M?" base "+M:"")+" number: "+R);G.s=null}G.c=G.e=null}}();function D0(X,z,H,N){var q,G,R,U,M,I,D,T=X.c,x=F;if(T){Z:{for(q=1,U=T[0];U>=10;U/=10,q++);if(G=z-q,G<0)G+=w,R=z,M=T[I=0],D=W(M/x[q-R-1]%10);else if(I=Q((G+1)/w),I>=T.length)if(N){for(;T.length<=I;T.push(0));M=D=0,q=1,G%=w,R=G-w+1}else break Z;else{M=U=T[I];for(q=1;U>=10;U/=10,q++);G%=w,R=G-w+q,D=R<0?0:W(M/x[q-R-1]%10)}if(N=N||z<0||T[I+1]!=null||(R<0?M:M%x[q-R-1]),N=H<4?(D||N)&&(H==0||H==(X.s<0?3:2)):D>5||D==5&&(H==4||N||H==6&&(G>0?R>0?M/x[q-R]:0:T[I-1])%10&1||H==(X.s<0?8:7)),z<1||!T[0]){if(T.length=0,N)z-=X.e+1,T[0]=x[(w-z%w)%w],X.e=-z||0;else T[0]=X.e=0;return X}if(G==0)T.length=I,U=1,I--;else T.length=I+1,U=x[w-G],T[I]=R>0?W(M/x[q-R]%x[R])*U:0;if(N)for(;;)if(I==0){for(G=1,R=T[0];R>=10;R/=10,G++);R=T[0]+=U;for(U=1;R>=10;R/=10,U++);if(G!=U){if(X.e++,T[0]==K)T[0]=1}break}else{if(T[I]+=U,T[I]!=K)break;T[I--]=0,U=1}for(G=T.length;T[--G]===0;T.pop());}if(X.e>O0)X.c=X.e=null;else if(X.e<Y1)X.c=[X.e=0]}return X}function d0(X){var z,H=X.e;if(H===null)return X.toString();return z=j(X.c),z=H<=H0||H>=M0?u(z,H):n(z,H,"0"),X.s<0?"-"+z:z}if(A.absoluteValue=A.abs=function(){var X=new P(this);if(X.s<0)X.s=1;return X},A.comparedTo=function(X,z){return E(this,new P(X,z))},A.decimalPlaces=A.dp=function(X,z){var H,N,q,G=this;if(X!=null){if(B(X,0,S),z==null)z=t;else B(z,0,8);return D0(new P(G),X+G.e+1,z)}if(!(H=G.c))return null;if(N=((q=H.length-1)-y(this.e/w))*w,q=H[q])for(;q%10==0;q/=10,N--);if(N<0)N=0;return N},A.dividedBy=A.div=function(X,z){return _(this,new P(X,z),a,t)},A.dividedToIntegerBy=A.idiv=function(X,z){return _(this,new P(X,z),0,1)},A.exponentiatedBy=A.pow=function(X,z){var H,N,q,G,R,U,M,I,D,T=this;if(X=new P(X),X.c&&!X.isInteger())throw Error(V+"Exponent not an integer: "+d0(X));if(z!=null)z=new P(z);if(U=X.e>14,!T.c||!T.c[0]||T.c[0]==1&&!T.e&&T.c.length==1||!X.c||!X.c[0])return D=new P(Math.pow(+d0(T),U?X.s*(2-b(X)):+d0(X))),z?D.mod(z):D;if(M=X.s<0,z){if(z.c?!z.c[0]:!z.s)return new P(NaN);if(N=!M&&T.isInteger()&&z.isInteger(),N)T=T.mod(z)}else if(X.e>9&&(T.e>0||T.e<-1||(T.e==0?T.c[0]>1||U&&T.c[1]>=240000000:T.c[0]<80000000000000||U&&T.c[0]<=99999750000000))){if(G=T.s<0&&b(X)?-0:0,T.e>-1)G=1/G;return new P(M?1/G:G)}else if(t0)G=Q(t0/w+2);if(U){if(H=new P(0.5),M)X.s=1;I=b(X)}else q=Math.abs(+d0(X)),I=q%2;D=new P(Z0);for(;;){if(I){if(D=D.times(T),!D.c)break;if(G){if(D.c.length>G)D.c.length=G}else if(N)D=D.mod(z)}if(q){if(q=W(q/2),q===0)break;I=q%2}else if(X=X.times(H),D0(X,X.e+1,1),X.e>14)I=b(X);else{if(q=+d0(X),q===0)break;I=q%2}if(T=T.times(T),G){if(T.c&&T.c.length>G)T.c.length=G}else if(N)T=T.mod(z)}if(N)return D;if(M)D=Z0.div(D);return z?D.mod(z):G?D0(D,t0,t,R):D},A.integerValue=function(X){var z=new P(this);if(X==null)X=t;else B(X,0,8);return D0(z,z.e+1,X)},A.isEqualTo=A.eq=function(X,z){return E(this,new P(X,z))===0},A.isFinite=function(){return!!this.c},A.isGreaterThan=A.gt=function(X,z){return E(this,new P(X,z))>0},A.isGreaterThanOrEqualTo=A.gte=function(X,z){return(z=E(this,new P(X,z)))===1||z===0},A.isInteger=function(){return!!this.c&&y(this.e/w)>this.c.length-2},A.isLessThan=A.lt=function(X,z){return E(this,new P(X,z))<0},A.isLessThanOrEqualTo=A.lte=function(X,z){return(z=E(this,new P(X,z)))===-1||z===0},A.isNaN=function(){return!this.s},A.isNegative=function(){return this.s<0},A.isPositive=function(){return this.s>0},A.isZero=function(){return!!this.c&&this.c[0]==0},A.minus=function(X,z){var H,N,q,G,R=this,U=R.s;if(X=new P(X,z),z=X.s,!U||!z)return new P(NaN);if(U!=z)return X.s=-z,R.plus(X);var M=R.e/w,I=X.e/w,D=R.c,T=X.c;if(!M||!I){if(!D||!T)return D?(X.s=-z,X):new P(T?R:NaN);if(!D[0]||!T[0])return T[0]?(X.s=-z,X):new P(D[0]?R:t==3?-0:0)}if(M=y(M),I=y(I),D=D.slice(),U=M-I){if(G=U<0)U=-U,q=D;else I=M,q=T;q.reverse();for(z=U;z--;q.push(0));q.reverse()}else{N=(G=(U=D.length)<(z=T.length))?U:z;for(U=z=0;z<N;z++)if(D[z]!=T[z]){G=D[z]<T[z];break}}if(G)q=D,D=T,T=q,X.s=-X.s;if(z=(N=T.length)-(H=D.length),z>0)for(;z--;D[H++]=0);z=K-1;for(;N>U;){if(D[--N]<T[N]){for(H=N;H&&!D[--H];D[H]=z);--D[H],D[N]+=K}D[N]-=T[N]}for(;D[0]==0;D.splice(0,1),--I);if(!D[0])return X.s=t==3?-1:1,X.c=[X.e=0],X;return F4(X,D,I)},A.modulo=A.mod=function(X,z){var H,N,q=this;if(X=new P(X,z),!q.c||!X.s||X.c&&!X.c[0])return new P(NaN);else if(!X.c||q.c&&!q.c[0])return new P(q);if(d1==9)N=X.s,X.s=1,H=_(q,X,0,3),X.s=N,H.s*=N;else H=_(q,X,0,d1);if(X=q.minus(H.times(X)),!X.c[0]&&d1==1)X.s=q.s;return X},A.multipliedBy=A.times=function(X,z){var H,N,q,G,R,U,M,I,D,T,x,f,l,s,$0,d=this,p=d.c,V0=(X=new P(X,z)).c;if(!p||!V0||!p[0]||!V0[0]){if(!d.s||!X.s||p&&!p[0]&&!V0||V0&&!V0[0]&&!p)X.c=X.e=X.s=null;else if(X.s*=d.s,!p||!V0)X.c=X.e=null;else X.c=[0],X.e=0;return X}if(N=y(d.e/w)+y(X.e/w),X.s*=d.s,M=p.length,T=V0.length,M<T)l=p,p=V0,V0=l,q=M,M=T,T=q;for(q=M+T,l=[];q--;l.push(0));s=K,$0=C;for(q=T;--q>=0;){H=0,x=V0[q]%$0,f=V0[q]/$0|0;for(R=M,G=q+R;G>q;)I=p[--R]%$0,D=p[R]/$0|0,U=f*I+D*x,I=x*I+U%$0*$0+l[G]+H,H=(I/s|0)+(U/$0|0)+f*D,l[G--]=I%s;l[G]=H}if(H)++N;else l.splice(0,1);return F4(X,l,N)},A.negated=function(){var X=new P(this);return X.s=-X.s||null,X},A.plus=function(X,z){var H,N=this,q=N.s;if(X=new P(X,z),z=X.s,!q||!z)return new P(NaN);if(q!=z)return X.s=-z,N.minus(X);var G=N.e/w,R=X.e/w,U=N.c,M=X.c;if(!G||!R){if(!U||!M)return new P(q/0);if(!U[0]||!M[0])return M[0]?X:new P(U[0]?N:q*0)}if(G=y(G),R=y(R),U=U.slice(),q=G-R){if(q>0)R=G,H=M;else q=-q,H=U;H.reverse();for(;q--;H.push(0));H.reverse()}if(q=U.length,z=M.length,q-z<0)H=M,M=U,U=H,z=q;for(q=0;z;)q=(U[--z]=U[z]+M[z]+q)/K|0,U[z]=K===U[z]?0:U[z]%K;if(q)U=[q].concat(U),++R;return F4(X,U,R)},A.precision=A.sd=function(X,z){var H,N,q,G=this;if(X!=null&&X!==!!X){if(B(X,1,S),z==null)z=t;else B(z,0,8);return D0(new P(G),X,z)}if(!(H=G.c))return null;if(q=H.length-1,N=q*w+1,q=H[q]){for(;q%10==0;q/=10,N--);for(q=H[0];q>=10;q/=10,N++);}if(X&&G.e+1>N)N=G.e+1;return N},A.shiftedBy=function(X){return B(X,-L,L),this.times("1e"+X)},A.squareRoot=A.sqrt=function(){var X,z,H,N,q,G=this,R=G.c,U=G.s,M=G.e,I=a+4,D=new P("0.5");if(U!==1||!R||!R[0])return new P(!U||U<0&&(!R||R[0])?NaN:R?G:1/0);if(U=Math.sqrt(+d0(G)),U==0||U==1/0){if(z=j(R),(z.length+M)%2==0)z+="0";if(U=Math.sqrt(+z),M=y((M+1)/2)-(M<0||M%2),U==1/0)z="5e"+M;else z=U.toExponential(),z=z.slice(0,z.indexOf("e")+1)+M;H=new P(z)}else H=new P(U+"");if(H.c[0]){if(M=H.e,U=M+I,U<3)U=0;for(;;)if(q=H,H=D.times(q.plus(_(G,q,I,1))),j(q.c).slice(0,U)===(z=j(H.c)).slice(0,U)){if(H.e<M)--U;if(z=z.slice(U-3,U+1),z=="9999"||!N&&z=="4999"){if(!N){if(D0(q,q.e+a+2,0),q.times(q).eq(G)){H=q;break}}I+=4,U+=4,N=1}else{if(!+z||!+z.slice(1)&&z.charAt(0)=="5")D0(H,H.e+a+2,1),X=!H.times(H).eq(G);break}}}return D0(H,H.e+a+1,t,X)},A.toExponential=function(X,z){if(X!=null)B(X,0,S),X++;return q4(this,X,z,1)},A.toFixed=function(X,z){if(X!=null)B(X,0,S),X=X+this.e+1;return q4(this,X,z)},A.toFormat=function(X,z,H){var N,q=this;if(H==null)if(X!=null&&z&&typeof z=="object")H=z,z=null;else if(X&&typeof X=="object")H=X,X=z=null;else H=H4;else if(typeof H!="object")throw Error(V+"Argument not an object: "+H);if(N=q.toFixed(X,z),q.c){var G,R=N.split("."),U=+H.groupSize,M=+H.secondaryGroupSize,I=H.groupSeparator||"",D=R[0],T=R[1],x=q.s<0,f=x?D.slice(1):D,l=f.length;if(M)G=U,U=M,M=G,l-=G;if(U>0&&l>0){G=l%U||U,D=f.substr(0,G);for(;G<l;G+=U)D+=I+f.substr(G,U);if(M>0)D+=I+f.slice(G);if(x)D="-"+D}N=T?D+(H.decimalSeparator||"")+((M=+H.fractionGroupSize)?T.replace(new RegExp("\\d{"+M+"}\\B","g"),"$&"+(H.fractionGroupSeparator||"")):T):D}return(H.prefix||"")+N+(H.suffix||"")},A.toFraction=function(X){var z,H,N,q,G,R,U,M,I,D,T,x,f=this,l=f.c;if(X!=null){if(U=new P(X),!U.isInteger()&&(U.c||U.s!==1)||U.lt(Z0))throw Error(V+"Argument "+(U.isInteger()?"out of range: ":"not an integer: ")+d0(U))}if(!l)return new P(f);z=new P(Z0),I=H=new P(Z0),N=M=new P(Z0),x=j(l),G=z.e=x.length-f.e-1,z.c[0]=F[(R=G%w)<0?w+R:R],X=!X||U.comparedTo(z)>0?G>0?z:I:U,R=O0,O0=1/0,U=new P(x),M.c[0]=0;for(;;){if(D=_(U,z,0,1),q=H.plus(D.times(N)),q.comparedTo(X)==1)break;H=N,N=q,I=M.plus(D.times(q=I)),M=q,z=U.minus(D.times(q=z)),U=q}return q=_(X.minus(H),N,0,1),M=M.plus(q.times(I)),H=H.plus(q.times(N)),M.s=I.s=f.s,G=G*2,T=_(I,N,G,t).minus(f).abs().comparedTo(_(M,H,G,t).minus(f).abs())<1?[I,N]:[M,H],O0=R,T},A.toNumber=function(){return+d0(this)},A.toPrecision=function(X,z){if(X!=null)B(X,1,S);return q4(this,X,z,2)},A.toString=function(X){var z,H=this,N=H.s,q=H.e;if(q===null)if(N){if(z="Infinity",N<0)z="-"+z}else z="NaN";else{if(X==null)z=q<=H0||q>=M0?u(j(H.c),q):n(j(H.c),q,"0");else if(X===10&&U4)H=D0(new P(H),a+q+1,t),z=n(j(H.c),H.e,"0");else B(X,2,W1.length,"Base"),z=g(n(j(H.c),q,"0"),10,X,N,!0);if(N<0&&H.c[0])z="-"+z}return z},A.valueOf=A.toJSON=function(){return d0(this)},A._isBigNumber=!0,k!=null)P.set(k);return P}function y(k){var _=k|0;return k>0||k===_?_:_-1}function j(k){var _,g,c=1,A=k.length,Z0=k[0]+"";for(;c<A;){_=k[c++]+"",g=w-_.length;for(;g--;_="0"+_);Z0+=_}for(A=Z0.length;Z0.charCodeAt(--A)===48;);return Z0.slice(0,A+1||1)}function E(k,_){var g,c,A=k.c,Z0=_.c,a=k.s,t=_.s,H0=k.e,M0=_.e;if(!a||!t)return null;if(g=A&&!A[0],c=Z0&&!Z0[0],g||c)return g?c?0:-t:a;if(a!=t)return a;if(g=a<0,c=H0==M0,!A||!Z0)return c?0:!A^g?1:-1;if(!c)return H0>M0^g?1:-1;t=(H0=A.length)<(M0=Z0.length)?H0:M0;for(a=0;a<t;a++)if(A[a]!=Z0[a])return A[a]>Z0[a]^g?1:-1;return H0==M0?0:H0>M0^g?1:-1}function B(k,_,g,c){if(k<_||k>g||k!==W(k))throw Error(V+(c||"Argument")+(typeof k=="number"?k<_||k>g?" out of range: ":" not an integer: ":" not a primitive number: ")+String(k))}function b(k){var _=k.c.length-1;return y(k.e/w)==_&&k.c[_]%2!=0}function u(k,_){return(k.length>1?k.charAt(0)+"."+k.slice(1):k)+(_<0?"e":"e+")+_}function n(k,_,g){var c,A;if(_<0){for(A=g+".";++_;A+=g);k=A+k}else if(c=k.length,++_>c){for(A=g,_-=c;--_;A+=g);k+=A}else if(_<c)k=k.slice(0,_)+"."+k.slice(_);return k}if($=v(),$.default=$.BigNumber=$,typeof define=="function"&&define.amd)define(function(){return $});else if(typeof m8!="undefined"&&m8.exports)m8.exports=$;else{if(!Z)Z=typeof self!="undefined"&&self?self:window;Z.BigNumber=$}})(GY)});var RY=O((cU,IY)=>{var DY=e4(),NY=cU;(function(){function Z(L){return L<10?"0"+L:L}var $=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,Y=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,Q,W,V={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},J;function K(L){return Y.lastIndex=0,Y.test(L)?'"'+L.replace(Y,function(F){var C=V[F];return typeof C==="string"?C:"\\u"+("0000"+F.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+L+'"'}function w(L,F){var C,S,v,y,j=Q,E,B=F[L],b=B!=null&&(B instanceof DY||DY.isBigNumber(B));if(B&&typeof B==="object"&&typeof B.toJSON==="function")B=B.toJSON(L);if(typeof J==="function")B=J.call(F,L,B);switch(typeof B){case"string":if(b)return B;else return K(B);case"number":return isFinite(B)?String(B):"null";case"boolean":case"null":case"bigint":return String(B);case"object":if(!B)return"null";if(Q+=W,E=[],Object.prototype.toString.apply(B)==="[object Array]"){y=B.length;for(C=0;C<y;C+=1)E[C]=w(C,B)||"null";return v=E.length===0?"[]":Q?"[\n"+Q+E.join(",\n"+Q)+"\n"+j+"]":"["+E.join(",")+"]",Q=j,v}if(J&&typeof J==="object"){y=J.length;for(C=0;C<y;C+=1)if(typeof J[C]==="string"){if(S=J[C],v=w(S,B),v)E.push(K(S)+(Q?": ":":")+v)}}else Object.keys(B).forEach(function(u){var n=w(u,B);if(n)E.push(K(u)+(Q?": ":":")+n)});return v=E.length===0?"{}":Q?"{\n"+Q+E.join(",\n"+Q)+"\n"+j+"}":"{"+E.join(",")+"}",Q=j,v}}if(typeof NY.stringify!=="function")NY.stringify=function(L,F,C){var S;if(Q="",W="",typeof C==="number")for(S=0;S<C;S+=1)W+=" ";else if(typeof C==="string")W=C;if(J=F,F&&typeof F!=="function"&&(typeof F!=="object"||typeof F.length!=="number"))throw new Error("JSON.stringify");return w("",{"":L})}})()});var CY=O((pU,LY)=>{var u8=null,uK=/(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])/,dK=/(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)/,lK=function(Z){var $={strict:!1,storeAsString:!1,alwaysParseAsBig:!1,useNativeBigInt:!1,protoAction:"error",constructorAction:"error"};if(Z!==void 0&&Z!==null){if(Z.strict===!0)$.strict=!0;if(Z.storeAsString===!0)$.storeAsString=!0;if($.alwaysParseAsBig=Z.alwaysParseAsBig===!0?Z.alwaysParseAsBig:!1,$.useNativeBigInt=Z.useNativeBigInt===!0?Z.useNativeBigInt:!1,typeof Z.constructorAction!=="undefined")if(Z.constructorAction==="error"||Z.constructorAction==="ignore"||Z.constructorAction==="preserve")$.constructorAction=Z.constructorAction;else throw new Error(`Incorrect value for constructorAction option, must be "error", "ignore" or undefined but passed ${Z.constructorAction}`);if(typeof Z.protoAction!=="undefined")if(Z.protoAction==="error"||Z.protoAction==="ignore"||Z.protoAction==="preserve")$.protoAction=Z.protoAction;else throw new Error(`Incorrect value for protoAction option, must be "error", "ignore" or undefined but passed ${Z.protoAction}`)}var Y,Q,W={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},V,J=function(j){throw{name:"SyntaxError",message:j,at:Y,text:V}},K=function(j){if(j&&j!==Q)J("Expected '"+j+"' instead of '"+Q+"'");return Q=V.charAt(Y),Y+=1,Q},w=function(){var j,E="";if(Q==="-")E="-",K("-");while(Q>="0"&&Q<="9")E+=Q,K();if(Q==="."){E+=".";while(K()&&Q>="0"&&Q<="9")E+=Q}if(Q==="e"||Q==="E"){if(E+=Q,K(),Q==="-"||Q==="+")E+=Q,K();while(Q>="0"&&Q<="9")E+=Q,K()}if(j=+E,!isFinite(j))J("Bad number");else{if(u8==null)u8=e4();if(E.length>15)return $.storeAsString?E:$.useNativeBigInt?BigInt(E):new u8(E);else return!$.alwaysParseAsBig?j:$.useNativeBigInt?BigInt(j):new u8(j)}},L=function(){var j,E,B="",b;if(Q==='"'){var u=Y;while(K()){if(Q==='"'){if(Y-1>u)B+=V.substring(u,Y-1);return K(),B}if(Q==="\\"){if(Y-1>u)B+=V.substring(u,Y-1);if(K(),Q==="u"){b=0;for(E=0;E<4;E+=1){if(j=parseInt(K(),16),!isFinite(j))break;b=b*16+j}B+=String.fromCharCode(b)}else if(typeof W[Q]==="string")B+=W[Q];else break;u=Y}}}J("Bad string")},F=function(){while(Q&&Q<=" ")K()},C=function(){switch(Q){case"t":return K("t"),K("r"),K("u"),K("e"),!0;case"f":return K("f"),K("a"),K("l"),K("s"),K("e"),!1;case"n":return K("n"),K("u"),K("l"),K("l"),null}J("Unexpected '"+Q+"'")},S,v=function(){var j=[];if(Q==="["){if(K("["),F(),Q==="]")return K("]"),j;while(Q){if(j.push(S()),F(),Q==="]")return K("]"),j;K(","),F()}}J("Bad array")},y=function(){var j,E=Object.create(null);if(Q==="{"){if(K("{"),F(),Q==="}")return K("}"),E;while(Q){if(j=L(),F(),K(":"),$.strict===!0&&Object.hasOwnProperty.call(E,j))J('Duplicate key "'+j+'"');if(uK.test(j)===!0)if($.protoAction==="error")J("Object contains forbidden prototype property");else if($.protoAction==="ignore")S();else E[j]=S();else if(dK.test(j)===!0)if($.constructorAction==="error")J("Object contains forbidden constructor property");else if($.constructorAction==="ignore")S();else E[j]=S();else E[j]=S();if(F(),Q==="}")return K("}"),E;K(","),F()}}J("Bad object")};return S=function(){switch(F(),Q){case"{":return y();case"[":return v();case'"':return L();case"-":return w();default:return Q>="0"&&Q<="9"?w():C()}},function(j,E){var B;if(V=j+"",Y=0,Q=" ",B=S(),F(),Q)J("Syntax error");return typeof E==="function"?function b(u,n){var k,_,g=u[n];if(g&&typeof g==="object")Object.keys(g).forEach(function(c){if(_=b(g,c),_!==void 0)g[c]=_;else delete g[c]});return E.call(u,n,g)}({"":B},""):B}};LY.exports=lK});var SY=O((iU,d8)=>{var TY=RY().stringify,OY=CY();d8.exports=function(Z){return{parse:OY(Z),stringify:TY}};d8.exports.parse=OY();d8.exports.stringify=TY});var $6=O((xY)=>{function AY(){return!!(process.env.CLOUD_RUN_JOB||process.env.FUNCTION_NAME||process.env.K_SERVICE)}function jY(){if(BY.platform()!=="linux")return!1;try{PY.statSync(xY.GCE_LINUX_BIOS_PATHS.BIOS_DATE);const Z=PY.readFileSync(xY.GCE_LINUX_BIOS_PATHS.BIOS_VENDOR,"utf8");return/Google/.test(Z)}catch(Z){return!1}}function EY(){const Z=BY.networkInterfaces();for(let $ of Object.values(Z)){if(!$)continue;for(let{mac:Y}of $)if(cK.test(Y))return!0}return!1}function _Y(){return jY()||EY()}function pK(){return AY()||_Y()}Object.defineProperty(xY,"__esModule",{value:!0});xY.detectGCPResidency=xY.isGoogleComputeEngine=xY.isGoogleComputeEngineMACAddress=xY.isGoogleComputeEngineLinux=xY.isGoogleCloudServerless=xY.GCE_LINUX_BIOS_PATHS=void 0;var PY=import.meta.require("fs"),BY=import.meta.require("os");xY.GCE_LINUX_BIOS_PATHS={BIOS_DATE:"/sys/class/dmi/id/bios_date",BIOS_VENDOR:"/sys/class/dmi/id/bios_vendor"};var cK=/^42:01/;xY.isGoogleCloudServerless=AY;xY.isGoogleComputeEngineLinux=jY;xY.isGoogleComputeEngineMACAddress=EY;xY.isGoogleComputeEngine=_Y;xY.detectGCPResidency=pK});var $8=O((h)=>{function Q6(Z){if(!Z)Z=process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST||h.HOST_ADDRESS;if(!/^https?:\/\//.test(Z))Z=`http://${Z}`;return new URL(h.BASE_PATH,Z).href}function Z3(Z){Object.keys(Z).forEach(($)=>{switch($){case"params":case"property":case"headers":break;case"qs":throw new Error("'qs' is not a valid configuration option. Please use 'params' instead.");default:throw new Error(`'${$}' is not a valid configuration option.`)}})}async function Z8(Z,$={},Y=3,Q=!1){let W="",V={},J={};if(typeof Z==="object"){const K=Z;W=K.metadataKey,V=K.params||V,J=K.headers||J,Y=K.noResponseRetries||Y,Q=K.fastFail||Q}else W=Z;if(typeof $==="string")W+=`/${$}`;else{if(Z3($),$.property)W+=`/${$.property}`;J=$.headers||J,V=$.params||V}try{const w=await(Q?$3:Y6.request)({url:`${Q6()}/${W}`,headers:{...h.HEADERS,...J},retryConfig:{noResponseRetries:Y},params:V,responseType:"text",timeout:kY()});if(w.headers[h.HEADER_NAME.toLowerCase()]!==h.HEADER_VALUE)throw new Error(`Invalid response from metadata service: incorrect ${h.HEADER_NAME} header.`);else if(!w.data)throw new Error("Invalid response from the metadata service");if(typeof w.data==="string")try{return sK.parse(w.data)}catch(L){}return w.data}catch(K){const w=K;if(w.response&&w.response.status!==200)w.message=`Unsuccessful response status code. ${w.message}`;throw K}}async function $3(Z){const $={...Z,url:Z.url.replace(Q6(),Q6(h.SECONDARY_HOST_ADDRESS))};let Y=!1;const Q=Y6.request(Z).then((V)=>{return Y=!0,V}).catch((V)=>{if(Y)return W;else throw Y=!0,V}),W=Y6.request($).then((V)=>{return Y=!0,V}).catch((V)=>{if(Y)return Q;else throw Y=!0,V});return Promise.race([Q,W])}function Y3(Z){return Z8("instance",Z)}function Q3(Z){return Z8("project",Z)}function W3(Z){return Z8("universe",Z)}async function V3(Z){const $={};return await Promise.all(Z.map((Y)=>{return(async()=>{const Q=await Z8(Y),W=Y.metadataKey;$[W]=Q})()})),$}function J3(){return process.env.DETECT_GCP_RETRIES?Number(process.env.DETECT_GCP_RETRIES):0}async function X3(){if(process.env.METADATA_SERVER_DETECTION){const Z=process.env.METADATA_SERVER_DETECTION.trim().toLocaleLowerCase();if(!(Z in h.METADATA_SERVER_DETECTION))throw new RangeError(`Unknown \`METADATA_SERVER_DETECTION\` env variable. Got \`${Z}\`, but it should be \`${Object.keys(h.METADATA_SERVER_DETECTION).join("`, `")}\`, or unset`);switch(Z){case"assume-present":return!0;case"none":return!1;case"bios-only":return W6();case"ping-only":}}try{if(l8===void 0)l8=Z8("instance",void 0,J3(),!(process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST));return await l8,!0}catch(Z){const $=Z;if(process.env.DEBUG_AUTH)console.info($);if($.type==="request-timeout")return!1;if($.response&&$.response.status===404)return!1;else{if(!($.response&&$.response.status===404)&&(!$.code||!["EHOSTDOWN","EHOSTUNREACH","ENETUNREACH","ENOENT","ENOTFOUND","ECONNREFUSED"].includes($.code))){let Y="UNKNOWN";if($.code)Y=$.code;process.emitWarning(`received unexpected error = ${$.message} code = ${Y}`,"MetadataLookupWarning")}return!1}}}function K3(){l8=void 0}function W6(){if(h.gcpResidencyCache===null)fY();return h.gcpResidencyCache}function fY(Z=null){h.gcpResidencyCache=Z!==null?Z:eK.detectGCPResidency()}function kY(){return W6()?0:3000}var rK=h&&h.__createBinding||(Object.create?function(Z,$,Y,Q){if(Q===void 0)Q=Y;var W=Object.getOwnPropertyDescriptor($,Y);if(!W||("get"in W?!$.__esModule:W.writable||W.configurable))W={enumerable:!0,get:function(){return $[Y]}};Object.defineProperty(Z,Q,W)}:function(Z,$,Y,Q){if(Q===void 0)Q=Y;Z[Q]=$[Y]}),tK=h&&h.__exportStar||function(Z,$){for(var Y in Z)if(Y!=="default"&&!Object.prototype.hasOwnProperty.call($,Y))rK($,Z,Y)};Object.defineProperty(h,"__esModule",{value:!0});h.requestTimeout=h.setGCPResidency=h.getGCPResidency=h.gcpResidencyCache=h.resetIsAvailableCache=h.isAvailable=h.bulk=h.universe=h.project=h.instance=h.METADATA_SERVER_DETECTION=h.HEADERS=h.HEADER_VALUE=h.HEADER_NAME=h.SECONDARY_HOST_ADDRESS=h.HOST_ADDRESS=h.BASE_PATH=void 0;var Y6=P0(),sK=SY(),eK=$6();h.BASE_PATH="/computeMetadata/v1";h.HOST_ADDRESS="http://169.254.169.254";h.SECONDARY_HOST_ADDRESS="http://metadata.google.internal.";h.HEADER_NAME="Metadata-Flavor";h.HEADER_VALUE="Google";h.HEADERS=Object.freeze({[h.HEADER_NAME]:h.HEADER_VALUE});h.METADATA_SERVER_DETECTION=Object.freeze({"assume-present":"don't try to ping the metadata server, but assume it's present",none:"don't try to ping the metadata server, but don't try to use it either","bios-only":"treat the result of a BIOS probe as canonical (don't fall back to pinging)","ping-only":"skip the BIOS probe, and go straight to pinging"});h.instance=Y3;h.project=Q3;h.universe=W3;h.bulk=V3;var l8;h.isAvailable=X3;h.resetIsAvailableCache=K3;h.gcpResidencyCache=null;h.getGCPResidency=W6;h.setGCPResidency=fY;h.requestTimeout=kY;tK($6(),h)});var bY=O((G3)=>{function yY(Z){var $=Z.length;if($%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var Y=Z.indexOf("=");if(Y===-1)Y=$;var Q=Y===$?0:4-Y%4;return[Y,Q]}function w3(Z){var $=yY(Z),Y=$[0],Q=$[1];return(Y+Q)*3/4-Q}function H3(Z,$,Y){return($+Y)*3/4-Y}function U3(Z){var $,Y=yY(Z),Q=Y[0],W=Y[1],V=new z3(H3(Z,Q,W)),J=0,K=W>0?Q-4:Q,w;for(w=0;w<K;w+=4)$=T0[Z.charCodeAt(w)]<<18|T0[Z.charCodeAt(w+1)]<<12|T0[Z.charCodeAt(w+2)]<<6|T0[Z.charCodeAt(w+3)],V[J++]=$>>16&255,V[J++]=$>>8&255,V[J++]=$&255;if(W===2)$=T0[Z.charCodeAt(w)]<<2|T0[Z.charCodeAt(w+1)]>>4,V[J++]=$&255;if(W===1)$=T0[Z.charCodeAt(w)]<<10|T0[Z.charCodeAt(w+1)]<<4|T0[Z.charCodeAt(w+2)]>>2,V[J++]=$>>8&255,V[J++]=$&255;return V}function q3(Z){return v0[Z>>18&63]+v0[Z>>12&63]+v0[Z>>6&63]+v0[Z&63]}function F3(Z,$,Y){var Q,W=[];for(var V=$;V<Y;V+=3)Q=(Z[V]<<16&16711680)+(Z[V+1]<<8&65280)+(Z[V+2]&255),W.push(q3(Q));return W.join("")}function M3(Z){var $,Y=Z.length,Q=Y%3,W=[],V=16383;for(var J=0,K=Y-Q;J<K;J+=V)W.push(F3(Z,J,J+V>K?K:J+V));if(Q===1)$=Z[Y-1],W.push(v0[$>>2]+v0[$<<4&63]+"==");else if(Q===2)$=(Z[Y-2]<<8)+Z[Y-1],W.push(v0[$>>10]+v0[$>>4&63]+v0[$<<2&63]+"=");return W.join("")}G3.byteLength=w3;G3.toByteArray=U3;G3.fromByteArray=M3;var v0=[],T0=[],z3=typeof Uint8Array!=="undefined"?Uint8Array:Array,V6="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(U1=0,vY=V6.length;U1<vY;++U1)v0[U1]=V6[U1],T0[V6.charCodeAt(U1)]=U1;var U1,vY;T0["-".charCodeAt(0)]=62;T0["_".charCodeAt(0)]=63});var uY=O((gY)=>{Object.defineProperty(gY,"__esModule",{value:!0});gY.BrowserCrypto=void 0;var A1=bY(),R3=j1();class c8{constructor(){if(typeof window==="undefined"||window.crypto===void 0||window.crypto.subtle===void 0)throw new Error("SubtleCrypto not found. Make sure it's an https:// website.")}async sha256DigestBase64(Z){const $=new TextEncoder().encode(Z),Y=await window.crypto.subtle.digest("SHA-256",$);return A1.fromByteArray(new Uint8Array(Y))}randomBytesBase64(Z){const $=new Uint8Array(Z);return window.crypto.getRandomValues($),A1.fromByteArray($)}static padBase64(Z){while(Z.length%4!==0)Z+="=";return Z}async verify(Z,$,Y){const Q={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},W=new TextEncoder().encode($),V=A1.toByteArray(c8.padBase64(Y)),J=await window.crypto.subtle.importKey("jwk",Z,Q,!0,["verify"]);return await window.crypto.subtle.verify(Q,J,V,W)}async sign(Z,$){const Y={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},Q=new TextEncoder().encode($),W=await window.crypto.subtle.importKey("jwk",Z,Y,!0,["sign"]),V=await window.crypto.subtle.sign(Y,W,Q);return A1.fromByteArray(new Uint8Array(V))}decodeBase64StringUtf8(Z){const $=A1.toByteArray(c8.padBase64(Z));return new TextDecoder().decode($)}encodeBase64StringUtf8(Z){const $=new TextEncoder().encode(Z);return A1.fromByteArray($)}async sha256DigestHex(Z){const $=new TextEncoder().encode(Z),Y=await window.crypto.subtle.digest("SHA-256",$);return R3.fromArrayBufferToHex(Y)}async signWithHmacSha256(Z,$){const Y=typeof Z==="string"?Z:String.fromCharCode(...new Uint16Array(Z)),Q=new TextEncoder,W=await window.crypto.subtle.importKey("raw",Q.encode(Y),{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);return window.crypto.subtle.sign("HMAC",W,Q.encode($))}}gY.BrowserCrypto=c8});var pY=O((lY)=>{function L3(Z){return Z.buffer.slice(Z.byteOffset,Z.byteOffset+Z.byteLength)}function C3(Z){return Buffer.from(Z)}Object.defineProperty(lY,"__esModule",{value:!0});lY.NodeCrypto=void 0;var E1=import.meta.require("crypto");class dY{async sha256DigestBase64(Z){return E1.createHash("sha256").update(Z).digest("base64")}randomBytesBase64(Z){return E1.randomBytes(Z).toString("base64")}async verify(Z,$,Y){const Q=E1.createVerify("RSA-SHA256");return Q.update($),Q.end(),Q.verify(Z,Y,"base64")}async sign(Z,$){const Y=E1.createSign("RSA-SHA256");return Y.update($),Y.end(),Y.sign(Z,"base64")}decodeBase64StringUtf8(Z){return Buffer.from(Z,"base64").toString("utf-8")}encodeBase64StringUtf8(Z){return Buffer.from(Z,"utf-8").toString("base64")}async sha256DigestHex(Z){return E1.createHash("sha256").update(Z).digest("hex")}async signWithHmacSha256(Z,$){const Y=typeof Z==="string"?Z:C3(Z);return L3(E1.createHmac("sha256",Y).update($).digest())}}lY.NodeCrypto=dY});var j1=O((nY)=>{function S3(){if(iY())return new T3.BrowserCrypto;return new O3.NodeCrypto}function iY(){return typeof window!=="undefined"&&typeof window.crypto!=="undefined"&&typeof window.crypto.subtle!=="undefined"}function P3(Z){return Array.from(new Uint8Array(Z)).map((Y)=>{return Y.toString(16).padStart(2,"0")}).join("")}Object.defineProperty(nY,"__esModule",{value:!0});nY.createCrypto=S3;nY.hasBrowserCrypto=iY;nY.fromArrayBufferToHex=P3;var T3=uY(),O3=pY()});var oY=O((aY)=>{function E3(Z){const $=[{invalid:"uri",expected:"url"},{invalid:"json",expected:"data"},{invalid:"qs",expected:"params"}];for(let Y of $)if(Z[Y.invalid]){const Q=`'${Y.invalid}' is not a valid configuration option. Please use '${Y.expected}' instead. This library is using Axios for requests. Please see https://github.com/axios/axios to learn more about the valid request options.`;throw new Error(Q)}}Object.defineProperty(aY,"__esModule",{value:!0});aY.validate=E3});var J6=O((Zq,x3)=>{x3.exports={name:"google-auth-library",version:"9.13.0",author:"Google Inc.",description:"Google APIs Authentication Client Library for Node.js",engines:{node:">=14"},main:"./build/src/index.js",types:"./build/src/index.d.ts",repository:"googleapis/google-auth-library-nodejs.git",keywords:["google","api","google apis","client","client library"],dependencies:{"base64-js":"^1.3.0","ecdsa-sig-formatter":"^1.0.11",gaxios:"^6.1.1","gcp-metadata":"^6.1.0",gtoken:"^7.0.0",jws:"^4.0.0"},devDependencies:{"@compodoc/compodoc":"1.1.23","@types/base64-js":"^1.2.5","@types/chai":"^4.1.7","@types/jws":"^3.1.0","@types/mocha":"^9.0.0","@types/mv":"^2.1.0","@types/ncp":"^2.0.1","@types/node":"^20.4.2","@types/sinon":"^17.0.0","assert-rejects":"^1.0.0",c8:"^8.0.0",chai:"^4.2.0",codecov:"^3.0.2",execa:"^5.0.0",gts:"^5.0.0","is-docker":"^2.0.0",karma:"^6.0.0","karma-chrome-launcher":"^3.0.0","karma-coverage":"^2.0.0","karma-firefox-launcher":"^2.0.0","karma-mocha":"^2.0.0","karma-sourcemap-loader":"^0.4.0","karma-webpack":"5.0.0",keypair:"^1.0.4",linkinator:"^4.0.0",mocha:"^9.2.2",mv:"^2.1.1",ncp:"^2.0.0",nock:"^13.0.0","null-loader":"^4.0.0",puppeteer:"^21.0.0",sinon:"^18.0.0","ts-loader":"^8.0.0",typescript:"^5.1.6",webpack:"^5.21.2","webpack-cli":"^4.0.0"},files:["build/src","!build/src/**/*.map"],scripts:{test:"c8 mocha build/test",clean:"gts clean",prepare:"npm run compile",lint:"gts check",compile:"tsc -p .",fix:"gts fix",pretest:"npm run compile -- --sourceMap",docs:"compodoc src/","samples-setup":"cd samples/ && npm link ../ && npm run setup && cd ../","samples-test":"cd samples/ && npm link ../ && npm test && cd ../","system-test":"mocha build/system-test --timeout 60000","presystem-test":"npm run compile -- --sourceMap",webpack:"webpack","browser-test":"karma start","docs-test":"linkinator docs","predocs-test":"npm run docs",prelint:"cd samples; npm link ../; npm install",precompile:"gts clean"},license:"Apache-2.0"}});var Q8=O((tY)=>{Object.defineProperty(tY,"__esModule",{value:!0});tY.DefaultTransporter=void 0;var h3=P0(),f3=oY(),k3=J6(),rY="google-api-nodejs-client";class Y8{constructor(){this.instance=new h3.Gaxios}configure(Z={}){if(Z.headers=Z.headers||{},typeof window==="undefined"){const $=Z.headers["User-Agent"];if(!$)Z.headers["User-Agent"]=Y8.USER_AGENT;else if(!$.includes(`${rY}/`))Z.headers["User-Agent"]=`${$} ${Y8.USER_AGENT}`;if(!Z.headers["x-goog-api-client"]){const Y=process.version.replace(/^v/,"");Z.headers["x-goog-api-client"]=`gl-node/${Y}`}}return Z}request(Z){return Z=this.configure(Z),f3.validate(Z),this.instance.request(Z).catch(($)=>{throw this.processError($)})}get defaults(){return this.instance.defaults}set defaults(Z){this.instance.defaults=Z}processError(Z){const $=Z.response,Y=Z,Q=$?$.data:null;if($&&Q&&Q.error&&$.status!==200)if(typeof Q.error==="string")Y.message=Q.error,Y.status=$.status;else if(Array.isArray(Q.error.errors))Y.message=Q.error.errors.map((W)=>W.message).join("\n"),Y.code=Q.error.code,Y.errors=Q.error.errors;else Y.message=Q.error.message,Y.code=Q.error.code;else if($&&$.status>=400)Y.message=Q,Y.status=$.status;return Y}}tY.DefaultTransporter=Y8;Y8.USER_AGENT=`${rY}/${k3.version}`});var $Q=O((X6,ZQ)=>{function eY(Z,$){for(var Y in Z)$[Y]=Z[Y]}function q1(Z,$,Y){return y0(Z,$,Y)}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var p8=import.meta.require("buffer"),y0=p8.Buffer;if(y0.from&&y0.alloc&&y0.allocUnsafe&&y0.allocUnsafeSlow)ZQ.exports=p8;else eY(p8,X6),X6.Buffer=q1;q1.prototype=Object.create(y0.prototype);eY(y0,q1);q1.from=function(Z,$,Y){if(typeof Z==="number")throw new TypeError("Argument must not be a number");return y0(Z,$,Y)};q1.alloc=function(Z,$,Y){if(typeof Z!=="number")throw new TypeError("Argument must be a number");var Q=y0(Z);if($!==void 0)if(typeof Y==="string")Q.fill($,Y);else Q.fill($);else Q.fill(0);return Q};q1.allocUnsafe=function(Z){if(typeof Z!=="number")throw new TypeError("Argument must be a number");return y0(Z)};q1.allocUnsafeSlow=function(Z){if(typeof Z!=="number")throw new TypeError("Argument must be a number");return p8.SlowBuffer(Z)}});var QQ=O((Yq,YQ)=>{function K6(Z){var $=(Z/8|0)+(Z%8===0?0:1);return $}function y3(Z){var $=v3[Z];if($)return $;throw new Error('Unknown algorithm "'+Z+'"')}var v3={ES256:K6(256),ES384:K6(384),ES512:K6(521)};YQ.exports=y3});var z6=O((Qq,zQ)=>{function u3(Z){return Z.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function KQ(Z){if(i8.isBuffer(Z))return Z;else if(typeof Z==="string")return i8.from(Z,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function d3(Z,$){Z=KQ(Z);var Y=VQ($),Q=Y+1,W=Z.length,V=0;if(Z[V++]!==XQ)throw new Error('Could not find expected "seq"');var J=Z[V++];if(J===(n8|1))J=Z[V++];if(W-V<J)throw new Error('"seq" specified length of "'+J+'", only "'+(W-V)+'" remaining');if(Z[V++]!==a8)throw new Error('Could not find expected "int" for "r"');var K=Z[V++];if(W-V-2<K)throw new Error('"r" specified length of "'+K+'", only "'+(W-V-2)+'" available');if(Q<K)throw new Error('"r" specified length of "'+K+'", max of "'+Q+'" is acceptable');var w=V;if(V+=K,Z[V++]!==a8)throw new Error('Could not find expected "int" for "s"');var L=Z[V++];if(W-V!==L)throw new Error('"s" specified length of "'+L+'", expected "'+(W-V)+'"');if(Q<L)throw new Error('"s" specified length of "'+L+'", max of "'+Q+'" is acceptable');var F=V;if(V+=L,V!==W)throw new Error('Expected to consume entire buffer, but "'+(W-V)+'" bytes remain');var C=Y-K,S=Y-L,v=i8.allocUnsafe(C+K+S+L);for(V=0;V<C;++V)v[V]=0;Z.copy(v,V,w+Math.max(-C,0),w+K),V=Y;for(var y=V;V<y+S;++V)v[V]=0;return Z.copy(v,V,F+Math.max(-S,0),F+L),v=v.toString("base64"),v=u3(v),v}function WQ(Z,$,Y){var Q=0;while($+Q<Y&&Z[$+Q]===0)++Q;var W=Z[$+Q]>=n8;if(W)--Q;return Q}function l3(Z,$){Z=KQ(Z);var Y=VQ($),Q=Z.length;if(Q!==Y*2)throw new TypeError('"'+$+'" signatures must be "'+Y*2+'" bytes, saw "'+Q+'"');var W=WQ(Z,0,Y),V=WQ(Z,Y,Z.length),J=Y-W,K=Y-V,w=2+J+1+1+K,L=w<n8,F=i8.allocUnsafe((L?2:3)+w),C=0;if(F[C++]=XQ,L)F[C++]=w;else F[C++]=n8|1,F[C++]=w&255;if(F[C++]=a8,F[C++]=J,W<0)F[C++]=0,C+=Z.copy(F,C,0,Y);else C+=Z.copy(F,C,W,Y);if(F[C++]=a8,F[C++]=K,V<0)F[C++]=0,Z.copy(F,C,Y);else Z.copy(F,C,Y+V);return F}var i8=$Q().Buffer,VQ=QQ(),n8=128,JQ=0,b3=32,g3=16,m3=2,XQ=g3|b3|JQ<<6,a8=m3|JQ<<6;zQ.exports={derToJose:d3,joseToDer:l3}});var F1=O((e0)=>{function wQ(Z){return Z.replace(/([_][^_])/g,($)=>$.slice(1).toUpperCase())}function c3(Z){function $(Y){var Q;const W=Z||{};return(Q=W[Y])!==null&&Q!==void 0?Q:W[wQ(Y)]}return{get:$}}var B0=e0&&e0.__classPrivateFieldGet||function(Z,$,Y,Q){if(Y==="a"&&!Q)throw new TypeError("Private accessor was defined without a getter");if(typeof $==="function"?Z!==$||!Q:!$.has(Z))throw new TypeError("Cannot read private member from an object whose class did not declare it");return Y==="m"?Q:Y==="a"?Q.call(Z):Q?Q.value:$.get(Z)},_1,i0,w6,H6;Object.defineProperty(e0,"__esModule",{value:!0});e0.LRUCache=void 0;e0.snakeToCamel=wQ;e0.originalOrCamelOptions=c3;class HQ{constructor(Z){_1.add(this),i0.set(this,new Map),this.capacity=Z.capacity,this.maxAge=Z.maxAge}set(Z,$){B0(this,_1,"m",w6).call(this,Z,$),B0(this,_1,"m",H6).call(this)}get(Z){const $=B0(this,i0,"f").get(Z);if(!$)return;return B0(this,_1,"m",w6).call(this,Z,$.value),B0(this,_1,"m",H6).call(this),$.value}}e0.LRUCache=HQ;i0=new WeakMap,_1=new WeakSet,w6=function Z($,Y){B0(this,i0,"f").delete($),B0(this,i0,"f").set($,{value:Y,lastAccessed:Date.now()})},H6=function Z(){const $=this.maxAge?Date.now()-this.maxAge:0;let Y=B0(this,i0,"f").entries().next();while(!Y.done&&(B0(this,i0,"f").size>this.capacity||Y.value[1].lastAccessed<$))B0(this,i0,"f").delete(Y.value[0]),Y=B0(this,i0,"f").entries().next()}});var b0=O((MQ)=>{Object.defineProperty(MQ,"__esModule",{value:!0});MQ.AuthClient=MQ.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS=MQ.DEFAULT_UNIVERSE=void 0;var p3=import.meta.require("events"),UQ=P0(),qQ=Q8(),i3=F1();MQ.DEFAULT_UNIVERSE="googleapis.com";MQ.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS=300000;class FQ extends p3.EventEmitter{constructor(Z={}){var $,Y,Q,W,V;super();this.credentials={},this.eagerRefreshThresholdMillis=MQ.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS,this.forceRefreshOnFailure=!1,this.universeDomain=MQ.DEFAULT_UNIVERSE;const J=i3.originalOrCamelOptions(Z);if(this.projectId=($=J.get("project_id"))!==null&&$!==void 0?$:null,this.quotaProjectId=J.get("quota_project_id"),this.credentials=(Y=J.get("credentials"))!==null&&Y!==void 0?Y:{},this.universeDomain=(Q=J.get("universe_domain"))!==null&&Q!==void 0?Q:MQ.DEFAULT_UNIVERSE,this.transporter=(W=Z.transporter)!==null&&W!==void 0?W:new qQ.DefaultTransporter,Z.transporterOptions)this.transporter.defaults=Z.transporterOptions;if(Z.eagerRefreshThresholdMillis)this.eagerRefreshThresholdMillis=Z.eagerRefreshThresholdMillis;this.forceRefreshOnFailure=(V=Z.forceRefreshOnFailure)!==null&&V!==void 0?V:!1}get gaxios(){if(this.transporter instanceof UQ.Gaxios)return this.transporter;else if(this.transporter instanceof qQ.DefaultTransporter)return this.transporter.instance;else if("instance"in this.transporter&&this.transporter.instance instanceof UQ.Gaxios)return this.transporter.instance;return null}setCredentials(Z){this.credentials=Z}addSharedMetadataHeaders(Z){if(!Z["x-goog-user-project"]&&this.quotaProjectId)Z["x-goog-user-project"]=this.quotaProjectId;return Z}static get RETRY_CONFIG(){return{retry:!0,retryConfig:{httpMethodsToRetry:["GET","PUT","POST","HEAD","OPTIONS","DELETE"]}}}}MQ.AuthClient=FQ});var q6=O((IQ)=>{Object.defineProperty(IQ,"__esModule",{value:!0});IQ.LoginTicket=void 0;class NQ{constructor(Z,$){this.envelope=Z,this.payload=$}getEnvelope(){return this.envelope}getPayload(){return this.payload}getUserId(){const Z=this.getPayload();if(Z&&Z.sub)return Z.sub;return null}getAttributes(){return{envelope:this.getEnvelope(),payload:this.getPayload()}}}IQ.LoginTicket=NQ});var M1=O((CQ)=>{Object.defineProperty(CQ,"__esModule",{value:!0});CQ.OAuth2Client=CQ.ClientAuthentication=CQ.CertificateFormat=CQ.CodeChallengeMethod=void 0;var n3=P0(),F6=import.meta.require("querystring"),a3=import.meta.require("stream"),o3=z6(),M6=j1(),r3=b0(),t3=q6(),LQ;(function(Z){Z.Plain="plain",Z.S256="S256"})(LQ||(CQ.CodeChallengeMethod=LQ={}));var n0;(function(Z){Z.PEM="PEM",Z.JWK="JWK"})(n0||(CQ.CertificateFormat=n0={}));var W8;(function(Z){Z.ClientSecretPost="ClientSecretPost",Z.ClientSecretBasic="ClientSecretBasic",Z.None="None"})(W8||(CQ.ClientAuthentication=W8={}));class w0 extends r3.AuthClient{constructor(Z,$,Y){const Q=Z&&typeof Z==="object"?Z:{clientId:Z,clientSecret:$,redirectUri:Y};super(Q);this.certificateCache={},this.certificateExpiry=null,this.certificateCacheFormat=n0.PEM,this.refreshTokenPromises=new Map,this._clientId=Q.clientId,this._clientSecret=Q.clientSecret,this.redirectUri=Q.redirectUri,this.endpoints={tokenInfoUrl:"https://oauth2.googleapis.com/tokeninfo",oauth2AuthBaseUrl:"https://accounts.google.com/o/oauth2/v2/auth",oauth2TokenUrl:"https://oauth2.googleapis.com/token",oauth2RevokeUrl:"https://oauth2.googleapis.com/revoke",oauth2FederatedSignonPemCertsUrl:"https://www.googleapis.com/oauth2/v1/certs",oauth2FederatedSignonJwkCertsUrl:"https://www.googleapis.com/oauth2/v3/certs",oauth2IapPublicKeyUrl:"https://www.gstatic.com/iap/verify/public_key",...Q.endpoints},this.clientAuthentication=Q.clientAuthentication||W8.ClientSecretPost,this.issuers=Q.issuers||["accounts.google.com","https://accounts.google.com",this.universeDomain]}generateAuthUrl(Z={}){if(Z.code_challenge_method&&!Z.code_challenge)throw new Error("If a code_challenge_method is provided, code_challenge must be included.");if(Z.response_type=Z.response_type||"code",Z.client_id=Z.client_id||this._clientId,Z.redirect_uri=Z.redirect_uri||this.redirectUri,Array.isArray(Z.scope))Z.scope=Z.scope.join(" ");return this.endpoints.oauth2AuthBaseUrl.toString()+"?"+F6.stringify(Z)}generateCodeVerifier(){throw new Error("generateCodeVerifier is removed, please use generateCodeVerifierAsync instead.")}async generateCodeVerifierAsync(){const Z=M6.createCrypto(),Y=Z.randomBytesBase64(96).replace(/\+/g,"~").replace(/=/g,"_").replace(/\//g,"-"),W=(await Z.sha256DigestBase64(Y)).split("=")[0].replace(/\+/g,"-").replace(/\//g,"_");return{codeVerifier:Y,codeChallenge:W}}getToken(Z,$){const Y=typeof Z==="string"?{code:Z}:Z;if($)this.getTokenAsync(Y).then((Q)=>$(null,Q.tokens,Q.res),(Q)=>$(Q,null,Q.response));else return this.getTokenAsync(Y)}async getTokenAsync(Z){const $=this.endpoints.oauth2TokenUrl.toString(),Y={"Content-Type":"application/x-www-form-urlencoded"},Q={client_id:Z.client_id||this._clientId,code_verifier:Z.codeVerifier,code:Z.code,grant_type:"authorization_code",redirect_uri:Z.redirect_uri||this.redirectUri};if(this.clientAuthentication===W8.ClientSecretBasic){const J=Buffer.from(`${this._clientId}:${this._clientSecret}`);Y.Authorization=`Basic ${J.toString("base64")}`}if(this.clientAuthentication===W8.ClientSecretPost)Q.client_secret=this._clientSecret;const W=await this.transporter.request({...w0.RETRY_CONFIG,method:"POST",url:$,data:F6.stringify(Q),headers:Y}),V=W.data;if(W.data&&W.data.expires_in)V.expiry_date=new Date().getTime()+W.data.expires_in*1000,delete V.expires_in;return this.emit("tokens",V),{tokens:V,res:W}}async refreshToken(Z){if(!Z)return this.refreshTokenNoCache(Z);if(this.refreshTokenPromises.has(Z))return this.refreshTokenPromises.get(Z);const $=this.refreshTokenNoCache(Z).then((Y)=>{return this.refreshTokenPromises.delete(Z),Y},(Y)=>{throw this.refreshTokenPromises.delete(Z),Y});return this.refreshTokenPromises.set(Z,$),$}async refreshTokenNoCache(Z){var $;if(!Z)throw new Error("No refresh token is set.");const Y=this.endpoints.oauth2TokenUrl.toString(),Q={refresh_token:Z,client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token"};let W;try{W=await this.transporter.request({...w0.RETRY_CONFIG,method:"POST",url:Y,data:F6.stringify(Q),headers:{"Content-Type":"application/x-www-form-urlencoded"}})}catch(J){if(J instanceof n3.GaxiosError&&J.message==="invalid_grant"&&(($=J.response)===null||$===void 0?void 0:$.data)&&/ReAuth/i.test(J.response.data.error_description))J.message=JSON.stringify(J.response.data);throw J}const V=W.data;if(W.data&&W.data.expires_in)V.expiry_date=new Date().getTime()+W.data.expires_in*1000,delete V.expires_in;return this.emit("tokens",V),{tokens:V,res:W}}refreshAccessToken(Z){if(Z)this.refreshAccessTokenAsync().then(($)=>Z(null,$.credentials,$.res),Z);else return this.refreshAccessTokenAsync()}async refreshAccessTokenAsync(){const Z=await this.refreshToken(this.credentials.refresh_token),$=Z.tokens;return $.refresh_token=this.credentials.refresh_token,this.credentials=$,{credentials:this.credentials,res:Z.res}}getAccessToken(Z){if(Z)this.getAccessTokenAsync().then(($)=>Z(null,$.token,$.res),Z);else return this.getAccessTokenAsync()}async getAccessTokenAsync(){if(!this.credentials.access_token||this.isTokenExpiring()){if(!this.credentials.refresh_token)if(this.refreshHandler){const Y=await this.processAndValidateRefreshHandler();if(Y===null||Y===void 0?void 0:Y.access_token)return this.setCredentials(Y),{token:this.credentials.access_token}}else throw new Error("No refresh token or refresh handler callback is set.");const $=await this.refreshAccessTokenAsync();if(!$.credentials||$.credentials&&!$.credentials.access_token)throw new Error("Could not refresh access token.");return{token:$.credentials.access_token,res:$.res}}else return{token:this.credentials.access_token}}async getRequestHeaders(Z){return(await this.getRequestMetadataAsync(Z)).headers}async getRequestMetadataAsync(Z){const $=this.credentials;if(!$.access_token&&!$.refresh_token&&!this.apiKey&&!this.refreshHandler)throw new Error("No access, refresh token, API key or refresh handler callback is set.");if($.access_token&&!this.isTokenExpiring()){$.token_type=$.token_type||"Bearer";const J={Authorization:$.token_type+" "+$.access_token};return{headers:this.addSharedMetadataHeaders(J)}}if(this.refreshHandler){const J=await this.processAndValidateRefreshHandler();if(J===null||J===void 0?void 0:J.access_token){this.setCredentials(J);const K={Authorization:"Bearer "+this.credentials.access_token};return{headers:this.addSharedMetadataHeaders(K)}}}if(this.apiKey)return{headers:{"X-Goog-Api-Key":this.apiKey}};let Y=null,Q=null;try{Y=await this.refreshToken($.refresh_token),Q=Y.tokens}catch(J){const K=J;if(K.response&&(K.response.status===403||K.response.status===404))K.message=`Could not refresh access token: ${K.message}`;throw K}const W=this.credentials;W.token_type=W.token_type||"Bearer",Q.refresh_token=W.refresh_token,this.credentials=Q;const V={Authorization:W.token_type+" "+Q.access_token};return{headers:this.addSharedMetadataHeaders(V),res:Y.res}}static getRevokeTokenUrl(Z){return new w0().getRevokeTokenURL(Z).toString()}getRevokeTokenURL(Z){const $=new URL(this.endpoints.oauth2RevokeUrl);return $.searchParams.append("token",Z),$}revokeToken(Z,$){const Y={...w0.RETRY_CONFIG,url:this.getRevokeTokenURL(Z).toString(),method:"POST"};if($)this.transporter.request(Y).then((Q)=>$(null,Q),$);else return this.transporter.request(Y)}revokeCredentials(Z){if(Z)this.revokeCredentialsAsync().then(($)=>Z(null,$),Z);else return this.revokeCredentialsAsync()}async revokeCredentialsAsync(){const Z=this.credentials.access_token;if(this.credentials={},Z)return this.revokeToken(Z);else throw new Error("No access token to revoke.")}request(Z,$){if($)this.requestAsync(Z).then((Y)=>$(null,Y),(Y)=>{return $(Y,Y.response)});else return this.requestAsync(Z)}async requestAsync(Z,$=!1){let Y;try{const Q=await this.getRequestMetadataAsync(Z.url);if(Z.headers=Z.headers||{},Q.headers&&Q.headers["x-goog-user-project"])Z.headers["x-goog-user-project"]=Q.headers["x-goog-user-project"];if(Q.headers&&Q.headers.Authorization)Z.headers.Authorization=Q.headers.Authorization;if(this.apiKey)Z.headers["X-Goog-Api-Key"]=this.apiKey;Y=await this.transporter.request(Z)}catch(Q){const W=Q.response;if(W){const V=W.status,J=this.credentials&&this.credentials.access_token&&this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure),K=this.credentials&&this.credentials.access_token&&!this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure)&&this.refreshHandler,w=W.config.data instanceof a3.Readable,L=V===401||V===403;if(!$&&L&&!w&&J)return await this.refreshAccessTokenAsync(),this.requestAsync(Z,!0);else if(!$&&L&&!w&&K){const F=await this.processAndValidateRefreshHandler();if(F===null||F===void 0?void 0:F.access_token)this.setCredentials(F);return this.requestAsync(Z,!0)}}throw Q}return Y}verifyIdToken(Z,$){if($&&typeof $!=="function")throw new Error("This method accepts an options object as the first parameter, which includes the idToken, audience, and maxExpiry.");if($)this.verifyIdTokenAsync(Z).then((Y)=>$(null,Y),$);else return this.verifyIdTokenAsync(Z)}async verifyIdTokenAsync(Z){if(!Z.idToken)throw new Error("The verifyIdToken method requires an ID Token");const $=await this.getFederatedSignonCertsAsync();return await this.verifySignedJwtWithCertsAsync(Z.idToken,$.certs,Z.audience,this.issuers,Z.maxExpiry)}async getTokenInfo(Z){const{data:$}=await this.transporter.request({...w0.RETRY_CONFIG,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Bearer ${Z}`},url:this.endpoints.tokenInfoUrl.toString()}),Y=Object.assign({expiry_date:new Date().getTime()+$.expires_in*1000,scopes:$.scope.split(" ")},$);return delete Y.expires_in,delete Y.scope,Y}getFederatedSignonCerts(Z){if(Z)this.getFederatedSignonCertsAsync().then(($)=>Z(null,$.certs,$.res),Z);else return this.getFederatedSignonCertsAsync()}async getFederatedSignonCertsAsync(){const Z=new Date().getTime(),$=M6.hasBrowserCrypto()?n0.JWK:n0.PEM;if(this.certificateExpiry&&Z<this.certificateExpiry.getTime()&&this.certificateCacheFormat===$)return{certs:this.certificateCache,format:$};let Y,Q;switch($){case n0.PEM:Q=this.endpoints.oauth2FederatedSignonPemCertsUrl.toString();break;case n0.JWK:Q=this.endpoints.oauth2FederatedSignonJwkCertsUrl.toString();break;default:throw new Error(`Unsupported certificate format ${$}`)}try{Y=await this.transporter.request({...w0.RETRY_CONFIG,url:Q})}catch(w){if(w instanceof Error)w.message=`Failed to retrieve verification certificates: ${w.message}`;throw w}const W=Y?Y.headers["cache-control"]:void 0;let V=-1;if(W){const L=new RegExp("max-age=([0-9]*)").exec(W);if(L&&L.length===2)V=Number(L[1])*1000}let J={};switch($){case n0.PEM:J=Y.data;break;case n0.JWK:for(let w of Y.data.keys)J[w.kid]=w;break;default:throw new Error(`Unsupported certificate format ${$}`)}const K=new Date;return this.certificateExpiry=V===-1?null:new Date(K.getTime()+V),this.certificateCache=J,this.certificateCacheFormat=$,{certs:J,format:$,res:Y}}getIapPublicKeys(Z){if(Z)this.getIapPublicKeysAsync().then(($)=>Z(null,$.pubkeys,$.res),Z);else return this.getIapPublicKeysAsync()}async getIapPublicKeysAsync(){let Z;const $=this.endpoints.oauth2IapPublicKeyUrl.toString();try{Z=await this.transporter.request({...w0.RETRY_CONFIG,url:$})}catch(Y){if(Y instanceof Error)Y.message=`Failed to retrieve verification certificates: ${Y.message}`;throw Y}return{pubkeys:Z.data,res:Z}}verifySignedJwtWithCerts(){throw new Error("verifySignedJwtWithCerts is removed, please use verifySignedJwtWithCertsAsync instead.")}async verifySignedJwtWithCertsAsync(Z,$,Y,Q,W){const V=M6.createCrypto();if(!W)W=w0.DEFAULT_MAX_TOKEN_LIFETIME_SECS_;const J=Z.split(".");if(J.length!==3)throw new Error("Wrong number of segments in token: "+Z);const K=J[0]+"."+J[1];let w=J[2],L,F;try{L=JSON.parse(V.decodeBase64StringUtf8(J[0]))}catch(b){if(b instanceof Error)b.message=`Can't parse token envelope: ${J[0]}': ${b.message}`;throw b}if(!L)throw new Error("Can't parse token envelope: "+J[0]);try{F=JSON.parse(V.decodeBase64StringUtf8(J[1]))}catch(b){if(b instanceof Error)b.message=`Can't parse token payload '${J[0]}`;throw b}if(!F)throw new Error("Can't parse token payload: "+J[1]);if(!Object.prototype.hasOwnProperty.call($,L.kid))throw new Error("No pem found for envelope: "+JSON.stringify(L));const C=$[L.kid];if(L.alg==="ES256")w=o3.joseToDer(w,"ES256").toString("base64");if(!await V.verify(C,K,w))throw new Error("Invalid token signature: "+Z);if(!F.iat)throw new Error("No issue time in token: "+JSON.stringify(F));if(!F.exp)throw new Error("No expiration time in token: "+JSON.stringify(F));const v=Number(F.iat);if(isNaN(v))throw new Error("iat field using invalid format");const y=Number(F.exp);if(isNaN(y))throw new Error("exp field using invalid format");const j=new Date().getTime()/1000;if(y>=j+W)throw new Error("Expiration time too far in future: "+JSON.stringify(F));const E=v-w0.CLOCK_SKEW_SECS_,B=y+w0.CLOCK_SKEW_SECS_;if(j<E)throw new Error("Token used too early, "+j+" < "+E+": "+JSON.stringify(F));if(j>B)throw new Error("Token used too late, "+j+" > "+B+": "+JSON.stringify(F));if(Q&&Q.indexOf(F.iss)<0)throw new Error("Invalid issuer, expected one of ["+Q+"], but got "+F.iss);if(typeof Y!=="undefined"&&Y!==null){const b=F.aud;let u=!1;if(Y.constructor===Array)u=Y.indexOf(b)>-1;else u=b===Y;if(!u)throw new Error("Wrong recipient, payload audience != requiredAudience")}return new t3.LoginTicket(L,F)}async processAndValidateRefreshHandler(){if(this.refreshHandler){const Z=await this.refreshHandler();if(!Z.access_token)throw new Error("No access token is returned by the refreshHandler callback.");return Z}return}isTokenExpiring(){const Z=this.credentials.expiry_date;return Z?Z<=new Date().getTime()+this.eagerRefreshThresholdMillis:!1}}CQ.OAuth2Client=w0;w0.GOOGLE_TOKEN_INFO_URL="https://oauth2.googleapis.com/tokeninfo";w0.CLOCK_SKEW_SECS_=300;w0.DEFAULT_MAX_TOKEN_LIFETIME_SECS_=86400});var G6=O((PQ)=>{Object.defineProperty(PQ,"__esModule",{value:!0});PQ.Compute=void 0;var $z=P0(),OQ=$8(),Yz=M1();class SQ extends Yz.OAuth2Client{constructor(Z={}){super(Z);this.credentials={expiry_date:1,refresh_token:"compute-placeholder"},this.serviceAccountEmail=Z.serviceAccountEmail||"default",this.scopes=Array.isArray(Z.scopes)?Z.scopes:Z.scopes?[Z.scopes]:[]}async refreshTokenNoCache(Z){const $=`service-accounts/${this.serviceAccountEmail}/token`;let Y;try{const W={property:$};if(this.scopes.length>0)W.params={scopes:this.scopes.join(",")};Y=await OQ.instance(W)}catch(W){if(W instanceof $z.GaxiosError)W.message=`Could not refresh access token: ${W.message}`,this.wrapError(W);throw W}const Q=Y;if(Y&&Y.expires_in)Q.expiry_date=new Date().getTime()+Y.expires_in*1000,delete Q.expires_in;return this.emit("tokens",Q),{tokens:Q,res:null}}async fetchIdToken(Z){const $=`service-accounts/${this.serviceAccountEmail}/identity?format=full&audience=${Z}`;let Y;try{const Q={property:$};Y=await OQ.instance(Q)}catch(Q){if(Q instanceof Error)Q.message=`Could not fetch ID token: ${Q.message}`;throw Q}return Y}wrapError(Z){const $=Z.response;if($&&$.status){if(Z.status=$.status,$.status===403)Z.message="A Forbidden error was returned while attempting to retrieve an access token for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have the correct permission scopes specified: "+Z.message;else if($.status===404)Z.message="A Not Found error was returned while attempting to retrieve an accesstoken for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have any permission scopes specified: "+Z.message}}}PQ.Compute=SQ});var D6=O((jQ)=>{Object.defineProperty(jQ,"__esModule",{value:!0});jQ.IdTokenClient=void 0;var Qz=M1();class AQ extends Qz.OAuth2Client{constructor(Z){super(Z);this.targetAudience=Z.targetAudience,this.idTokenProvider=Z.idTokenProvider}async getRequestMetadataAsync(Z){if(!this.credentials.id_token||!this.credentials.expiry_date||this.isTokenExpiring()){const Y=await this.idTokenProvider.fetchIdToken(this.targetAudience);this.credentials={id_token:Y,expiry_date:this.getIdTokenExpiryDate(Y)}}return{headers:{Authorization:"Bearer "+this.credentials.id_token}}}getIdTokenExpiryDate(Z){const $=Z.split(".")[1];if($)return JSON.parse(Buffer.from($,"base64").toString("ascii")).exp*1000}}jQ.IdTokenClient=AQ});var N6=O((xQ)=>{function Wz(){V8=void 0}async function Vz(){if(V8)return V8;return V8=Jz(),V8}async function Jz(){let Z=a0.NONE;if(Xz())Z=a0.APP_ENGINE;else if(Kz())Z=a0.CLOUD_FUNCTIONS;else if(await Hz())if(await wz())Z=a0.KUBERNETES_ENGINE;else if(zz())Z=a0.CLOUD_RUN;else Z=a0.COMPUTE_ENGINE;else Z=a0.NONE;return Z}function Xz(){return!!(process.env.GAE_SERVICE||process.env.GAE_MODULE_NAME)}function Kz(){return!!(process.env.FUNCTION_NAME||process.env.FUNCTION_TARGET)}function zz(){return!!process.env.K_CONFIGURATION}async function wz(){try{return await _Q.instance("attributes/cluster-name"),!0}catch(Z){return!1}}async function Hz(){return _Q.isAvailable()}Object.defineProperty(xQ,"__esModule",{value:!0});xQ.GCPEnv=void 0;xQ.clear=Wz;xQ.getEnv=Vz;var _Q=$8(),a0;(function(Z){Z.APP_ENGINE="APP_ENGINE",Z.KUBERNETES_ENGINE="KUBERNETES_ENGINE",Z.CLOUD_FUNCTIONS="CLOUD_FUNCTIONS",Z.COMPUTE_ENGINE="COMPUTE_ENGINE",Z.CLOUD_RUN="CLOUD_RUN",Z.NONE="NONE"})(a0||(xQ.GCPEnv=a0={}));var V8});var r8=O((I6,kQ)=>{function fQ(Z,$){for(var Y in Z)$[Y]=Z[Y]}function G1(Z,$,Y){return g0(Z,$,Y)}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var o8=import.meta.require("buffer"),g0=o8.Buffer;if(g0.from&&g0.alloc&&g0.allocUnsafe&&g0.allocUnsafeSlow)kQ.exports=o8;else fQ(o8,I6),I6.Buffer=G1;G1.prototype=Object.create(g0.prototype);fQ(g0,G1);G1.from=function(Z,$,Y){if(typeof Z==="number")throw new TypeError("Argument must not be a number");return g0(Z,$,Y)};G1.alloc=function(Z,$,Y){if(typeof Z!=="number")throw new TypeError("Argument must be a number");var Q=g0(Z);if($!==void 0)if(typeof Y==="string")Q.fill($,Y);else Q.fill($);else Q.fill(0);return Q};G1.allocUnsafe=function(Z){if(typeof Z!=="number")throw new TypeError("Argument must be a number");return g0(Z)};G1.allocUnsafeSlow=function(Z){if(typeof Z!=="number")throw new TypeError("Argument must be a number");return o8.SlowBuffer(Z)}});var R6=O((Hq,vQ)=>{function s8(Z){if(this.buffer=null,this.writable=!0,this.readable=!0,!Z)return this.buffer=t8.alloc(0),this;if(typeof Z.pipe==="function")return this.buffer=t8.alloc(0),Z.pipe(this),this;if(Z.length||typeof Z==="object")return this.buffer=Z,this.writable=!1,process.nextTick(function(){this.emit("end",Z),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof Z+")")}var t8=r8().Buffer,Fz=import.meta.require("stream"),Mz=import.meta.require("util");Mz.inherits(s8,Fz);s8.prototype.write=function Z($){this.buffer=t8.concat([this.buffer,t8.from($)]),this.emit("data",$)};s8.prototype.end=function Z($){if($)this.write($);this.emit("end",$),this.emit("close"),this.writable=!1,this.readable=!1};vQ.exports=s8});var bQ=O((Uq,yQ)=>{function e8(Z,$){if(!J8.isBuffer(Z)||!J8.isBuffer($))return!1;if(Z.length!==$.length)return!1;var Y=0;for(var Q=0;Q<Z.length;Q++)Y|=Z[Q]^$[Q];return Y===0}var J8=import.meta.require("buffer").Buffer,L6=import.meta.require("buffer").SlowBuffer;yQ.exports=e8;e8.install=function(){J8.prototype.equal=L6.prototype.equal=function Z($){return e8(this,$)}};var Gz=J8.prototype.equal,Dz=L6.prototype.equal;e8.restore=function(){J8.prototype.equal=Gz,L6.prototype.equal=Dz}});var uQ=O((C6,mQ)=>{function gQ(Z,$){for(var Y in Z)$[Y]=Z[Y]}function D1(Z,$,Y){return m0(Z,$,Y)}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var Z4=import.meta.require("buffer"),m0=Z4.Buffer;if(m0.from&&m0.alloc&&m0.allocUnsafe&&m0.allocUnsafeSlow)mQ.exports=Z4;else gQ(Z4,C6),C6.Buffer=D1;D1.prototype=Object.create(m0.prototype);gQ(m0,D1);D1.from=function(Z,$,Y){if(typeof Z==="number")throw new TypeError("Argument must not be a number");return m0(Z,$,Y)};D1.alloc=function(Z,$,Y){if(typeof Z!=="number")throw new TypeError("Argument must be a number");var Q=m0(Z);if($!==void 0)if(typeof Y==="string")Q.fill($,Y);else Q.fill($);else Q.fill(0);return Q};D1.allocUnsafe=function(Z){if(typeof Z!=="number")throw new TypeError("Argument must be a number");return m0(Z)};D1.allocUnsafeSlow=function(Z){if(typeof Z!=="number")throw new TypeError("Argument must be a number");return Z4.SlowBuffer(Z)}});var S6=O((qq,rQ)=>{function cQ(Z){if(h1.isBuffer(Z))return;if(typeof Z==="string")return;if(!T6)throw A0(x1);if(typeof Z!=="object")throw A0(x1);if(typeof Z.type!=="string")throw A0(x1);if(typeof Z.asymmetricKeyType!=="string")throw A0(x1);if(typeof Z.export!=="function")throw A0(x1)}function pQ(Z){if(h1.isBuffer(Z))return;if(typeof Z==="string")return;if(typeof Z==="object")return;throw A0(Rz)}function Lz(Z){if(h1.isBuffer(Z))return;if(typeof Z==="string")return Z;if(!T6)throw A0(X8);if(typeof Z!=="object")throw A0(X8);if(Z.type!=="secret")throw A0(X8);if(typeof Z.export!=="function")throw A0(X8)}function O6(Z){return Z.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function iQ(Z){Z=Z.toString();var $=4-Z.length%4;if($!==4)for(var Y=0;Y<$;++Y)Z+="=";return Z.replace(/\-/g,"+").replace(/_/g,"/")}function A0(Z){var $=[].slice.call(arguments,1),Y=dQ.format.bind(dQ,Z).apply(null,$);return new TypeError(Y)}function Cz(Z){return h1.isBuffer(Z)||typeof Z==="string"}function K8(Z){if(!Cz(Z))Z=JSON.stringify(Z);return Z}function nQ(Z){return function $(Y,Q){Lz(Q),Y=K8(Y);var W=u0.createHmac("sha"+Z,Q),V=(W.update(Y),W.digest("base64"));return O6(V)}}function Tz(Z){return function $(Y,Q,W){var V=nQ(Z)(Y,W);return Nz(h1.from(Q),h1.from(V))}}function aQ(Z){return function $(Y,Q){pQ(Q),Y=K8(Y);var W=u0.createSign("RSA-SHA"+Z),V=(W.update(Y),W.sign(Q,"base64"));return O6(V)}}function oQ(Z){return function $(Y,Q,W){cQ(W),Y=K8(Y),Q=iQ(Q);var V=u0.createVerify("RSA-SHA"+Z);return V.update(Y),V.verify(W,Q,"base64")}}function Oz(Z){return function $(Y,Q){pQ(Q),Y=K8(Y);var W=u0.createSign("RSA-SHA"+Z),V=(W.update(Y),W.sign({key:Q,padding:u0.constants.RSA_PKCS1_PSS_PADDING,saltLength:u0.constants.RSA_PSS_SALTLEN_DIGEST},"base64"));return O6(V)}}function Sz(Z){return function $(Y,Q,W){cQ(W),Y=K8(Y),Q=iQ(Q);var V=u0.createVerify("RSA-SHA"+Z);return V.update(Y),V.verify({key:W,padding:u0.constants.RSA_PKCS1_PSS_PADDING,saltLength:u0.constants.RSA_PSS_SALTLEN_DIGEST},Q,"base64")}}function Pz(Z){var $=aQ(Z);return function Y(){var Q=$.apply(null,arguments);return Q=lQ.derToJose(Q,"ES"+Z),Q}}function Bz(Z){var $=oQ(Z);return function Y(Q,W,V){W=lQ.joseToDer(W,"ES"+Z).toString("base64");var J=$(Q,W,V);return J}}function Az(){return function Z(){return""}}function jz(){return function Z($,Y){return Y===""}}var Nz=bQ(),h1=uQ().Buffer,u0=import.meta.require("crypto"),lQ=z6(),dQ=import.meta.require("util"),Iz='"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',X8="secret must be a string or buffer",x1="key must be a string or a buffer",Rz="key must be a string, a buffer or an object",T6=typeof u0.createPublicKey==="function";if(T6)x1+=" or a KeyObject",X8+="or a KeyObject";rQ.exports=function Z($){var Y={hs:nQ,rs:aQ,ps:Oz,es:Pz,none:Az},Q={hs:Tz,rs:oQ,ps:Sz,es:Bz,none:jz},W=$.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/);if(!W)throw A0(Iz,$);var V=(W[1]||W[3]).toLowerCase(),J=W[2];return{sign:Y[V](J),verify:Q[V](J)}}});var P6=O((Fq,tQ)=>{var Ez=import.meta.require("buffer").Buffer;tQ.exports=function Z($){if(typeof $==="string")return $;if(typeof $==="number"||Ez.isBuffer($))return $.toString();return JSON.stringify($)}});var Q5=O((Mq,Y5)=>{function Z5(Z,$){return _z.from(Z,$).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function fz(Z,$,Y){Y=Y||"utf8";var Q=Z5(eQ(Z),"binary"),W=Z5(eQ($),Y);return B6.format("%s.%s",Q,W)}function $5(Z){var{header:$,payload:Y}=Z,Q=Z.secret||Z.privateKey,W=Z.encoding,V=xz($.alg),J=fz($,Y,W),K=V.sign(J,Q);return B6.format("%s.%s",J,K)}function $4(Z){var $=Z.secret||Z.privateKey||Z.key,Y=new sQ($);this.readable=!0,this.header=Z.header,this.encoding=Z.encoding,this.secret=this.privateKey=this.key=Y,this.payload=new sQ(Z.payload),this.secret.once("close",function(){if(!this.payload.writable&&this.readable)this.sign()}.bind(this)),this.payload.once("close",function(){if(!this.secret.writable&&this.readable)this.sign()}.bind(this))}var _z=r8().Buffer,sQ=R6(),xz=S6(),hz=import.meta.require("stream"),eQ=P6(),B6=import.meta.require("util");B6.inherits($4,hz);$4.prototype.sign=function Z(){try{var $=$5({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",$),this.emit("data",$),this.emit("end"),this.readable=!1,$}catch(Y){this.readable=!1,this.emit("error",Y),this.emit("close")}};$4.sign=$5;Y5.exports=$4});var q5=O((Gq,U5)=>{function gz(Z){return Object.prototype.toString.call(Z)==="[object Object]"}function mz(Z){if(gz(Z))return Z;try{return JSON.parse(Z)}catch($){return}}function X5(Z){var $=Z.split(".",1)[0];return mz(V5.from($,"base64").toString("binary"))}function uz(Z){return Z.split(".",2).join(".")}function K5(Z){return Z.split(".")[2]}function dz(Z,$){$=$||"utf8";var Y=Z.split(".")[1];return V5.from(Y,"base64").toString($)}function z5(Z){return bz.test(Z)&&!!X5(Z)}function w5(Z,$,Y){if(!$){var Q=new Error("Missing algorithm parameter for jws.verify");throw Q.code="MISSING_ALGORITHM",Q}Z=J5(Z);var W=K5(Z),V=uz(Z),J=kz($);return J.verify(V,W,Y)}function H5(Z,$){if($=$||{},Z=J5(Z),!z5(Z))return null;var Y=X5(Z);if(!Y)return null;var Q=dz(Z);if(Y.typ==="JWT"||$.json)Q=JSON.parse(Q,$.encoding);return{header:Y,payload:Q,signature:K5(Z)}}function f1(Z){Z=Z||{};var $=Z.secret||Z.publicKey||Z.key,Y=new W5($);this.readable=!0,this.algorithm=Z.algorithm,this.encoding=Z.encoding,this.secret=this.publicKey=this.key=Y,this.signature=new W5(Z.signature),this.secret.once("close",function(){if(!this.signature.writable&&this.readable)this.verify()}.bind(this)),this.signature.once("close",function(){if(!this.secret.writable&&this.readable)this.verify()}.bind(this))}var V5=r8().Buffer,W5=R6(),kz=S6(),vz=import.meta.require("stream"),J5=P6(),yz=import.meta.require("util"),bz=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;yz.inherits(f1,vz);f1.prototype.verify=function Z(){try{var $=w5(this.signature.buffer,this.algorithm,this.key.buffer),Y=H5(this.signature.buffer,this.encoding);return this.emit("done",$,Y),this.emit("data",$),this.emit("end"),this.readable=!1,$}catch(Q){this.readable=!1,this.emit("error",Q),this.emit("close")}};f1.decode=H5;f1.isValid=z5;f1.verify=w5;U5.exports=f1});var A6=O((cz)=>{var F5=Q5(),Y4=q5(),lz=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"];cz.ALGORITHMS=lz;cz.sign=F5.sign;cz.verify=Y4.verify;cz.decode=Y4.decode;cz.isValid=Y4.isValid;cz.createSign=function Z($){return new F5($)};cz.createVerify=function Z($){return new Y4($)}});var T5=O((Z1)=>{var j0=Z1&&Z1.__classPrivateFieldGet||function(Z,$,Y,Q){if(Y==="a"&&!Q)throw new TypeError("Private accessor was defined without a getter");if(typeof $==="function"?Z!==$||!Q:!$.has(Z))throw new TypeError("Cannot read private member from an object whose class did not declare it");return Y==="m"?Q:Y==="a"?Q.call(Z):Q?Q.value:$.get(Z)},M5=Z1&&Z1.__classPrivateFieldSet||function(Z,$,Y,Q,W){if(Q==="m")throw new TypeError("Private method is not writable");if(Q==="a"&&!W)throw new TypeError("Private accessor was defined without a setter");if(typeof $==="function"?Z!==$||!W:!$.has(Z))throw new TypeError("Cannot write private member to an object whose class did not declare it");return Q==="a"?W.call(Z,Y):W?W.value=Y:$.set(Z,Y),Y},E0,k1,j6,G5,D5,E6,_6,N5;Object.defineProperty(Z1,"__esModule",{value:!0});Z1.GoogleToken=void 0;var I5=import.meta.require("fs"),sz=P0(),ez=A6(),Z7=import.meta.require("path"),$7=import.meta.require("util"),R5=I5.readFile?$7.promisify(I5.readFile):async()=>{throw new v1("use key rather than keyFile.","MISSING_CREDENTIALS")},L5="https://www.googleapis.com/oauth2/v4/token",Y7="https://accounts.google.com/o/oauth2/revoke?token=";class v1 extends Error{constructor(Z,$){super(Z);this.code=$}}class C5{get accessToken(){return this.rawToken?this.rawToken.access_token:void 0}get idToken(){return this.rawToken?this.rawToken.id_token:void 0}get tokenType(){return this.rawToken?this.rawToken.token_type:void 0}get refreshToken(){return this.rawToken?this.rawToken.refresh_token:void 0}constructor(Z){E0.add(this),this.transporter={request:($)=>sz.request($)},k1.set(this,void 0),j0(this,E0,"m",_6).call(this,Z)}hasExpired(){const Z=new Date().getTime();if(this.rawToken&&this.expiresAt)return Z>=this.expiresAt;else return!0}isTokenExpiring(){var Z;const $=new Date().getTime(),Y=(Z=this.eagerRefreshThresholdMillis)!==null&&Z!==void 0?Z:0;if(this.rawToken&&this.expiresAt)return this.expiresAt<=$+Y;else return!0}getToken(Z,$={}){if(typeof Z==="object")$=Z,Z=void 0;if($=Object.assign({forceRefresh:!1},$),Z){const Y=Z;j0(this,E0,"m",j6).call(this,$).then((Q)=>Y(null,Q),Z);return}return j0(this,E0,"m",j6).call(this,$)}async getCredentials(Z){switch(Z7.extname(Z)){case".json":{const Y=await R5(Z,"utf8"),Q=JSON.parse(Y),W=Q.private_key,V=Q.client_email;if(!W||!V)throw new v1("private_key and client_email are required.","MISSING_CREDENTIALS");return{privateKey:W,clientEmail:V}}case".der":case".crt":case".pem":return{privateKey:await R5(Z,"utf8")};case".p12":case".pfx":throw new v1("*.p12 certificates are not supported after v6.1.2. Consider utilizing *.json format or converting *.p12 to *.pem using the OpenSSL CLI.","UNKNOWN_CERTIFICATE_TYPE");default:throw new v1("Unknown certificate type. Type is determined based on file extension. Current supported extensions are *.json, and *.pem.","UNKNOWN_CERTIFICATE_TYPE")}}revokeToken(Z){if(Z){j0(this,E0,"m",E6).call(this).then(()=>Z(),Z);return}return j0(this,E0,"m",E6).call(this)}}Z1.GoogleToken=C5;k1=new WeakMap,E0=new WeakSet,j6=async function Z($){if(j0(this,k1,"f")&&!$.forceRefresh)return j0(this,k1,"f");try{return await M5(this,k1,j0(this,E0,"m",G5).call(this,$),"f")}finally{M5(this,k1,void 0,"f")}},G5=async function Z($){if(this.isTokenExpiring()===!1&&$.forceRefresh===!1)return Promise.resolve(this.rawToken);if(!this.key&&!this.keyFile)throw new Error("No key or keyFile set.");if(!this.key&&this.keyFile){const Y=await this.getCredentials(this.keyFile);if(this.key=Y.privateKey,this.iss=Y.clientEmail||this.iss,!Y.clientEmail)j0(this,E0,"m",D5).call(this)}return j0(this,E0,"m",N5).call(this)},D5=function Z(){if(!this.iss)throw new v1("email is required.","MISSING_CREDENTIALS")},E6=async function Z(){if(!this.accessToken)throw new Error("No token to revoke.");const $=Y7+this.accessToken;await this.transporter.request({url:$,retry:!0}),j0(this,E0,"m",_6).call(this,{email:this.iss,sub:this.sub,key:this.key,keyFile:this.keyFile,scope:this.scope,additionalClaims:this.additionalClaims})},_6=function Z($={}){if(this.keyFile=$.keyFile,this.key=$.key,this.rawToken=void 0,this.iss=$.email||$.iss,this.sub=$.sub,this.additionalClaims=$.additionalClaims,typeof $.scope==="object")this.scope=$.scope.join(" ");else this.scope=$.scope;if(this.eagerRefreshThresholdMillis=$.eagerRefreshThresholdMillis,$.transporter)this.transporter=$.transporter},N5=async function Z(){var $,Y;const Q=Math.floor(new Date().getTime()/1000),W=this.additionalClaims||{},V=Object.assign({iss:this.iss,scope:this.scope,aud:L5,exp:Q+3600,iat:Q,sub:this.sub},W),J=ez.sign({header:{alg:"RS256"},payload:V,secret:this.key});try{const K=await this.transporter.request({method:"POST",url:L5,data:{grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:J},headers:{"Content-Type":"application/x-www-form-urlencoded"},responseType:"json",retryConfig:{httpMethodsToRetry:["POST"]}});return this.rawToken=K.data,this.expiresAt=K.data.expires_in===null||K.data.expires_in===void 0?void 0:(Q+K.data.expires_in)*1000,this.rawToken}catch(K){this.rawToken=void 0,this.tokenExpires=void 0;const w=K.response&&(($=K.response)===null||$===void 0?void 0:$.data)?(Y=K.response)===null||Y===void 0?void 0:Y.data:{};if(w.error){const L=w.error_description?`: ${w.error_description}`:"";K.message=`${w.error}${L}`}throw K}}});var h6=O((S5)=>{Object.defineProperty(S5,"__esModule",{value:!0});S5.JWTAccess=void 0;var Q7=A6(),W7=F1(),O5={alg:"RS256",typ:"JWT"};class x6{constructor(Z,$,Y,Q){this.cache=new W7.LRUCache({capacity:500,maxAge:3600000}),this.email=Z,this.key=$,this.keyId=Y,this.eagerRefreshThresholdMillis=Q!==null&&Q!==void 0?Q:300000}getCachedKey(Z,$){let Y=Z;if($&&Array.isArray($)&&$.length)Y=Z?`${Z}_${$.join("_")}`:`${$.join("_")}`;else if(typeof $==="string")Y=Z?`${Z}_${$}`:$;if(!Y)throw Error("Scopes or url must be provided");return Y}getRequestHeaders(Z,$,Y){const Q=this.getCachedKey(Z,Y),W=this.cache.get(Q),V=Date.now();if(W&&W.expiration-V>this.eagerRefreshThresholdMillis)return W.headers;const J=Math.floor(Date.now()/1000),K=x6.getExpirationTime(J);let w;if(Array.isArray(Y))Y=Y.join(" ");if(Y)w={iss:this.email,sub:this.email,scope:Y,exp:K,iat:J};else w={iss:this.email,sub:this.email,aud:Z,exp:K,iat:J};if($){for(let v in w)if($[v])throw new Error(`The '${v}' property is not allowed when passing additionalClaims. This claim is included in the JWT by default.`)}const L=this.keyId?{...O5,kid:this.keyId}:O5,F=Object.assign(w,$),S={Authorization:`Bearer ${Q7.sign({header:L,payload:F,secret:this.key})}`};return this.cache.set(Q,{expiration:K*1000,headers:S}),S}static getExpirationTime(Z){return Z+3600}fromJSON(Z){if(!Z)throw new Error("Must pass in a JSON object containing the service account auth settings.");if(!Z.client_email)throw new Error("The incoming JSON object does not contain a client_email field");if(!Z.private_key)throw new Error("The incoming JSON object does not contain a private_key field");this.email=Z.client_email,this.key=Z.private_key,this.keyId=Z.private_key_id,this.projectId=Z.project_id}fromStream(Z,$){if($)this.fromStreamAsync(Z).then(()=>$(),$);else return this.fromStreamAsync(Z)}fromStreamAsync(Z){return new Promise(($,Y)=>{if(!Z)Y(new Error("Must pass in a stream containing the service account auth settings."));let Q="";Z.setEncoding("utf8").on("data",(W)=>Q+=W).on("error",Y).on("end",()=>{try{const W=JSON.parse(Q);this.fromJSON(W),$()}catch(W){Y(W)}})})}}S5.JWTAccess=x6});var k6=O((A5)=>{Object.defineProperty(A5,"__esModule",{value:!0});A5.JWT=void 0;var B5=T5(),V7=h6(),J7=M1(),Q4=b0();class f6 extends J7.OAuth2Client{constructor(Z,$,Y,Q,W,V){const J=Z&&typeof Z==="object"?Z:{email:Z,keyFile:$,key:Y,keyId:V,scopes:Q,subject:W};super(J);this.email=J.email,this.keyFile=J.keyFile,this.key=J.key,this.keyId=J.keyId,this.scopes=J.scopes,this.subject=J.subject,this.additionalClaims=J.additionalClaims,this.credentials={refresh_token:"jwt-placeholder",expiry_date:1}}createScoped(Z){const $=new f6(this);return $.scopes=Z,$}async getRequestMetadataAsync(Z){Z=this.defaultServicePath?`https://${this.defaultServicePath}/`:Z;const $=!this.hasUserScopes()&&Z||this.useJWTAccessWithScope&&this.hasAnyScopes()||this.universeDomain!==Q4.DEFAULT_UNIVERSE;if(this.subject&&this.universeDomain!==Q4.DEFAULT_UNIVERSE)throw new RangeError(`Service Account user is configured for the credential. Domain-wide delegation is not supported in universes other than ${Q4.DEFAULT_UNIVERSE}`);if(!this.apiKey&&$)if(this.additionalClaims&&this.additionalClaims.target_audience){const{tokens:Y}=await this.refreshToken();return{headers:this.addSharedMetadataHeaders({Authorization:`Bearer ${Y.id_token}`})}}else{if(!this.access)this.access=new V7.JWTAccess(this.email,this.key,this.keyId,this.eagerRefreshThresholdMillis);let Y;if(this.hasUserScopes())Y=this.scopes;else if(!Z)Y=this.defaultScopes;const Q=this.useJWTAccessWithScope||this.universeDomain!==Q4.DEFAULT_UNIVERSE,W=await this.access.getRequestHeaders(Z!==null&&Z!==void 0?Z:void 0,this.additionalClaims,Q?Y:void 0);return{headers:this.addSharedMetadataHeaders(W)}}else if(this.hasAnyScopes()||this.apiKey)return super.getRequestMetadataAsync(Z);else return{headers:{}}}async fetchIdToken(Z){const $=new B5.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:{target_audience:Z},transporter:this.transporter});if(await $.getToken({forceRefresh:!0}),!$.idToken)throw new Error("Unknown error: Failed to fetch ID token");return $.idToken}hasUserScopes(){if(!this.scopes)return!1;return this.scopes.length>0}hasAnyScopes(){if(this.scopes&&this.scopes.length>0)return!0;if(this.defaultScopes&&this.defaultScopes.length>0)return!0;return!1}authorize(Z){if(Z)this.authorizeAsync().then(($)=>Z(null,$),Z);else return this.authorizeAsync()}async authorizeAsync(){const Z=await this.refreshToken();if(!Z)throw new Error("No result returned");return this.credentials=Z.tokens,this.credentials.refresh_token="jwt-placeholder",this.key=this.gtoken.key,this.email=this.gtoken.iss,Z.tokens}async refreshTokenNoCache(Z){const $=this.createGToken(),Q={access_token:(await $.getToken({forceRefresh:this.isTokenExpiring()})).access_token,token_type:"Bearer",expiry_date:$.expiresAt,id_token:$.idToken};return this.emit("tokens",Q),{res:null,tokens:Q}}createGToken(){if(!this.gtoken)this.gtoken=new B5.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:this.additionalClaims,transporter:this.transporter});return this.gtoken}fromJSON(Z){if(!Z)throw new Error("Must pass in a JSON object containing the service account auth settings.");if(!Z.client_email)throw new Error("The incoming JSON object does not contain a client_email field");if(!Z.private_key)throw new Error("The incoming JSON object does not contain a private_key field");this.email=Z.client_email,this.key=Z.private_key,this.keyId=Z.private_key_id,this.projectId=Z.project_id,this.quotaProjectId=Z.quota_project_id,this.universeDomain=Z.universe_domain||this.universeDomain}fromStream(Z,$){if($)this.fromStreamAsync(Z).then(()=>$(),$);else return this.fromStreamAsync(Z)}fromStreamAsync(Z){return new Promise(($,Y)=>{if(!Z)throw new Error("Must pass in a stream containing the service account auth settings.");let Q="";Z.setEncoding("utf8").on("error",Y).on("data",(W)=>Q+=W).on("end",()=>{try{const W=JSON.parse(Q);this.fromJSON(W),$()}catch(W){Y(W)}})})}fromAPIKey(Z){if(typeof Z!=="string")throw new Error("Must provide an API Key string.");this.apiKey=Z}async getCredentials(){if(this.key)return{private_key:this.key,client_email:this.email};else if(this.keyFile){const $=await this.createGToken().getCredentials(this.keyFile);return{private_key:$.privateKey,client_email:$.clientEmail}}throw new Error("A key or a keyFile must be provided to getCredentials.")}}A5.JWT=f6});var y6=O((E5)=>{Object.defineProperty(E5,"__esModule",{value:!0});E5.UserRefreshClient=E5.USER_REFRESH_ACCOUNT_TYPE=void 0;var X7=M1(),K7=import.meta.require("querystring");E5.USER_REFRESH_ACCOUNT_TYPE="authorized_user";class v6 extends X7.OAuth2Client{constructor(Z,$,Y,Q,W){const V=Z&&typeof Z==="object"?Z:{clientId:Z,clientSecret:$,refreshToken:Y,eagerRefreshThresholdMillis:Q,forceRefreshOnFailure:W};super(V);this._refreshToken=V.refreshToken,this.credentials.refresh_token=V.refreshToken}async refreshTokenNoCache(Z){return super.refreshTokenNoCache(this._refreshToken)}async fetchIdToken(Z){return(await this.transporter.request({...v6.RETRY_CONFIG,url:this.endpoints.oauth2TokenUrl,headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",data:K7.stringify({client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token",refresh_token:this._refreshToken,target_audience:Z})})).data.id_token}fromJSON(Z){if(!Z)throw new Error("Must pass in a JSON object containing the user refresh token");if(Z.type!=="authorized_user")throw new Error('The incoming JSON object does not have the "authorized_user" type');if(!Z.client_id)throw new Error("The incoming JSON object does not contain a client_id field");if(!Z.client_secret)throw new Error("The incoming JSON object does not contain a client_secret field");if(!Z.refresh_token)throw new Error("The incoming JSON object does not contain a refresh_token field");this._clientId=Z.client_id,this._clientSecret=Z.client_secret,this._refreshToken=Z.refresh_token,this.credentials.refresh_token=Z.refresh_token,this.quotaProjectId=Z.quota_project_id,this.universeDomain=Z.universe_domain||this.universeDomain}fromStream(Z,$){if($)this.fromStreamAsync(Z).then(()=>$(),$);else return this.fromStreamAsync(Z)}async fromStreamAsync(Z){return new Promise(($,Y)=>{if(!Z)return Y(new Error("Must pass in a stream containing the user refresh token."));let Q="";Z.setEncoding("utf8").on("error",Y).on("data",(W)=>Q+=W).on("end",()=>{try{const W=JSON.parse(Q);return this.fromJSON(W),$()}catch(W){return Y(W)}})})}}E5.UserRefreshClient=v6});var b6=O((h5)=>{Object.defineProperty(h5,"__esModule",{value:!0});h5.Impersonated=h5.IMPERSONATED_ACCOUNT_TYPE=void 0;var x5=M1(),w7=P0();h5.IMPERSONATED_ACCOUNT_TYPE="impersonated_service_account";class z8 extends x5.OAuth2Client{constructor(Z={}){var $,Y,Q,W,V,J;super(Z);this.credentials={expiry_date:1,refresh_token:"impersonated-placeholder"},this.sourceClient=($=Z.sourceClient)!==null&&$!==void 0?$:new x5.OAuth2Client,this.targetPrincipal=(Y=Z.targetPrincipal)!==null&&Y!==void 0?Y:"",this.delegates=(Q=Z.delegates)!==null&&Q!==void 0?Q:[],this.targetScopes=(W=Z.targetScopes)!==null&&W!==void 0?W:[],this.lifetime=(V=Z.lifetime)!==null&&V!==void 0?V:3600,this.endpoint=(J=Z.endpoint)!==null&&J!==void 0?J:"https://iamcredentials.googleapis.com"}async sign(Z){await this.sourceClient.getAccessToken();const $=`projects/-/serviceAccounts/${this.targetPrincipal}`,Y=`${this.endpoint}/v1/${$}:signBlob`,Q={delegates:this.delegates,payload:Buffer.from(Z).toString("base64")};return(await this.sourceClient.request({...z8.RETRY_CONFIG,url:Y,data:Q,method:"POST"})).data}getTargetPrincipal(){return this.targetPrincipal}async refreshToken(){var Z,$,Y,Q,W,V;try{await this.sourceClient.getAccessToken();const J="projects/-/serviceAccounts/"+this.targetPrincipal,K=`${this.endpoint}/v1/${J}:generateAccessToken`,w={delegates:this.delegates,scope:this.targetScopes,lifetime:this.lifetime+"s"},L=await this.sourceClient.request({...z8.RETRY_CONFIG,url:K,data:w,method:"POST"}),F=L.data;return this.credentials.access_token=F.accessToken,this.credentials.expiry_date=Date.parse(F.expireTime),{tokens:this.credentials,res:L}}catch(J){if(!(J instanceof Error))throw J;let K=0,w="";if(J instanceof w7.GaxiosError)K=(Y=($=(Z=J===null||J===void 0?void 0:J.response)===null||Z===void 0?void 0:Z.data)===null||$===void 0?void 0:$.error)===null||Y===void 0?void 0:Y.status,w=(V=(W=(Q=J===null||J===void 0?void 0:J.response)===null||Q===void 0?void 0:Q.data)===null||W===void 0?void 0:W.error)===null||V===void 0?void 0:V.message;if(K&&w)throw J.message=`${K}: unable to impersonate: ${w}`,J;else throw J.message=`unable to impersonate: ${J}`,J}}async fetchIdToken(Z,$){var Y;await this.sourceClient.getAccessToken();const Q=`projects/-/serviceAccounts/${this.targetPrincipal}`,W=`${this.endpoint}/v1/${Q}:generateIdToken`,V={delegates:this.delegates,audience:Z,includeEmail:(Y=$===null||$===void 0?void 0:$.includeEmail)!==null&&Y!==void 0?Y:!0};return(await this.sourceClient.request({...z8.RETRY_CONFIG,url:W,data:V,method:"POST"})).data.token}}h5.Impersonated=z8});var g6=O((y5)=>{function F7(Z,$){const{error:Y,error_description:Q,error_uri:W}=Z;let V=`Error code ${Y}`;if(typeof Q!=="undefined")V+=`: ${Q}`;if(typeof W!=="undefined")V+=` - ${W}`;const J=new Error(V);if($){const K=Object.keys($);if($.stack)K.push("stack");K.forEach((w)=>{if(w!=="message")Object.defineProperty(J,w,{value:$[w],writable:!1,enumerable:!0})})}return J}Object.defineProperty(y5,"__esModule",{value:!0});y5.OAuthClientAuthHandler=void 0;y5.getErrorFromOAuthErrorResponse=F7;var k5=import.meta.require("querystring"),U7=j1(),q7=["PUT","POST","PATCH"];class v5{constructor(Z){this.clientAuthentication=Z,this.crypto=U7.createCrypto()}applyClientAuthenticationOptions(Z,$){if(this.injectAuthenticatedHeaders(Z,$),!$)this.injectAuthenticatedRequestBody(Z)}injectAuthenticatedHeaders(Z,$){var Y;if($)Z.headers=Z.headers||{},Object.assign(Z.headers,{Authorization:`Bearer ${$}}`});else if(((Y=this.clientAuthentication)===null||Y===void 0?void 0:Y.confidentialClientType)==="basic"){Z.headers=Z.headers||{};const Q=this.clientAuthentication.clientId,W=this.clientAuthentication.clientSecret||"",V=this.crypto.encodeBase64StringUtf8(`${Q}:${W}`);Object.assign(Z.headers,{Authorization:`Basic ${V}`})}}injectAuthenticatedRequestBody(Z){var $;if((($=this.clientAuthentication)===null||$===void 0?void 0:$.confidentialClientType)==="request-body"){const Y=(Z.method||"GET").toUpperCase();if(q7.indexOf(Y)!==-1){let Q;const W=Z.headers||{};for(let V in W)if(V.toLowerCase()==="content-type"&&W[V]){Q=W[V].toLowerCase();break}if(Q==="application/x-www-form-urlencoded"){Z.data=Z.data||"";const V=k5.parse(Z.data);Object.assign(V,{client_id:this.clientAuthentication.clientId,client_secret:this.clientAuthentication.clientSecret||""}),Z.data=k5.stringify(V)}else if(Q==="application/json")Z.data=Z.data||{},Object.assign(Z.data,{client_id:this.clientAuthentication.clientId,client_secret:this.clientAuthentication.clientSecret||""});else throw new Error(`${Q} content-types are not supported with ${this.clientAuthentication.confidentialClientType} client authentication`)}else throw new Error(`${Y} HTTP method does not support ${this.clientAuthentication.confidentialClientType} client authentication`)}}static get RETRY_CONFIG(){return{retry:!0,retryConfig:{httpMethodsToRetry:["GET","PUT","POST","HEAD","OPTIONS","DELETE"]}}}}y5.OAuthClientAuthHandler=v5});var u6=O((m5)=>{Object.defineProperty(m5,"__esModule",{value:!0});m5.StsCredentials=void 0;var G7=P0(),D7=import.meta.require("querystring"),N7=Q8(),g5=g6();class m6 extends g5.OAuthClientAuthHandler{constructor(Z,$){super($);this.tokenExchangeEndpoint=Z,this.transporter=new N7.DefaultTransporter}async exchangeToken(Z,$,Y){var Q,W,V;const J={grant_type:Z.grantType,resource:Z.resource,audience:Z.audience,scope:(Q=Z.scope)===null||Q===void 0?void 0:Q.join(" "),requested_token_type:Z.requestedTokenType,subject_token:Z.subjectToken,subject_token_type:Z.subjectTokenType,actor_token:(W=Z.actingParty)===null||W===void 0?void 0:W.actorToken,actor_token_type:(V=Z.actingParty)===null||V===void 0?void 0:V.actorTokenType,options:Y&&JSON.stringify(Y)};Object.keys(J).forEach((L)=>{if(typeof J[L]==="undefined")delete J[L]});const K={"Content-Type":"application/x-www-form-urlencoded"};Object.assign(K,$||{});const w={...m6.RETRY_CONFIG,url:this.tokenExchangeEndpoint.toString(),method:"POST",headers:K,data:D7.stringify(J),responseType:"json"};this.applyClientAuthenticationOptions(w);try{const L=await this.transporter.request(w),F=L.data;return F.res=L,F}catch(L){if(L instanceof G7.GaxiosError&&L.response)throw g5.getErrorFromOAuthErrorResponse(L.response.data,L);throw L}}}m5.StsCredentials=m6});var $1=O((Y0)=>{var d6=Y0&&Y0.__classPrivateFieldGet||function(Z,$,Y,Q){if(Y==="a"&&!Q)throw new TypeError("Private accessor was defined without a getter");if(typeof $==="function"?Z!==$||!Q:!$.has(Z))throw new TypeError("Cannot read private member from an object whose class did not declare it");return Y==="m"?Q:Y==="a"?Q.call(Z):Q?Q.value:$.get(Z)},d5=Y0&&Y0.__classPrivateFieldSet||function(Z,$,Y,Q,W){if(Q==="m")throw new TypeError("Private method is not writable");if(Q==="a"&&!W)throw new TypeError("Private accessor was defined without a setter");if(typeof $==="function"?Z!==$||!W:!$.has(Z))throw new TypeError("Cannot write private member to an object whose class did not declare it");return Q==="a"?W.call(Z,Y):W?W.value=Y:$.set(Z,Y),Y},l6,y1,c5;Object.defineProperty(Y0,"__esModule",{value:!0});Y0.BaseExternalAccountClient=Y0.DEFAULT_UNIVERSE=Y0.CLOUD_RESOURCE_MANAGER=Y0.EXTERNAL_ACCOUNT_TYPE=Y0.EXPIRATION_TIME_OFFSET=void 0;var I7=import.meta.require("stream"),R7=b0(),L7=u6(),l5=F1(),C7="urn:ietf:params:oauth:grant-type:token-exchange",T7="urn:ietf:params:oauth:token-type:access_token",c6="https://www.googleapis.com/auth/cloud-platform",O7=3600;Y0.EXPIRATION_TIME_OFFSET=300000;Y0.EXTERNAL_ACCOUNT_TYPE="external_account";Y0.CLOUD_RESOURCE_MANAGER="https://cloudresourcemanager.googleapis.com/v1/projects/";var S7="//iam\\.googleapis\\.com/locations/[^/]+/workforcePools/[^/]+/providers/.+",P7="https://sts.{universeDomain}/v1/token",B7=J6(),A7=b0();Object.defineProperty(Y0,"DEFAULT_UNIVERSE",{enumerable:!0,get:function(){return A7.DEFAULT_UNIVERSE}});class W4 extends R7.AuthClient{constructor(Z,$){var Y;super({...Z,...$});l6.add(this),y1.set(this,null);const Q=l5.originalOrCamelOptions(Z),W=Q.get("type");if(W&&W!==Y0.EXTERNAL_ACCOUNT_TYPE)throw new Error(`Expected "${Y0.EXTERNAL_ACCOUNT_TYPE}" type but received "${Z.type}"`);const V=Q.get("client_id"),J=Q.get("client_secret"),K=(Y=Q.get("token_url"))!==null&&Y!==void 0?Y:P7.replace("{universeDomain}",this.universeDomain),w=Q.get("subject_token_type"),L=Q.get("workforce_pool_user_project"),F=Q.get("service_account_impersonation_url"),C=Q.get("service_account_impersonation"),S=l5.originalOrCamelOptions(C).get("token_lifetime_seconds");if(this.cloudResourceManagerURL=new URL(Q.get("cloud_resource_manager_url")||`https://cloudresourcemanager.${this.universeDomain}/v1/projects/`),V)this.clientAuth={confidentialClientType:"basic",clientId:V,clientSecret:J};this.stsCredential=new L7.StsCredentials(K,this.clientAuth),this.scopes=Q.get("scopes")||[c6],this.cachedAccessToken=null,this.audience=Q.get("audience"),this.subjectTokenType=w,this.workforcePoolUserProject=L;const v=new RegExp(S7);if(this.workforcePoolUserProject&&!this.audience.match(v))throw new Error("workforcePoolUserProject should not be set for non-workforce pool credentials.");if(this.serviceAccountImpersonationUrl=F,this.serviceAccountImpersonationLifetime=S,this.serviceAccountImpersonationLifetime)this.configLifetimeRequested=!0;else this.configLifetimeRequested=!1,this.serviceAccountImpersonationLifetime=O7;this.projectNumber=this.getProjectNumber(this.audience),this.supplierContext={audience:this.audience,subjectTokenType:this.subjectTokenType,transporter:this.transporter}}getServiceAccountEmail(){var Z;if(this.serviceAccountImpersonationUrl){if(this.serviceAccountImpersonationUrl.length>256)throw new RangeError(`URL is too long: ${this.serviceAccountImpersonationUrl}`);const Y=/serviceAccounts\/(?<email>[^:]+):generateAccessToken$/.exec(this.serviceAccountImpersonationUrl);return((Z=Y===null||Y===void 0?void 0:Y.groups)===null||Z===void 0?void 0:Z.email)||null}return null}setCredentials(Z){super.setCredentials(Z),this.cachedAccessToken=Z}async getAccessToken(){if(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))await this.refreshAccessTokenAsync();return{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){const $={Authorization:`Bearer ${(await this.getAccessToken()).token}`};return this.addSharedMetadataHeaders($)}request(Z,$){if($)this.requestAsync(Z).then((Y)=>$(null,Y),(Y)=>{return $(Y,Y.response)});else return this.requestAsync(Z)}async getProjectId(){const Z=this.projectNumber||this.workforcePoolUserProject;if(this.projectId)return this.projectId;else if(Z){const $=await this.getRequestHeaders(),Y=await this.transporter.request({...W4.RETRY_CONFIG,headers:$,url:`${this.cloudResourceManagerURL.toString()}${Z}`,responseType:"json"});return this.projectId=Y.data.projectId,this.projectId}return null}async requestAsync(Z,$=!1){let Y;try{const Q=await this.getRequestHeaders();if(Z.headers=Z.headers||{},Q&&Q["x-goog-user-project"])Z.headers["x-goog-user-project"]=Q["x-goog-user-project"];if(Q&&Q.Authorization)Z.headers.Authorization=Q.Authorization;Y=await this.transporter.request(Z)}catch(Q){const W=Q.response;if(W){const V=W.status,J=W.config.data instanceof I7.Readable;if(!$&&(V===401||V===403)&&!J&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(Z,!0)}throw Q}return Y}async refreshAccessTokenAsync(){d5(this,y1,d6(this,y1,"f")||d6(this,l6,"m",c5).call(this),"f");try{return await d6(this,y1,"f")}finally{d5(this,y1,null,"f")}}getProjectNumber(Z){const $=Z.match(/\/projects\/([^/]+)/);if(!$)return null;return $[1]}async getImpersonatedAccessToken(Z){const $={...W4.RETRY_CONFIG,url:this.serviceAccountImpersonationUrl,method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Z}`},data:{scope:this.getScopesArray(),lifetime:this.serviceAccountImpersonationLifetime+"s"},responseType:"json"},Y=await this.transporter.request($),Q=Y.data;return{access_token:Q.accessToken,expiry_date:new Date(Q.expireTime).getTime(),res:Y}}isExpired(Z){const $=new Date().getTime();return Z.expiry_date?$>=Z.expiry_date-this.eagerRefreshThresholdMillis:!1}getScopesArray(){if(typeof this.scopes==="string")return[this.scopes];return this.scopes||[c6]}getMetricsHeaderValue(){const Z=process.version.replace(/^v/,""),$=this.serviceAccountImpersonationUrl!==void 0,Y=this.credentialSourceType?this.credentialSourceType:"unknown";return`gl-node/${Z} auth/${B7.version} google-byoid-sdk source/${Y} sa-impersonation/${$} config-lifetime/${this.configLifetimeRequested}`}}Y0.BaseExternalAccountClient=W4;y1=new WeakMap,l6=new WeakSet,c5=async function Z(){const $=await this.retrieveSubjectToken(),Y={grantType:C7,audience:this.audience,requestedTokenType:T7,subjectToken:$,subjectTokenType:this.subjectTokenType,scope:this.serviceAccountImpersonationUrl?[c6]:this.getScopesArray()},Q=!this.clientAuth&&this.workforcePoolUserProject?{userProject:this.workforcePoolUserProject}:void 0,W={"x-goog-api-client":this.getMetricsHeaderValue()},V=await this.stsCredential.exchangeToken(Y,W,Q);if(this.serviceAccountImpersonationUrl)this.cachedAccessToken=await this.getImpersonatedAccessToken(V.access_token);else if(V.expires_in)this.cachedAccessToken={access_token:V.access_token,expiry_date:new Date().getTime()+V.expires_in*1000,res:V.res};else this.cachedAccessToken={access_token:V.access_token,res:V.res};return this.credentials={},Object.assign(this.credentials,this.cachedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedAccessToken.expiry_date,access_token:this.cachedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedAccessToken}});var a5=O((i5)=>{var p6,i6,n6;Object.defineProperty(i5,"__esModule",{value:!0});i5.FileSubjectTokenSupplier=void 0;var a6=import.meta.require("util"),o6=import.meta.require("fs"),j7=a6.promisify((p6=o6.readFile)!==null&&p6!==void 0?p6:()=>{}),E7=a6.promisify((i6=o6.realpath)!==null&&i6!==void 0?i6:()=>{}),_7=a6.promisify((n6=o6.lstat)!==null&&n6!==void 0?n6:()=>{});class p5{constructor(Z){this.filePath=Z.filePath,this.formatType=Z.formatType,this.subjectTokenFieldName=Z.subjectTokenFieldName}async getSubjectToken(Z){let $=this.filePath;try{if($=await E7($),!(await _7($)).isFile())throw new Error}catch(W){if(W instanceof Error)W.message=`The file at ${$} does not exist, or it is not a file. ${W.message}`;throw W}let Y;const Q=await j7($,{encoding:"utf8"});if(this.formatType==="text")Y=Q;else if(this.formatType==="json"&&this.subjectTokenFieldName)Y=JSON.parse(Q)[this.subjectTokenFieldName];if(!Y)throw new Error("Unable to parse the subject_token from the credential_source file");return Y}}i5.FileSubjectTokenSupplier=p5});var s5=O((r5)=>{Object.defineProperty(r5,"__esModule",{value:!0});r5.UrlSubjectTokenSupplier=void 0;class o5{constructor(Z){this.url=Z.url,this.formatType=Z.formatType,this.subjectTokenFieldName=Z.subjectTokenFieldName,this.headers=Z.headers,this.additionalGaxiosOptions=Z.additionalGaxiosOptions}async getSubjectToken(Z){const $={...this.additionalGaxiosOptions,url:this.url,method:"GET",headers:this.headers,responseType:this.formatType};let Y;if(this.formatType==="text")Y=(await Z.transporter.request($)).data;else if(this.formatType==="json"&&this.subjectTokenFieldName)Y=(await Z.transporter.request($)).data[this.subjectTokenFieldName];if(!Y)throw new Error("Unable to parse the subject_token from the credential_source URL");return Y}}r5.UrlSubjectTokenSupplier=o5});var s6=O((e5)=>{Object.defineProperty(e5,"__esModule",{value:!0});e5.IdentityPoolClient=void 0;var x7=$1(),r6=F1(),h7=a5(),f7=s5();class t6 extends x7.BaseExternalAccountClient{constructor(Z,$){super(Z,$);const Y=r6.originalOrCamelOptions(Z),Q=Y.get("credential_source"),W=Y.get("subject_token_supplier");if(!Q&&!W)throw new Error("A credential source or subject token supplier must be specified.");if(Q&&W)throw new Error("Only one of credential source or subject token supplier can be specified.");if(W)this.subjectTokenSupplier=W,this.credentialSourceType="programmatic";else{const V=r6.originalOrCamelOptions(Q),J=r6.originalOrCamelOptions(V.get("format")),K=J.get("type")||"text",w=J.get("subject_token_field_name");if(K!=="json"&&K!=="text")throw new Error(`Invalid credential_source format "${K}"`);if(K==="json"&&!w)throw new Error("Missing subject_token_field_name for JSON credential_source format");const L=V.get("file"),F=V.get("url"),C=V.get("headers");if(L&&F)throw new Error('No valid Identity Pool "credential_source" provided, must be either file or url.');else if(L&&!F)this.credentialSourceType="file",this.subjectTokenSupplier=new h7.FileSubjectTokenSupplier({filePath:L,formatType:K,subjectTokenFieldName:w});else if(!L&&F)this.credentialSourceType="url",this.subjectTokenSupplier=new f7.UrlSubjectTokenSupplier({url:F,formatType:K,subjectTokenFieldName:w,headers:C,additionalGaxiosOptions:t6.RETRY_CONFIG});else throw new Error('No valid Identity Pool "credential_source" provided, must be either file or url.')}}async retrieveSubjectToken(){return this.subjectTokenSupplier.getSubjectToken(this.supplierContext)}}e5.IdentityPoolClient=t6});var e6=O((WW)=>{async function w8(Z,$,Y){return await Z.signWithHmacSha256($,Y)}async function v7(Z,$,Y,Q,W){const V=await w8(Z,`AWS4${$}`,Y),J=await w8(Z,V,Q),K=await w8(Z,J,W);return await w8(Z,K,"aws4_request")}async function y7(Z){const $=Z.additionalAmzHeaders||{},Y=Z.requestPayload||"",Q=Z.host.split(".")[0],W=new Date,V=W.toISOString().replace(/[-:]/g,"").replace(/\.[0-9]+/,""),J=W.toISOString().replace(/[-]/g,"").replace(/T.*/,""),K={};if(Object.keys($).forEach((u)=>{K[u.toLowerCase()]=$[u]}),Z.securityCredentials.token)K["x-amz-security-token"]=Z.securityCredentials.token;const w=Object.assign({host:Z.host},K.date?{}:{"x-amz-date":V},K);let L="";const F=Object.keys(w).sort();F.forEach((u)=>{L+=`${u}:${w[u]}\n`});const C=F.join(";"),S=await Z.crypto.sha256DigestHex(Y),v=`${Z.method}\n${Z.canonicalUri}\n${Z.canonicalQuerystring}\n${L}\n${C}\n${S}`,y=`${J}/${Z.region}/${Q}/${k7}`,j=`${$W}\n${V}\n${y}\n`+await Z.crypto.sha256DigestHex(v),E=await v7(Z.crypto,Z.securityCredentials.secretAccessKey,J,Z.region,Q),B=await w8(Z.crypto,E,j),b=`${$W} Credential=${Z.securityCredentials.accessKeyId}/${y}, SignedHeaders=${C}, Signature=${YW.fromArrayBufferToHex(B)}`;return{amzDate:K.date?void 0:V,authorizationHeader:b,canonicalQuerystring:Z.canonicalQuerystring}}Object.defineProperty(WW,"__esModule",{value:!0});WW.AwsRequestSigner=void 0;var YW=j1(),$W="AWS4-HMAC-SHA256",k7="aws4_request";class QW{constructor(Z,$){this.getCredentials=Z,this.region=$,this.crypto=YW.createCrypto()}async getRequestOptions(Z){if(!Z.url)throw new Error('"url" is required in "amzOptions"');const $=typeof Z.data==="object"?JSON.stringify(Z.data):Z.data,Y=Z.url,Q=Z.method||"GET",W=Z.body||$,V=Z.headers,J=await this.getCredentials(),K=new URL(Y),w=await y7({crypto:this.crypto,host:K.host,canonicalUri:K.pathname,canonicalQuerystring:K.search.substr(1),method:Q,region:this.region,securityCredentials:J,requestPayload:W,additionalAmzHeaders:V}),L=Object.assign(w.amzDate?{"x-amz-date":w.amzDate}:{},{Authorization:w.authorizationHeader,host:K.host},V||{});if(J.token)Object.assign(L,{"x-amz-security-token":J.token});const F={url:Y,method:Q,headers:L};if(typeof W!=="undefined")F.body=W;return F}}WW.AwsRequestSigner=QW});var zW=O((b1)=>{var o0=b1&&b1.__classPrivateFieldGet||function(Z,$,Y,Q){if(Y==="a"&&!Q)throw new TypeError("Private accessor was defined without a getter");if(typeof $==="function"?Z!==$||!Q:!$.has(Z))throw new TypeError("Cannot read private member from an object whose class did not declare it");return Y==="m"?Q:Y==="a"?Q.call(Z):Q?Q.value:$.get(Z)},_0,ZZ,JW,XW,V4,$Z;Object.defineProperty(b1,"__esModule",{value:!0});b1.DefaultAwsSecurityCredentialsSupplier=void 0;class KW{constructor(Z){_0.add(this),this.regionUrl=Z.regionUrl,this.securityCredentialsUrl=Z.securityCredentialsUrl,this.imdsV2SessionTokenUrl=Z.imdsV2SessionTokenUrl,this.additionalGaxiosOptions=Z.additionalGaxiosOptions}async getAwsRegion(Z){if(o0(this,_0,"a",V4))return o0(this,_0,"a",V4);const $={};if(!o0(this,_0,"a",V4)&&this.imdsV2SessionTokenUrl)$["x-aws-ec2-metadata-token"]=await o0(this,_0,"m",ZZ).call(this,Z.transporter);if(!this.regionUrl)throw new Error('Unable to determine AWS region due to missing "options.credential_source.region_url"');const Y={...this.additionalGaxiosOptions,url:this.regionUrl,method:"GET",responseType:"text",headers:$},Q=await Z.transporter.request(Y);return Q.data.substr(0,Q.data.length-1)}async getAwsSecurityCredentials(Z){if(o0(this,_0,"a",$Z))return o0(this,_0,"a",$Z);const $={};if(this.imdsV2SessionTokenUrl)$["x-aws-ec2-metadata-token"]=await o0(this,_0,"m",ZZ).call(this,Z.transporter);const Y=await o0(this,_0,"m",JW).call(this,$,Z.transporter),Q=await o0(this,_0,"m",XW).call(this,Y,$,Z.transporter);return{accessKeyId:Q.AccessKeyId,secretAccessKey:Q.SecretAccessKey,token:Q.Token}}}b1.DefaultAwsSecurityCredentialsSupplier=KW;_0=new WeakSet,ZZ=async function Z($){const Y={...this.additionalGaxiosOptions,url:this.imdsV2SessionTokenUrl,method:"PUT",responseType:"text",headers:{"x-aws-ec2-metadata-token-ttl-seconds":"300"}};return(await $.request(Y)).data},JW=async function Z($,Y){if(!this.securityCredentialsUrl)throw new Error('Unable to determine AWS role name due to missing "options.credential_source.url"');const Q={...this.additionalGaxiosOptions,url:this.securityCredentialsUrl,method:"GET",responseType:"text",headers:$};return(await Y.request(Q)).data},XW=async function Z($,Y,Q){return(await Q.request({...this.additionalGaxiosOptions,url:`${this.securityCredentialsUrl}/${$}`,responseType:"json",headers:Y})).data},V4=function Z(){return process.env.AWS_REGION||process.env.AWS_DEFAULT_REGION||null},$Z=function Z(){if(process.env.AWS_ACCESS_KEY_ID&&process.env.AWS_SECRET_ACCESS_KEY)return{accessKeyId:process.env.AWS_ACCESS_KEY_ID,secretAccessKey:process.env.AWS_SECRET_ACCESS_KEY,token:process.env.AWS_SESSION_TOKEN};return null}});var YZ=O((g1)=>{var b7=g1&&g1.__classPrivateFieldGet||function(Z,$,Y,Q){if(Y==="a"&&!Q)throw new TypeError("Private accessor was defined without a getter");if(typeof $==="function"?Z!==$||!Q:!$.has(Z))throw new TypeError("Cannot read private member from an object whose class did not declare it");return Y==="m"?Q:Y==="a"?Q.call(Z):Q?Q.value:$.get(Z)},J4,HW;Object.defineProperty(g1,"__esModule",{value:!0});g1.AwsClient=void 0;var g7=e6(),m7=$1(),u7=zW(),wW=F1();class H8 extends m7.BaseExternalAccountClient{constructor(Z,$){super(Z,$);const Y=wW.originalOrCamelOptions(Z),Q=Y.get("credential_source"),W=Y.get("aws_security_credentials_supplier");if(!Q&&!W)throw new Error("A credential source or AWS security credentials supplier must be specified.");if(Q&&W)throw new Error("Only one of credential source or AWS security credentials supplier can be specified.");if(W)this.awsSecurityCredentialsSupplier=W,this.regionalCredVerificationUrl=b7(J4,J4,"f",HW),this.credentialSourceType="programmatic";else{const V=wW.originalOrCamelOptions(Q);this.environmentId=V.get("environment_id");const J=V.get("region_url"),K=V.get("url"),w=V.get("imdsv2_session_token_url");this.awsSecurityCredentialsSupplier=new u7.DefaultAwsSecurityCredentialsSupplier({regionUrl:J,securityCredentialsUrl:K,imdsV2SessionTokenUrl:w}),this.regionalCredVerificationUrl=V.get("regional_cred_verification_url"),this.credentialSourceType="aws",this.validateEnvironmentId()}this.awsRequestSigner=null,this.region=""}validateEnvironmentId(){var Z;const $=(Z=this.environmentId)===null||Z===void 0?void 0:Z.match(/^(aws)(\d+)$/);if(!$||!this.regionalCredVerificationUrl)throw new Error('No valid AWS "credential_source" provided');else if(parseInt($[2],10)!==1)throw new Error(`aws version "${$[2]}" is not supported in the current build.`)}async retrieveSubjectToken(){if(!this.awsRequestSigner)this.region=await this.awsSecurityCredentialsSupplier.getAwsRegion(this.supplierContext),this.awsRequestSigner=new g7.AwsRequestSigner(async()=>{return this.awsSecurityCredentialsSupplier.getAwsSecurityCredentials(this.supplierContext)},this.region);const Z=await this.awsRequestSigner.getRequestOptions({...J4.RETRY_CONFIG,url:this.regionalCredVerificationUrl.replace("{region}",this.region),method:"POST"}),$=[],Y=Object.assign({"x-goog-cloud-target-resource":this.audience},Z.headers);for(let Q in Y)$.push({key:Q,value:Y[Q]});return encodeURIComponent(JSON.stringify({url:Z.url,method:Z.method,headers:$}))}}g1.AwsClient=H8;J4=H8;HW={value:"https://sts.{region}.amazonaws.com?Action=GetCallerIdentity&Version=2011-06-15"};H8.AWS_EC2_METADATA_IPV4_ADDRESS="169.254.169.254";H8.AWS_EC2_METADATA_IPV6_ADDRESS="fd00:ec2::254"});var wZ=O((FW)=>{Object.defineProperty(FW,"__esModule",{value:!0});FW.InvalidSubjectTokenError=FW.InvalidMessageFieldError=FW.InvalidCodeFieldError=FW.InvalidTokenTypeFieldError=FW.InvalidExpirationTimeFieldError=FW.InvalidSuccessFieldError=FW.InvalidVersionFieldError=FW.ExecutableResponseError=FW.ExecutableResponse=void 0;var X4="urn:ietf:params:oauth:token-type:saml2",QZ="urn:ietf:params:oauth:token-type:id_token",WZ="urn:ietf:params:oauth:token-type:jwt";class UW{constructor(Z){if(!Z.version)throw new VZ("Executable response must contain a 'version' field.");if(Z.success===void 0)throw new JZ("Executable response must contain a 'success' field.");if(this.version=Z.version,this.success=Z.success,this.success){if(this.expirationTime=Z.expiration_time,this.tokenType=Z.token_type,this.tokenType!==X4&&this.tokenType!==QZ&&this.tokenType!==WZ)throw new XZ(`Executable response must contain a 'token_type' field when successful and it must be one of ${QZ}, ${WZ}, or ${X4}.`);if(this.tokenType===X4){if(!Z.saml_response)throw new K4(`Executable response must contain a 'saml_response' field when token_type=${X4}.`);this.subjectToken=Z.saml_response}else{if(!Z.id_token)throw new K4(`Executable response must contain a 'id_token' field when token_type=${QZ} or ${WZ}.`);this.subjectToken=Z.id_token}}else{if(!Z.code)throw new KZ("Executable response must contain a 'code' field when unsuccessful.");if(!Z.message)throw new zZ("Executable response must contain a 'message' field when unsuccessful.");this.errorCode=Z.code,this.errorMessage=Z.message}}isValid(){return!this.isExpired()&&this.success}isExpired(){return this.expirationTime!==void 0&&this.expirationTime<Math.round(Date.now()/1000)}}FW.ExecutableResponse=UW;class r0 extends Error{constructor(Z){super(Z);Object.setPrototypeOf(this,new.target.prototype)}}FW.ExecutableResponseError=r0;class VZ extends r0{}FW.InvalidVersionFieldError=VZ;class JZ extends r0{}FW.InvalidSuccessFieldError=JZ;class qW extends r0{}FW.InvalidExpirationTimeFieldError=qW;class XZ extends r0{}FW.InvalidTokenTypeFieldError=XZ;class KZ extends r0{}FW.InvalidCodeFieldError=KZ;class zZ extends r0{}FW.InvalidMessageFieldError=zZ;class K4 extends r0{}FW.InvalidSubjectTokenError=K4});var NW=O((GW)=>{Object.defineProperty(GW,"__esModule",{value:!0});GW.PluggableAuthHandler=void 0;var r7=z4(),N1=wZ(),t7=import.meta.require("child_process"),HZ=import.meta.require("fs");class UZ{constructor(Z){if(!Z.command)throw new Error("No command provided.");if(this.commandComponents=UZ.parseCommand(Z.command),this.timeoutMillis=Z.timeoutMillis,!this.timeoutMillis)throw new Error("No timeoutMillis provided.");this.outputFile=Z.outputFile}retrieveResponseFromExecutable(Z){return new Promise(($,Y)=>{const Q=t7.spawn(this.commandComponents[0],this.commandComponents.slice(1),{env:{...process.env,...Object.fromEntries(Z)}});let W="";Q.stdout.on("data",(J)=>{W+=J}),Q.stderr.on("data",(J)=>{W+=J});const V=setTimeout(()=>{return Q.removeAllListeners(),Q.kill(),Y(new Error("The executable failed to finish within the timeout specified."))},this.timeoutMillis);Q.on("close",(J)=>{if(clearTimeout(V),J===0)try{const K=JSON.parse(W),w=new N1.ExecutableResponse(K);return $(w)}catch(K){if(K instanceof N1.ExecutableResponseError)return Y(K);return Y(new N1.ExecutableResponseError(`The executable returned an invalid response: ${W}`))}else return Y(new r7.ExecutableError(W,J.toString()))})})}async retrieveCachedResponse(){if(!this.outputFile||this.outputFile.length===0)return;let Z;try{Z=await HZ.promises.realpath(this.outputFile)}catch(Y){return}if(!(await HZ.promises.lstat(Z)).isFile())return;const $=await HZ.promises.readFile(Z,{encoding:"utf8"});if($==="")return;try{const Y=JSON.parse($);if(new N1.ExecutableResponse(Y).isValid())return new N1.ExecutableResponse(Y);return}catch(Y){if(Y instanceof N1.ExecutableResponseError)throw Y;throw new N1.ExecutableResponseError(`The output file contained an invalid response: ${$}`)}}static parseCommand(Z){const $=Z.match(/(?:[^\s"]+|"[^"]*")+/g);if(!$)throw new Error(`Provided command: "${Z}" could not be parsed.`);for(let Y=0;Y<$.length;Y++)if($[Y][0]==='"'&&$[Y].slice(-1)==='"')$[Y]=$[Y].slice(1,-1);return $}}GW.PluggableAuthHandler=UZ});var z4=O((TW)=>{Object.defineProperty(TW,"__esModule",{value:!0});TW.PluggableAuthClient=TW.ExecutableError=void 0;var s7=$1(),e7=wZ(),Zw=NW();class qZ extends Error{constructor(Z,$){super(`The executable failed with exit code: ${$} and error message: ${Z}.`);this.code=$,Object.setPrototypeOf(this,new.target.prototype)}}TW.ExecutableError=qZ;var $w=30000,IW=5000,RW=120000,Yw="GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES",LW=1;class CW extends s7.BaseExternalAccountClient{constructor(Z,$){super(Z,$);if(!Z.credential_source.executable)throw new Error('No valid Pluggable Auth "credential_source" provided.');if(this.command=Z.credential_source.executable.command,!this.command)throw new Error('No valid Pluggable Auth "credential_source" provided.');if(Z.credential_source.executable.timeout_millis===void 0)this.timeoutMillis=$w;else if(this.timeoutMillis=Z.credential_source.executable.timeout_millis,this.timeoutMillis<IW||this.timeoutMillis>RW)throw new Error(`Timeout must be between ${IW} and ${RW} milliseconds.`);this.outputFile=Z.credential_source.executable.output_file,this.handler=new Zw.PluggableAuthHandler({command:this.command,timeoutMillis:this.timeoutMillis,outputFile:this.outputFile}),this.credentialSourceType="executable"}async retrieveSubjectToken(){if(process.env[Yw]!=="1")throw new Error("Pluggable Auth executables need to be explicitly allowed to run by setting the GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES environment Variable to 1.");let Z=void 0;if(this.outputFile)Z=await this.handler.retrieveCachedResponse();if(!Z){const $=new Map;if($.set("GOOGLE_EXTERNAL_ACCOUNT_AUDIENCE",this.audience),$.set("GOOGLE_EXTERNAL_ACCOUNT_TOKEN_TYPE",this.subjectTokenType),$.set("GOOGLE_EXTERNAL_ACCOUNT_INTERACTIVE","0"),this.outputFile)$.set("GOOGLE_EXTERNAL_ACCOUNT_OUTPUT_FILE",this.outputFile);const Y=this.getServiceAccountEmail();if(Y)$.set("GOOGLE_EXTERNAL_ACCOUNT_IMPERSONATED_EMAIL",Y);Z=await this.handler.retrieveResponseFromExecutable($)}if(Z.version>LW)throw new Error(`Version of executable is not currently supported, maximum supported version is ${LW}.`);if(!Z.success)throw new qZ(Z.errorMessage,Z.errorCode);if(this.outputFile){if(!Z.expirationTime)throw new e7.InvalidExpirationTimeFieldError("The executable response must contain the `expiration_time` field for successful responses when an output_file has been specified in the configuration.")}if(Z.isExpired())throw new Error("Executable response is expired.");return Z.subjectToken}}TW.PluggableAuthClient=CW});var FZ=O((PW)=>{Object.defineProperty(PW,"__esModule",{value:!0});PW.ExternalAccountClient=void 0;var Ww=$1(),Vw=s6(),Jw=YZ(),Xw=z4();class SW{constructor(){throw new Error("ExternalAccountClients should be initialized via: ExternalAccountClient.fromJSON(), directly via explicit constructors, eg. new AwsClient(options), new IdentityPoolClient(options), newPluggableAuthClientOptions, or via new GoogleAuth(options).getClient()")}static fromJSON(Z,$){var Y,Q;if(Z&&Z.type===Ww.EXTERNAL_ACCOUNT_TYPE)if((Y=Z.credential_source)===null||Y===void 0?void 0:Y.environment_id)return new Jw.AwsClient(Z,$);else if((Q=Z.credential_source)===null||Q===void 0?void 0:Q.executable)return new Xw.PluggableAuthClient(Z,$);else return new Vw.IdentityPoolClient(Z,$);else return null}}PW.ExternalAccountClient=SW});var xW=O((EW)=>{Object.defineProperty(EW,"__esModule",{value:!0});EW.ExternalAccountAuthorizedUserClient=EW.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE=void 0;var Kw=b0(),AW=g6(),zw=P0(),ww=import.meta.require("stream"),Hw=$1();EW.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE="external_account_authorized_user";var Uw="https://sts.{universeDomain}/v1/oauthtoken";class MZ extends AW.OAuthClientAuthHandler{constructor(Z,$,Y){super(Y);this.url=Z,this.transporter=$}async refreshToken(Z,$){const Y=new URLSearchParams({grant_type:"refresh_token",refresh_token:Z}),Q={"Content-Type":"application/x-www-form-urlencoded",...$},W={...MZ.RETRY_CONFIG,url:this.url,method:"POST",headers:Q,data:Y.toString(),responseType:"json"};this.applyClientAuthenticationOptions(W);try{const V=await this.transporter.request(W),J=V.data;return J.res=V,J}catch(V){if(V instanceof zw.GaxiosError&&V.response)throw AW.getErrorFromOAuthErrorResponse(V.response.data,V);throw V}}}class jW extends Kw.AuthClient{constructor(Z,$){var Y;super({...Z,...$});if(Z.universe_domain)this.universeDomain=Z.universe_domain;this.refreshToken=Z.refresh_token;const Q={confidentialClientType:"basic",clientId:Z.client_id,clientSecret:Z.client_secret};if(this.externalAccountAuthorizedUserHandler=new MZ((Y=Z.token_url)!==null&&Y!==void 0?Y:Uw.replace("{universeDomain}",this.universeDomain),this.transporter,Q),this.cachedAccessToken=null,this.quotaProjectId=Z.quota_project_id,typeof($===null||$===void 0?void 0:$.eagerRefreshThresholdMillis)!=="number")this.eagerRefreshThresholdMillis=Hw.EXPIRATION_TIME_OFFSET;else this.eagerRefreshThresholdMillis=$.eagerRefreshThresholdMillis;this.forceRefreshOnFailure=!!($===null||$===void 0?void 0:$.forceRefreshOnFailure)}async getAccessToken(){if(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))await this.refreshAccessTokenAsync();return{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){const $={Authorization:`Bearer ${(await this.getAccessToken()).token}`};return this.addSharedMetadataHeaders($)}request(Z,$){if($)this.requestAsync(Z).then((Y)=>$(null,Y),(Y)=>{return $(Y,Y.response)});else return this.requestAsync(Z)}async requestAsync(Z,$=!1){let Y;try{const Q=await this.getRequestHeaders();if(Z.headers=Z.headers||{},Q&&Q["x-goog-user-project"])Z.headers["x-goog-user-project"]=Q["x-goog-user-project"];if(Q&&Q.Authorization)Z.headers.Authorization=Q.Authorization;Y=await this.transporter.request(Z)}catch(Q){const W=Q.response;if(W){const V=W.status,J=W.config.data instanceof ww.Readable;if(!$&&(V===401||V===403)&&!J&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(Z,!0)}throw Q}return Y}async refreshAccessTokenAsync(){const Z=await this.externalAccountAuthorizedUserHandler.refreshToken(this.refreshToken);if(this.cachedAccessToken={access_token:Z.access_token,expiry_date:new Date().getTime()+Z.expires_in*1000,res:Z.res},Z.refresh_token!==void 0)this.refreshToken=Z.refresh_token;return this.cachedAccessToken}isExpired(Z){const $=new Date().getTime();return Z.expiry_date?$>=Z.expiry_date-this.eagerRefreshThresholdMillis:!1}}EW.ExternalAccountAuthorizedUserClient=jW});var vW=O((fW)=>{Object.defineProperty(fW,"__esModule",{value:!0});fW.GoogleAuth=fW.CLOUD_SDK_CLIENT_ID=void 0;var Fw=import.meta.require("child_process"),U8=import.meta.require("fs"),q8=$8(),Mw=import.meta.require("os"),GZ=import.meta.require("path"),Gw=j1(),Dw=Q8(),Nw=G6(),Iw=D6(),Rw=N6(),m1=k6(),DZ=y6(),u1=b6(),Lw=FZ(),F8=$1(),NZ=b0(),hW=xW(),IZ=F1();fW.CLOUD_SDK_CLIENT_ID="764086051850-6qr4p6gpi6hn506pt8ejuq83di341hur.apps.googleusercontent.com";var RZ={NO_PROJECT_ID_FOUND:"Unable to detect a Project Id in the current environment. \nTo learn more about authentication and Google APIs, visit: \nhttps://cloud.google.com/docs/authentication/getting-started",NO_CREDENTIALS_FOUND:"Unable to find credentials in current environment. \nTo learn more about authentication and Google APIs, visit: \nhttps://cloud.google.com/docs/authentication/getting-started",NO_UNIVERSE_DOMAIN_FOUND:"Unable to detect a Universe Domain in the current environment.\nTo learn more about Universe Domain retrieval, visit: \nhttps://cloud.google.com/compute/docs/metadata/predefined-metadata-keys"};class LZ{get isGCE(){return this.checkIsGCE}constructor(Z){if(this.checkIsGCE=void 0,this.jsonContent=null,this.cachedCredential=null,this.clientOptions={},Z=Z||{},this._cachedProjectId=Z.projectId||null,this.cachedCredential=Z.authClient||null,this.keyFilename=Z.keyFilename||Z.keyFile,this.scopes=Z.scopes,this.jsonContent=Z.credentials||null,this.clientOptions=Z.clientOptions||{},Z.universeDomain)this.clientOptions.universeDomain=Z.universeDomain}setGapicJWTValues(Z){Z.defaultServicePath=this.defaultServicePath,Z.useJWTAccessWithScope=this.useJWTAccessWithScope,Z.defaultScopes=this.defaultScopes}getProjectId(Z){if(Z)this.getProjectIdAsync().then(($)=>Z(null,$),Z);else return this.getProjectIdAsync()}async getProjectIdOptional(){try{return await this.getProjectId()}catch(Z){if(Z instanceof Error&&Z.message===RZ.NO_PROJECT_ID_FOUND)return null;else throw Z}}async findAndCacheProjectId(){let Z=null;if(Z||(Z=await this.getProductionProjectId()),Z||(Z=await this.getFileProjectId()),Z||(Z=await this.getDefaultServiceProjectId()),Z||(Z=await this.getGCEProjectId()),Z||(Z=await this.getExternalAccountClientProjectId()),Z)return this._cachedProjectId=Z,Z;else throw new Error(RZ.NO_PROJECT_ID_FOUND)}async getProjectIdAsync(){if(this._cachedProjectId)return this._cachedProjectId;if(!this._findProjectIdPromise)this._findProjectIdPromise=this.findAndCacheProjectId();return this._findProjectIdPromise}async getUniverseDomainFromMetadataServer(){var Z;let $;try{$=await q8.universe("universe-domain"),$||($=NZ.DEFAULT_UNIVERSE)}catch(Y){if(Y&&((Z=Y===null||Y===void 0?void 0:Y.response)===null||Z===void 0?void 0:Z.status)===404)$=NZ.DEFAULT_UNIVERSE;else throw Y}return $}async getUniverseDomain(){let Z=IZ.originalOrCamelOptions(this.clientOptions).get("universe_domain");try{Z!==null&&Z!==void 0||(Z=(await this.getClient()).universeDomain)}catch($){Z!==null&&Z!==void 0||(Z=NZ.DEFAULT_UNIVERSE)}return Z}getAnyScopes(){return this.scopes||this.defaultScopes}getApplicationDefault(Z={},$){let Y;if(typeof Z==="function")$=Z;else Y=Z;if($)this.getApplicationDefaultAsync(Y).then((Q)=>$(null,Q.credential,Q.projectId),$);else return this.getApplicationDefaultAsync(Y)}async getApplicationDefaultAsync(Z={}){if(this.cachedCredential)return await this.prepareAndCacheADC(this.cachedCredential);const $=process.env.GOOGLE_CLOUD_QUOTA_PROJECT;let Y;if(Y=await this._tryGetApplicationCredentialsFromEnvironmentVariable(Z),Y){if(Y instanceof m1.JWT)Y.scopes=this.scopes;else if(Y instanceof F8.BaseExternalAccountClient)Y.scopes=this.getAnyScopes();return await this.prepareAndCacheADC(Y,$)}if(Y=await this._tryGetApplicationCredentialsFromWellKnownFile(Z),Y){if(Y instanceof m1.JWT)Y.scopes=this.scopes;else if(Y instanceof F8.BaseExternalAccountClient)Y.scopes=this.getAnyScopes();return await this.prepareAndCacheADC(Y,$)}if(await this._checkIsGCE()){if(!IZ.originalOrCamelOptions(Z).get("universe_domain"))Z.universeDomain=await this.getUniverseDomainFromMetadataServer();return Z.scopes=this.getAnyScopes(),await this.prepareAndCacheADC(new Nw.Compute(Z),$)}throw new Error("Could not load the default credentials. Browse to https://cloud.google.com/docs/authentication/getting-started for more information.")}async prepareAndCacheADC(Z,$){const Y=await this.getProjectIdOptional();if($)Z.quotaProjectId=$;return this.cachedCredential=Z,{credential:Z,projectId:Y}}async _checkIsGCE(){if(this.checkIsGCE===void 0)this.checkIsGCE=q8.getGCPResidency()||await q8.isAvailable();return this.checkIsGCE}async _tryGetApplicationCredentialsFromEnvironmentVariable(Z){const $=process.env.GOOGLE_APPLICATION_CREDENTIALS||process.env.google_application_credentials;if(!$||$.length===0)return null;try{return this._getApplicationCredentialsFromFilePath($,Z)}catch(Y){if(Y instanceof Error)Y.message=`Unable to read the credential file specified by the GOOGLE_APPLICATION_CREDENTIALS environment variable: ${Y.message}`;throw Y}}async _tryGetApplicationCredentialsFromWellKnownFile(Z){let $=null;if(this._isWindows())$=process.env.APPDATA;else $=GZ.join("/home/alex",".config");if($){if($=GZ.join($,"gcloud","application_default_credentials.json"),!U8.existsSync($))$=null}if(!$)return null;return await this._getApplicationCredentialsFromFilePath($,Z)}async _getApplicationCredentialsFromFilePath(Z,$={}){if(!Z||Z.length===0)throw new Error("The file path is invalid.");try{if(Z=U8.realpathSync(Z),!U8.lstatSync(Z).isFile())throw new Error}catch(Q){if(Q instanceof Error)Q.message=`The file at ${Z} does not exist, or it is not a file. ${Q.message}`;throw Q}const Y=U8.createReadStream(Z);return this.fromStream(Y,$)}fromImpersonatedJSON(Z){var $,Y,Q,W,V;if(!Z)throw new Error("Must pass in a JSON object containing an  impersonated refresh token");if(Z.type!==u1.IMPERSONATED_ACCOUNT_TYPE)throw new Error(`The incoming JSON object does not have the "${u1.IMPERSONATED_ACCOUNT_TYPE}" type`);if(!Z.source_credentials)throw new Error("The incoming JSON object does not contain a source_credentials field");if(!Z.service_account_impersonation_url)throw new Error("The incoming JSON object does not contain a service_account_impersonation_url field");const J=new DZ.UserRefreshClient;if(J.fromJSON(Z.source_credentials),(($=Z.service_account_impersonation_url)===null||$===void 0?void 0:$.length)>256)throw new RangeError(`Target principal is too long: ${Z.service_account_impersonation_url}`);const K=(Q=(Y=/(?<target>[^/]+):generateAccessToken$/.exec(Z.service_account_impersonation_url))===null||Y===void 0?void 0:Y.groups)===null||Q===void 0?void 0:Q.target;if(!K)throw new RangeError(`Cannot extract target principal from ${Z.service_account_impersonation_url}`);const w=(W=this.getAnyScopes())!==null&&W!==void 0?W:[];return new u1.Impersonated({...Z,delegates:(V=Z.delegates)!==null&&V!==void 0?V:[],sourceClient:J,targetPrincipal:K,targetScopes:Array.isArray(w)?w:[w]})}fromJSON(Z,$={}){let Y;const Q=IZ.originalOrCamelOptions($).get("universe_domain");if(Z.type===DZ.USER_REFRESH_ACCOUNT_TYPE)Y=new DZ.UserRefreshClient($),Y.fromJSON(Z);else if(Z.type===u1.IMPERSONATED_ACCOUNT_TYPE)Y=this.fromImpersonatedJSON(Z);else if(Z.type===F8.EXTERNAL_ACCOUNT_TYPE)Y=Lw.ExternalAccountClient.fromJSON(Z,$),Y.scopes=this.getAnyScopes();else if(Z.type===hW.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE)Y=new hW.ExternalAccountAuthorizedUserClient(Z,$);else $.scopes=this.scopes,Y=new m1.JWT($),this.setGapicJWTValues(Y),Y.fromJSON(Z);if(Q)Y.universeDomain=Q;return Y}_cacheClientFromJSON(Z,$){const Y=this.fromJSON(Z,$);return this.jsonContent=Z,this.cachedCredential=Y,Y}fromStream(Z,$={},Y){let Q={};if(typeof $==="function")Y=$;else Q=$;if(Y)this.fromStreamAsync(Z,Q).then((W)=>Y(null,W),Y);else return this.fromStreamAsync(Z,Q)}fromStreamAsync(Z,$){return new Promise((Y,Q)=>{if(!Z)throw new Error("Must pass in a stream containing the Google auth settings.");let W="";Z.setEncoding("utf8").on("error",Q).on("data",(V)=>W+=V).on("end",()=>{try{try{const V=JSON.parse(W),J=this._cacheClientFromJSON(V,$);return Y(J)}catch(V){if(!this.keyFilename)throw V;const J=new m1.JWT({...this.clientOptions,keyFile:this.keyFilename});return this.cachedCredential=J,this.setGapicJWTValues(J),Y(J)}}catch(V){return Q(V)}})})}fromAPIKey(Z,$){$=$||{};const Y=new m1.JWT($);return Y.fromAPIKey(Z),Y}_isWindows(){const Z=Mw.platform();if(Z&&Z.length>=3){if(Z.substring(0,3).toLowerCase()==="win")return!0}return!1}async getDefaultServiceProjectId(){return new Promise((Z)=>{Fw.exec("gcloud config config-helper --format json",($,Y)=>{if(!$&&Y)try{const Q=JSON.parse(Y).configuration.properties.core.project;Z(Q);return}catch(Q){}Z(null)})})}getProductionProjectId(){return process.env.GCLOUD_PROJECT||process.env.GOOGLE_CLOUD_PROJECT||process.env.gcloud_project||process.env.google_cloud_project}async getFileProjectId(){if(this.cachedCredential)return this.cachedCredential.projectId;if(this.keyFilename){const $=await this.getClient();if($&&$.projectId)return $.projectId}const Z=await this._tryGetApplicationCredentialsFromEnvironmentVariable();if(Z)return Z.projectId;else return null}async getExternalAccountClientProjectId(){if(!this.jsonContent||this.jsonContent.type!==F8.EXTERNAL_ACCOUNT_TYPE)return null;return await(await this.getClient()).getProjectId()}async getGCEProjectId(){try{return await q8.project("project-id")}catch(Z){return null}}getCredentials(Z){if(Z)this.getCredentialsAsync().then(($)=>Z(null,$),Z);else return this.getCredentialsAsync()}async getCredentialsAsync(){const Z=await this.getClient();if(Z instanceof u1.Impersonated)return{client_email:Z.getTargetPrincipal()};if(Z instanceof F8.BaseExternalAccountClient){const $=Z.getServiceAccountEmail();if($)return{client_email:$,universe_domain:Z.universeDomain}}if(this.jsonContent)return{client_email:this.jsonContent.client_email,private_key:this.jsonContent.private_key,universe_domain:this.jsonContent.universe_domain};if(await this._checkIsGCE()){const[$,Y]=await Promise.all([q8.instance("service-accounts/default/email"),this.getUniverseDomain()]);return{client_email:$,universe_domain:Y}}throw new Error(RZ.NO_CREDENTIALS_FOUND)}async getClient(){if(!this.cachedCredential)if(this.jsonContent)this._cacheClientFromJSON(this.jsonContent,this.clientOptions);else if(this.keyFilename){const Z=GZ.resolve(this.keyFilename),$=U8.createReadStream(Z);await this.fromStreamAsync($,this.clientOptions)}else await this.getApplicationDefaultAsync(this.clientOptions);return this.cachedCredential}async getIdTokenClient(Z){const $=await this.getClient();if(!("fetchIdToken"in $))throw new Error("Cannot fetch ID token in this environment, use GCE or set the GOOGLE_APPLICATION_CREDENTIALS environment variable to a service account credentials JSON file.");return new Iw.IdTokenClient({targetAudience:Z,idTokenProvider:$})}async getAccessToken(){return(await(await this.getClient()).getAccessToken()).token}async getRequestHeaders(Z){return(await this.getClient()).getRequestHeaders(Z)}async authorizeRequest(Z){Z=Z||{};const $=Z.url||Z.uri,Q=await(await this.getClient()).getRequestHeaders($);return Z.headers=Object.assign(Z.headers||{},Q),Z}async request(Z){return(await this.getClient()).request(Z)}getEnv(){return Rw.getEnv()}async sign(Z,$){const Y=await this.getClient(),Q=await this.getUniverseDomain();if($=$||`https://iamcredentials.${Q}/v1/projects/-/serviceAccounts/`,Y instanceof u1.Impersonated)return(await Y.sign(Z)).signedBlob;const W=Gw.createCrypto();if(Y instanceof m1.JWT&&Y.key)return await W.sign(Y.key,Z);const V=await this.getCredentials();if(!V.client_email)throw new Error("Cannot sign data without `client_email`.");return this.signBlob(W,V.client_email,Z,$)}async signBlob(Z,$,Y,Q){const W=new URL(Q+`${$}:signBlob`);return(await this.request({method:"POST",url:W.href,data:{payload:Z.encodeBase64StringUtf8(Y)},retry:!0,retryConfig:{httpMethodsToRetry:["POST"]}})).data.signedBlob}}fW.GoogleAuth=LZ;LZ.DefaultTransporter=Dw.DefaultTransporter});var mW=O((bW)=>{Object.defineProperty(bW,"__esModule",{value:!0});bW.IAMAuth=void 0;class yW{constructor(Z,$){this.selector=Z,this.token=$,this.selector=Z,this.token=$}getRequestHeaders(){return{"x-goog-iam-authority-selector":this.selector,"x-goog-iam-authorization-token":this.token}}}bW.IAMAuth=yW});var cW=O((dW)=>{Object.defineProperty(dW,"__esModule",{value:!0});dW.DownscopedClient=dW.EXPIRATION_TIME_OFFSET=dW.MAX_ACCESS_BOUNDARY_RULES_COUNT=void 0;var Tw=import.meta.require("stream"),Ow=b0(),Sw=u6(),Pw="urn:ietf:params:oauth:grant-type:token-exchange",Bw="urn:ietf:params:oauth:token-type:access_token",Aw="urn:ietf:params:oauth:token-type:access_token";dW.MAX_ACCESS_BOUNDARY_RULES_COUNT=10;dW.EXPIRATION_TIME_OFFSET=300000;class uW extends Ow.AuthClient{constructor(Z,$,Y,Q){super({...Y,quotaProjectId:Q});if(this.authClient=Z,this.credentialAccessBoundary=$,$.accessBoundary.accessBoundaryRules.length===0)throw new Error("At least one access boundary rule needs to be defined.");else if($.accessBoundary.accessBoundaryRules.length>dW.MAX_ACCESS_BOUNDARY_RULES_COUNT)throw new Error(`The provided access boundary has more than ${dW.MAX_ACCESS_BOUNDARY_RULES_COUNT} access boundary rules.`);for(let W of $.accessBoundary.accessBoundaryRules)if(W.availablePermissions.length===0)throw new Error("At least one permission should be defined in access boundary rules.");this.stsCredential=new Sw.StsCredentials(`https://sts.${this.universeDomain}/v1/token`),this.cachedDownscopedAccessToken=null}setCredentials(Z){if(!Z.expiry_date)throw new Error("The access token expiry_date field is missing in the provided credentials.");super.setCredentials(Z),this.cachedDownscopedAccessToken=Z}async getAccessToken(){if(!this.cachedDownscopedAccessToken||this.isExpired(this.cachedDownscopedAccessToken))await this.refreshAccessTokenAsync();return{token:this.cachedDownscopedAccessToken.access_token,expirationTime:this.cachedDownscopedAccessToken.expiry_date,res:this.cachedDownscopedAccessToken.res}}async getRequestHeaders(){const $={Authorization:`Bearer ${(await this.getAccessToken()).token}`};return this.addSharedMetadataHeaders($)}request(Z,$){if($)this.requestAsync(Z).then((Y)=>$(null,Y),(Y)=>{return $(Y,Y.response)});else return this.requestAsync(Z)}async requestAsync(Z,$=!1){let Y;try{const Q=await this.getRequestHeaders();if(Z.headers=Z.headers||{},Q&&Q["x-goog-user-project"])Z.headers["x-goog-user-project"]=Q["x-goog-user-project"];if(Q&&Q.Authorization)Z.headers.Authorization=Q.Authorization;Y=await this.transporter.request(Z)}catch(Q){const W=Q.response;if(W){const V=W.status,J=W.config.data instanceof Tw.Readable;if(!$&&(V===401||V===403)&&!J&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(Z,!0)}throw Q}return Y}async refreshAccessTokenAsync(){var Z;const $=(await this.authClient.getAccessToken()).token,Y={grantType:Pw,requestedTokenType:Bw,subjectToken:$,subjectTokenType:Aw},Q=await this.stsCredential.exchangeToken(Y,void 0,this.credentialAccessBoundary),W=((Z=this.authClient.credentials)===null||Z===void 0?void 0:Z.expiry_date)||null,V=Q.expires_in?new Date().getTime()+Q.expires_in*1000:W;return this.cachedDownscopedAccessToken={access_token:Q.access_token,expiry_date:V,res:Q.res},this.credentials={},Object.assign(this.credentials,this.cachedDownscopedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedDownscopedAccessToken.expiry_date,access_token:this.cachedDownscopedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedDownscopedAccessToken}isExpired(Z){const $=new Date().getTime();return Z.expiry_date?$>=Z.expiry_date-this.eagerRefreshThresholdMillis:!1}}dW.DownscopedClient=uW});var nW=O((pW)=>{Object.defineProperty(pW,"__esModule",{value:!0});pW.PassThroughClient=void 0;var Ew=b0();class TZ extends Ew.AuthClient{async request(Z){return this.transporter.request(Z)}async getAccessToken(){return{}}async getRequestHeaders(){return{}}}pW.PassThroughClient=TZ;var _w=new TZ;_w.getAccessToken()});var tW=O((i)=>{Object.defineProperty(i,"__esModule",{value:!0});i.GoogleAuth=i.auth=i.DefaultTransporter=i.PassThroughClient=i.ExecutableError=i.PluggableAuthClient=i.DownscopedClient=i.BaseExternalAccountClient=i.ExternalAccountClient=i.IdentityPoolClient=i.AwsRequestSigner=i.AwsClient=i.UserRefreshClient=i.LoginTicket=i.ClientAuthentication=i.OAuth2Client=i.CodeChallengeMethod=i.Impersonated=i.JWT=i.JWTAccess=i.IdTokenClient=i.IAMAuth=i.GCPEnv=i.Compute=i.DEFAULT_UNIVERSE=i.AuthClient=i.gaxios=i.gcpMetadata=void 0;var aW=vW();Object.defineProperty(i,"GoogleAuth",{enumerable:!0,get:function(){return aW.GoogleAuth}});i.gcpMetadata=$8();i.gaxios=P0();var oW=b0();Object.defineProperty(i,"AuthClient",{enumerable:!0,get:function(){return oW.AuthClient}});Object.defineProperty(i,"DEFAULT_UNIVERSE",{enumerable:!0,get:function(){return oW.DEFAULT_UNIVERSE}});var xw=G6();Object.defineProperty(i,"Compute",{enumerable:!0,get:function(){return xw.Compute}});var hw=N6();Object.defineProperty(i,"GCPEnv",{enumerable:!0,get:function(){return hw.GCPEnv}});var fw=mW();Object.defineProperty(i,"IAMAuth",{enumerable:!0,get:function(){return fw.IAMAuth}});var kw=D6();Object.defineProperty(i,"IdTokenClient",{enumerable:!0,get:function(){return kw.IdTokenClient}});var vw=h6();Object.defineProperty(i,"JWTAccess",{enumerable:!0,get:function(){return vw.JWTAccess}});var yw=k6();Object.defineProperty(i,"JWT",{enumerable:!0,get:function(){return yw.JWT}});var bw=b6();Object.defineProperty(i,"Impersonated",{enumerable:!0,get:function(){return bw.Impersonated}});var OZ=M1();Object.defineProperty(i,"CodeChallengeMethod",{enumerable:!0,get:function(){return OZ.CodeChallengeMethod}});Object.defineProperty(i,"OAuth2Client",{enumerable:!0,get:function(){return OZ.OAuth2Client}});Object.defineProperty(i,"ClientAuthentication",{enumerable:!0,get:function(){return OZ.ClientAuthentication}});var gw=q6();Object.defineProperty(i,"LoginTicket",{enumerable:!0,get:function(){return gw.LoginTicket}});var mw=y6();Object.defineProperty(i,"UserRefreshClient",{enumerable:!0,get:function(){return mw.UserRefreshClient}});var uw=YZ();Object.defineProperty(i,"AwsClient",{enumerable:!0,get:function(){return uw.AwsClient}});var dw=e6();Object.defineProperty(i,"AwsRequestSigner",{enumerable:!0,get:function(){return dw.AwsRequestSigner}});var lw=s6();Object.defineProperty(i,"IdentityPoolClient",{enumerable:!0,get:function(){return lw.IdentityPoolClient}});var cw=FZ();Object.defineProperty(i,"ExternalAccountClient",{enumerable:!0,get:function(){return cw.ExternalAccountClient}});var pw=$1();Object.defineProperty(i,"BaseExternalAccountClient",{enumerable:!0,get:function(){return pw.BaseExternalAccountClient}});var iw=cW();Object.defineProperty(i,"DownscopedClient",{enumerable:!0,get:function(){return iw.DownscopedClient}});var rW=z4();Object.defineProperty(i,"PluggableAuthClient",{enumerable:!0,get:function(){return rW.PluggableAuthClient}});Object.defineProperty(i,"ExecutableError",{enumerable:!0,get:function(){return rW.ExecutableError}});var nw=nW();Object.defineProperty(i,"PassThroughClient",{enumerable:!0,get:function(){return nw.PassThroughClient}});var aw=Q8();Object.defineProperty(i,"DefaultTransporter",{enumerable:!0,get:function(){return aw.DefaultTransporter}});var ow=new aW.GoogleAuth;i.auth=ow});var V1="0.25.0";function kZ(Z,$={auto:!1}){if(jZ)throw new Error(`you must \`import '@anthropic-ai/sdk/shims/${Z.kind}'\` before importing anything else from @anthropic-ai/sdk`);if(J1)throw new Error(`can't \`import '@anthropic-ai/sdk/shims/${Z.kind}'\` after \`import '@anthropic-ai/sdk/shims/${J1}'\``);jZ=$.auto,J1=Z.kind,D4=Z.fetch,JV=Z.Request,XV=Z.Response,KV=Z.Headers,EZ=Z.FormData,zV=Z.Blob,_Z=Z.File,N4=Z.ReadableStream,xZ=Z.getMultipartRequestOptions,I4=Z.getDefaultAgent,hZ=Z.fileFromPath,fZ=Z.isFsReadStream}var jZ=!1,J1=void 0,D4=void 0,JV=void 0,XV=void 0,KV=void 0,EZ=void 0,zV=void 0,_Z=void 0,N4=void 0,xZ=void 0,I4=void 0,hZ=void 0,fZ=void 0;class R4{constructor(Z){this.body=Z}get[Symbol.toStringTag](){return"MultipartBody"}}function vZ({manuallyImported:Z}={}){const $=Z?"You may need to use polyfills":`Add one of these imports before your first \`import \u2026 from '@anthropic-ai/sdk'\`:
- \`import '@anthropic-ai/sdk/shims/node'\` (if you're running on Node)
- \`import '@anthropic-ai/sdk/shims/web'\` (otherwise)
`;let Y,Q,W,V;try{Y=fetch,Q=Request,W=Response,V=Headers}catch(J){throw new Error(`this environment is missing the following Web Fetch API type: ${J.message}. ${$}`)}return{kind:"web",fetch:Y,Request:Q,Response:W,Headers:V,FormData:typeof FormData!=="undefined"?FormData:class J{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${$}`)}},Blob:typeof Blob!=="undefined"?Blob:class J{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${$}`)}},File:typeof File!=="undefined"?File:class J{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${$}`)}},ReadableStream:typeof ReadableStream!=="undefined"?ReadableStream:class J{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${$}`)}},getMultipartRequestOptions:async(J,K)=>({...K,body:new R4(J)}),getDefaultAgent:(J)=>{return},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/anthropics/anthropic-sdk-typescript#file-uploads")},isFsReadStream:(J)=>!1}}import{ReadStream as HV}from"fs";function yZ(){const Z=vZ();function $(Y){return Y instanceof HV}return{...Z,isFsReadStream:$}}if(!J1)kZ(yZ(),{auto:!0});class o extends Error{}class Q0 extends o{constructor(Z,$,Y,Q){super(`${Q0.makeMessage(Z,$,Y)}`);this.status=Z,this.headers=Q,this.request_id=Q?.["request-id"],this.error=$}static makeMessage(Z,$,Y){const Q=$?.message?typeof $.message==="string"?$.message:JSON.stringify($.message):$?JSON.stringify($):Y;if(Z&&Q)return`${Z} ${Q}`;if(Z)return`${Z} status code (no body)`;if(Q)return Q;return"(no status code or body)"}static generate(Z,$,Y,Q){if(!Z)return new p1({cause:G8($)});const W=$;if(Z===400)return new bZ(Z,W,Y,Q);if(Z===401)return new gZ(Z,W,Y,Q);if(Z===403)return new mZ(Z,W,Y,Q);if(Z===404)return new uZ(Z,W,Y,Q);if(Z===409)return new dZ(Z,W,Y,Q);if(Z===422)return new lZ(Z,W,Y,Q);if(Z===429)return new cZ(Z,W,Y,Q);if(Z>=500)return new pZ(Z,W,Y,Q);return new Q0(Z,W,Y,Q)}}class l0 extends Q0{constructor({message:Z}={}){super(void 0,void 0,Z||"Request was aborted.",void 0);this.status=void 0}}class p1 extends Q0{constructor({message:Z,cause:$}){super(void 0,void 0,Z||"Connection error.",void 0);if(this.status=void 0,$)this.cause=$}}class L4 extends p1{constructor({message:Z}={}){super({message:Z??"Request timed out."})}}class bZ extends Q0{constructor(){super(...arguments);this.status=400}}class gZ extends Q0{constructor(){super(...arguments);this.status=401}}class mZ extends Q0{constructor(){super(...arguments);this.status=403}}class uZ extends Q0{constructor(){super(...arguments);this.status=404}}class dZ extends Q0{constructor(){super(...arguments);this.status=409}}class lZ extends Q0{constructor(){super(...arguments);this.status=422}}class cZ extends Q0{constructor(){super(...arguments);this.status=429}}class pZ extends Q0{}async function*UV(Z,$){if(!Z.body)throw $.abort(),new o("Attempted to iterate over a response with no body");const Y=new iZ,Q=new X1,W=nZ(Z.body);for await(let V of qV(W))for(let J of Q.decode(V)){const K=Y.decode(J);if(K)yield K}for(let V of Q.flush()){const J=Y.decode(V);if(J)yield J}}async function*qV(Z){let $=new Uint8Array;for await(let Y of Z){if(Y==null)continue;const Q=Y instanceof ArrayBuffer?new Uint8Array(Y):typeof Y==="string"?new TextEncoder().encode(Y):Y;let W=new Uint8Array($.length+Q.length);W.set($),W.set(Q,$.length),$=W;let V;while((V=FV($))!==-1)yield $.slice(0,V),$=$.slice(V)}if($.length>0)yield $}function FV(Z){for(let Q=0;Q<Z.length-2;Q++){if(Z[Q]===10&&Z[Q+1]===10)return Q+2;if(Z[Q]===13&&Z[Q+1]===13)return Q+2;if(Z[Q]===13&&Z[Q+1]===10&&Q+3<Z.length&&Z[Q+2]===13&&Z[Q+3]===10)return Q+4}return-1}function MV(Z,$){const Y=Z.indexOf($);if(Y!==-1)return[Z.substring(0,Y),$,Z.substring(Y+$.length)];return[Z,"",""]}function nZ(Z){if(Z[Symbol.asyncIterator])return Z;const $=Z.getReader();return{async next(){try{const Y=await $.read();if(Y?.done)$.releaseLock();return Y}catch(Y){throw $.releaseLock(),Y}},async return(){const Y=$.cancel();return $.releaseLock(),await Y,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class h0{constructor(Z,$){this.iterator=Z,this.controller=$}static fromSSEResponse(Z,$){let Y=!1;async function*Q(){if(Y)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");Y=!0;let W=!1;try{for await(let V of UV(Z,$)){if(V.event==="completion")try{yield JSON.parse(V.data)}catch(J){throw console.error("Could not parse message into JSON:",V.data),console.error("From chunk:",V.raw),J}if(V.event==="message_start"||V.event==="message_delta"||V.event==="message_stop"||V.event==="content_block_start"||V.event==="content_block_delta"||V.event==="content_block_stop")try{yield JSON.parse(V.data)}catch(J){throw console.error("Could not parse message into JSON:",V.data),console.error("From chunk:",V.raw),J}if(V.event==="ping")continue;if(V.event==="error"){const J=V.data,K=T4(J),w=K?void 0:J;throw Q0.generate(void 0,K,w,C4(Z.headers))}}W=!0}catch(V){if(V instanceof Error&&V.name==="AbortError")return;throw V}finally{if(!W)$.abort()}}return new h0(Q,$)}static fromReadableStream(Z,$){let Y=!1;async function*Q(){const V=new X1,J=nZ(Z);for await(let K of J)for(let w of V.decode(K))yield w;for(let K of V.flush())yield K}async function*W(){if(Y)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");Y=!0;let V=!1;try{for await(let J of Q()){if(V)continue;if(J)yield JSON.parse(J)}V=!0}catch(J){if(J instanceof Error&&J.name==="AbortError")return;throw J}finally{if(!V)$.abort()}}return new h0(W,$)}[Symbol.asyncIterator](){return this.iterator()}tee(){const Z=[],$=[],Y=this.iterator(),Q=(W)=>{return{next:()=>{if(W.length===0){const V=Y.next();Z.push(V),$.push(V)}return W.shift()}}};return[new h0(()=>Q(Z),this.controller),new h0(()=>Q($),this.controller)]}toReadableStream(){const Z=this;let $;const Y=new TextEncoder;return new N4({async start(){$=Z[Symbol.asyncIterator]()},async pull(Q){try{const{value:W,done:V}=await $.next();if(V)return Q.close();const J=Y.encode(JSON.stringify(W)+"\n");Q.enqueue(J)}catch(W){Q.error(W)}},async cancel(){await $.return?.()}})}}class iZ{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(Z){if(Z.endsWith("\r"))Z=Z.substring(0,Z.length-1);if(!Z){if(!this.event&&!this.data.length)return null;const W={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],W}if(this.chunks.push(Z),Z.startsWith(":"))return null;let[$,Y,Q]=MV(Z,":");if(Q.startsWith(" "))Q=Q.substring(1);if($==="event")this.event=Q;else if($==="data")this.data.push(Q);return null}}class X1{constructor(){this.buffer=[],this.trailingCR=!1}decode(Z){let $=this.decodeText(Z);if(this.trailingCR)$="\r"+$,this.trailingCR=!1;if($.endsWith("\r"))this.trailingCR=!0,$=$.slice(0,-1);if(!$)return[];const Y=X1.NEWLINE_CHARS.has($[$.length-1]||"");let Q=$.split(X1.NEWLINE_REGEXP);if(Y)Q.pop();if(Q.length===1&&!Y)return this.buffer.push(Q[0]),[];if(this.buffer.length>0)Q=[this.buffer.join("")+Q[0],...Q.slice(1)],this.buffer=[];if(!Y)this.buffer=[Q.pop()||""];return Q}decodeText(Z){if(Z==null)return"";if(typeof Z==="string")return Z;if(typeof Buffer!=="undefined"){if(Z instanceof Buffer)return Z.toString();if(Z instanceof Uint8Array)return Buffer.from(Z).toString();throw new o(`Unexpected: received non-Uint8Array (${Z.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder!=="undefined"){if(Z instanceof Uint8Array||Z instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(Z);throw new o(`Unexpected: received non-Uint8Array/ArrayBuffer (${Z.constructor.name}) in a web platform. Please report this error.`)}throw new o("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const Z=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,Z}}X1.NEWLINE_CHARS=new Set(["\n","\r"]);X1.NEWLINE_REGEXP=/\r\n|[\n\r]/g;var aZ=(Z)=>Z!=null&&typeof Z==="object"&&typeof Z.size==="number"&&typeof Z.type==="string"&&typeof Z.text==="function"&&typeof Z.slice==="function"&&typeof Z.arrayBuffer==="function";var O4=(Z)=>Z&&typeof Z==="object"&&Z.body&&Z[Symbol.toStringTag]==="MultipartBody";async function eZ(Z){const{response:$}=Z;if(Z.options.stream){if(I1("response",$.status,$.url,$.headers,$.body),Z.options.__streamClass)return Z.options.__streamClass.fromSSEResponse($,Z.controller);return h0.fromSSEResponse($,Z.controller)}if($.status===204)return null;if(Z.options.__binaryResponse)return $;const Y=$.headers.get("content-type");if(Y?.includes("application/json")||Y?.includes("application/vnd.api+json")){const V=await $.json();return I1("response",$.status,$.url,$.headers,V),V}const W=await $.text();return I1("response",$.status,$.url,$.headers,W),W}function RV(){if(typeof navigator==="undefined"||!navigator)return null;const Z=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(let{key:$,pattern:Y}of Z){const Q=Y.exec(navigator.userAgent);if(Q){const W=Q[1]||0,V=Q[2]||0,J=Q[3]||0;return{browser:$,version:`${W}.${V}.${J}`}}}return null}function SV(Z){if(!Z)return!0;for(let $ in Z)return!1;return!0}function PV(Z,$){return Object.prototype.hasOwnProperty.call(Z,$)}function sZ(Z,$){for(let Y in $){if(!PV($,Y))continue;const Q=Y.toLowerCase();if(!Q)continue;const W=$[Y];if(W===null)delete Z[Q];else if(W!==void 0)Z[Q]=W}}function I1(Z,...$){if(typeof process!=="undefined"&&process?.env?.DEBUG==="true")console.log(`Anthropic:DEBUG:${Z}`,...$)}function B4(Z){return Z!=null&&typeof Z==="object"&&!Array.isArray(Z)}var GV=function(Z,$,Y,Q,W){if(Q==="m")throw new TypeError("Private method is not writable");if(Q==="a"&&!W)throw new TypeError("Private accessor was defined without a setter");if(typeof $==="function"?Z!==$||!W:!$.has(Z))throw new TypeError("Cannot write private member to an object whose class did not declare it");return Q==="a"?W.call(Z,Y):W?W.value=Y:$.set(Z,Y),Y},DV=function(Z,$,Y,Q){if(Y==="a"&&!Q)throw new TypeError("Private accessor was defined without a getter");if(typeof $==="function"?Z!==$||!Q:!$.has(Z))throw new TypeError("Cannot read private member from an object whose class did not declare it");return Y==="m"?Q:Y==="a"?Q.call(Z):Q?Q.value:$.get(Z)},D8;class N8 extends Promise{constructor(Z,$=eZ){super((Y)=>{Y(null)});this.responsePromise=Z,this.parseResponse=$}_thenUnwrap(Z){return new N8(this.responsePromise,async($)=>Z(await this.parseResponse($)))}asResponse(){return this.responsePromise.then((Z)=>Z.response)}async withResponse(){const[Z,$]=await Promise.all([this.parse(),this.asResponse()]);return{data:Z,response:$}}parse(){if(!this.parsedPromise)this.parsedPromise=this.responsePromise.then(this.parseResponse);return this.parsedPromise}then(Z,$){return this.parse().then(Z,$)}catch(Z){return this.parse().catch(Z)}finally(Z){return this.parse().finally(Z)}}class P4{constructor({baseURL:Z,maxRetries:$=2,timeout:Y=600000,httpAgent:Q,fetch:W}){this.baseURL=Z,this.maxRetries=S4("maxRetries",$),this.timeout=S4("timeout",Y),this.httpAgent=Q,this.fetch=W??D4}authHeaders(Z){return{}}defaultHeaders(Z){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...LV(),...this.authHeaders(Z)}}validateHeaders(Z,$){}defaultIdempotencyKey(){return`stainless-node-retry-${BV()}`}get(Z,$){return this.methodRequest("get",Z,$)}post(Z,$){return this.methodRequest("post",Z,$)}patch(Z,$){return this.methodRequest("patch",Z,$)}put(Z,$){return this.methodRequest("put",Z,$)}delete(Z,$){return this.methodRequest("delete",Z,$)}methodRequest(Z,$,Y){return this.request(Promise.resolve(Y).then(async(Q)=>{const W=Q&&aZ(Q?.body)?new DataView(await Q.body.arrayBuffer()):Q?.body instanceof DataView?Q.body:Q?.body instanceof ArrayBuffer?new DataView(Q.body):Q&&ArrayBuffer.isView(Q?.body)?new DataView(Q.body.buffer):Q?.body;return{method:Z,path:$,...Q,body:W}}))}getAPIList(Z,$,Y){return this.requestAPIList($,{method:"get",path:Z,...Y})}calculateContentLength(Z){if(typeof Z==="string"){if(typeof Buffer!=="undefined")return Buffer.byteLength(Z,"utf8").toString();if(typeof TextEncoder!=="undefined")return new TextEncoder().encode(Z).length.toString()}else if(ArrayBuffer.isView(Z))return Z.byteLength.toString();return null}buildRequest(Z){const{method:$,path:Y,query:Q,headers:W={}}=Z,V=ArrayBuffer.isView(Z.body)||Z.__binaryRequest&&typeof Z.body==="string"?Z.body:O4(Z.body)?Z.body.body:Z.body?JSON.stringify(Z.body,null,2):null,J=this.calculateContentLength(V),K=this.buildURL(Y,Q);if("timeout"in Z)S4("timeout",Z.timeout);const w=Z.timeout??this.timeout,L=Z.httpAgent??this.httpAgent??I4(K),F=w+1000;if(typeof L?.options?.timeout==="number"&&F>(L.options.timeout??0))L.options.timeout=F;if(this.idempotencyHeader&&$!=="get"){if(!Z.idempotencyKey)Z.idempotencyKey=this.defaultIdempotencyKey();W[this.idempotencyHeader]=Z.idempotencyKey}const C=this.buildHeaders({options:Z,headers:W,contentLength:J});return{req:{method:$,...V&&{body:V},headers:C,...L&&{agent:L},signal:Z.signal??null},url:K,timeout:w}}buildHeaders({options:Z,headers:$,contentLength:Y}){const Q={};if(Y)Q["content-length"]=Y;const W=this.defaultHeaders(Z);if(sZ(Q,W),sZ(Q,$),O4(Z.body)&&J1!=="node")delete Q["content-type"];return this.validateHeaders(Q,$),Q}async prepareOptions(Z){}async prepareRequest(Z,{url:$,options:Y}){}parseHeaders(Z){return!Z?{}:(Symbol.iterator in Z)?Object.fromEntries(Array.from(Z).map(($)=>[...$])):{...Z}}makeStatusError(Z,$,Y,Q){return Q0.generate(Z,$,Y,Q)}request(Z,$=null){return new N8(this.makeRequest(Z,$))}async makeRequest(Z,$){const Y=await Z;if($==null)$=Y.maxRetries??this.maxRetries;await this.prepareOptions(Y);const{req:Q,url:W,timeout:V}=this.buildRequest(Y);if(await this.prepareRequest(Q,{url:W,options:Y}),I1("request",W,Y,Q.headers),Y.signal?.aborted)throw new l0;const J=new AbortController,K=await this.fetchWithTimeout(W,Q,V,J).catch(G8);if(K instanceof Error){if(Y.signal?.aborted)throw new l0;if($)return this.retryRequest(Y,$);if(K.name==="AbortError")throw new L4;throw new p1({cause:K})}const w=C4(K.headers);if(!K.ok){if($&&this.shouldRetry(K)){const y=`retrying, ${$} attempts remaining`;return I1(`response (error; ${y})`,K.status,W,w),this.retryRequest(Y,$,w)}const L=await K.text().catch((y)=>G8(y).message),F=T4(L),C=F?void 0:L;throw I1(`response (error; ${$?"(error; no more retries left)":"(error; not retryable)"})`,K.status,W,w,C),this.makeStatusError(K.status,F,C,w)}return{response:K,options:Y,controller:J}}requestAPIList(Z,$){const Y=this.makeRequest($,null);return new Z$(this,Y,Z)}buildURL(Z,$){const Y=TV(Z)?new URL(Z):new URL(this.baseURL+(this.baseURL.endsWith("/")&&Z.startsWith("/")?Z.slice(1):Z)),Q=this.defaultQuery();if(!SV(Q))$={...Q,...$};if(typeof $==="object"&&$&&!Array.isArray($))Y.search=this.stringifyQuery($);return Y.toString()}stringifyQuery(Z){return Object.entries(Z).filter(([$,Y])=>typeof Y!=="undefined").map(([$,Y])=>{if(typeof Y==="string"||typeof Y==="number"||typeof Y==="boolean")return`${encodeURIComponent($)}=${encodeURIComponent(Y)}`;if(Y===null)return`${encodeURIComponent($)}=`;throw new o(`Cannot stringify type ${typeof Y}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(Z,$,Y,Q){const{signal:W,...V}=$||{};if(W)W.addEventListener("abort",()=>Q.abort());const J=setTimeout(()=>Q.abort(),Y);return this.getRequestClient().fetch.call(void 0,Z,{signal:Q.signal,...V}).finally(()=>{clearTimeout(J)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(Z){const $=Z.headers.get("x-should-retry");if($==="true")return!0;if($==="false")return!1;if(Z.status===408)return!0;if(Z.status===409)return!0;if(Z.status===429)return!0;if(Z.status>=500)return!0;return!1}async retryRequest(Z,$,Y){let Q;const W=Y?.["retry-after-ms"];if(W){const J=parseFloat(W);if(!Number.isNaN(J))Q=J}const V=Y?.["retry-after"];if(V&&!Q){const J=parseFloat(V);if(!Number.isNaN(J))Q=J*1000;else Q=Date.parse(V)-Date.now()}if(!(Q&&0<=Q&&Q<60000)){const J=Z.maxRetries??this.maxRetries;Q=this.calculateDefaultRetryTimeoutMillis($,J)}return await OV(Q),this.makeRequest(Z,$-1)}calculateDefaultRetryTimeoutMillis(Z,$){const W=$-Z,V=Math.min(0.5*Math.pow(2,W),8),J=1-Math.random()*0.25;return V*J*1000}getUserAgent(){return`${this.constructor.name}/JS ${V1}`}}class NV{constructor(Z,$,Y,Q){D8.set(this,void 0),GV(this,D8,Z,"f"),this.options=Q,this.response=$,this.body=Y}hasNextPage(){if(!this.getPaginatedItems().length)return!1;return this.nextPageInfo()!=null}async getNextPage(){const Z=this.nextPageInfo();if(!Z)throw new o("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const $={...this.options};if("params"in Z&&typeof $.query==="object")$.query={...$.query,...Z.params};else if("url"in Z){const Y=[...Object.entries($.query||{}),...Z.url.searchParams.entries()];for(let[Q,W]of Y)Z.url.searchParams.set(Q,W);$.query=void 0,$.path=Z.url.toString()}return await DV(this,D8,"f").requestAPIList(this.constructor,$)}async*iterPages(){let Z=this;yield Z;while(Z.hasNextPage())Z=await Z.getNextPage(),yield Z}async*[(D8=new WeakMap,Symbol.asyncIterator)](){for await(let Z of this.iterPages())for(let $ of Z.getPaginatedItems())yield $}}class Z$ extends N8{constructor(Z,$,Y){super($,async(Q)=>new Y(Z,Q.response,await eZ(Q),Q.options))}async*[Symbol.asyncIterator](){const Z=await this;for await(let $ of Z)yield $}}var C4=(Z)=>{return new Proxy(Object.fromEntries(Z.entries()),{get($,Y){const Q=Y.toString();return $[Q.toLowerCase()]||$[Q]}})};var IV=()=>{if(typeof Deno!=="undefined"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":V1,"X-Stainless-OS":rZ(Deno.build.os),"X-Stainless-Arch":oZ(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version==="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime!=="undefined")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":V1,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process!=="undefined"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":V1,"X-Stainless-OS":rZ(process.platform),"X-Stainless-Arch":oZ(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const Z=RV();if(Z)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":V1,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${Z.browser}`,"X-Stainless-Runtime-Version":Z.version};return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":V1,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}},oZ=(Z)=>{if(Z==="x32")return"x32";if(Z==="x86_64"||Z==="x64")return"x64";if(Z==="arm")return"arm";if(Z==="aarch64"||Z==="arm64")return"arm64";if(Z)return`other:${Z}`;return"unknown"},rZ=(Z)=>{if(Z=Z.toLowerCase(),Z.includes("ios"))return"iOS";if(Z==="android")return"Android";if(Z==="darwin")return"MacOS";if(Z==="win32")return"Windows";if(Z==="freebsd")return"FreeBSD";if(Z==="openbsd")return"OpenBSD";if(Z==="linux")return"Linux";if(Z)return`Other:${Z}`;return"Unknown"},tZ,LV=()=>{return tZ??(tZ=IV())},T4=(Z)=>{try{return JSON.parse(Z)}catch($){return}},CV=new RegExp("^(?:[a-z]+:)?//","i"),TV=(Z)=>{return CV.test(Z)},OV=(Z)=>new Promise(($)=>setTimeout($,Z)),S4=(Z,$)=>{if(typeof $!=="number"||!Number.isInteger($))throw new o(`${Z} must be an integer`);if($<0)throw new o(`${Z} must be a positive integer`);return $},G8=(Z)=>{if(Z instanceof Error)return Z;return new Error(Z)};var I8=(Z)=>{if(typeof process!=="undefined")return process.env?.[Z]?.trim()??void 0;if(typeof Deno!=="undefined")return Deno.env?.get?.(Z)?.trim();return};var BV=()=>{return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(Z)=>{const $=Math.random()*16|0;return(Z==="x"?$:$&3|8).toString(16)})};class A4{constructor(Z){this._client=Z}}var jV=(Z)=>{let $=0,Y=[];while($<Z.length){let Q=Z[$];if(Q==="\\"){$++;continue}if(Q==="{"){Y.push({type:"brace",value:"{"}),$++;continue}if(Q==="}"){Y.push({type:"brace",value:"}"}),$++;continue}if(Q==="["){Y.push({type:"paren",value:"["}),$++;continue}if(Q==="]"){Y.push({type:"paren",value:"]"}),$++;continue}if(Q===":"){Y.push({type:"separator",value:":"}),$++;continue}if(Q===","){Y.push({type:"delimiter",value:","}),$++;continue}if(Q==='"'){let K="",w=!1;Q=Z[++$];while(Q!=='"'){if($===Z.length){w=!0;break}if(Q==="\\"){if($++,$===Z.length){w=!0;break}K+=Q+Z[$],Q=Z[++$]}else K+=Q,Q=Z[++$]}if(Q=Z[++$],!w)Y.push({type:"string",value:K});continue}if(Q&&/\s/.test(Q)){$++;continue}let V=/[0-9]/;if(Q&&V.test(Q)||Q==="-"||Q==="."){let K="";if(Q==="-")K+=Q,Q=Z[++$];while(Q&&V.test(Q)||Q===".")K+=Q,Q=Z[++$];Y.push({type:"number",value:K});continue}let J=/[a-z]/i;if(Q&&J.test(Q)){let K="";while(Q&&J.test(Q)){if($===Z.length)break;K+=Q,Q=Z[++$]}if(K=="true"||K=="false"||K==="null")Y.push({type:"name",value:K});else{$++;continue}continue}$++}return Y},R1=(Z)=>{if(Z.length===0)return Z;let $=Z[Z.length-1];switch($.type){case"separator":return Z=Z.slice(0,Z.length-1),R1(Z);break;case"number":let Y=$.value[$.value.length-1];if(Y==="."||Y==="-")return Z=Z.slice(0,Z.length-1),R1(Z);case"string":let Q=Z[Z.length-2];if(Q?.type==="delimiter")return Z=Z.slice(0,Z.length-1),R1(Z);else if(Q?.type==="brace"&&Q.value==="{")return Z=Z.slice(0,Z.length-1),R1(Z);break;case"delimiter":return Z=Z.slice(0,Z.length-1),R1(Z);break}return Z},EV=(Z)=>{let $=[];if(Z.map((Y)=>{if(Y.type==="brace")if(Y.value==="{")$.push("}");else $.splice($.lastIndexOf("}"),1);if(Y.type==="paren")if(Y.value==="[")$.push("]");else $.splice($.lastIndexOf("]"),1)}),$.length>0)$.reverse().map((Y)=>{if(Y==="}")Z.push({type:"brace",value:"}"});else if(Y==="]")Z.push({type:"paren",value:"]"})});return Z},_V=(Z)=>{let $="";return Z.map((Y)=>{switch(Y.type){case"string":$+='"'+Y.value+'"';break;default:$+=Y.value;break}}),$},$$=(Z)=>JSON.parse(_V(EV(R1(jV(Z)))));var U0=function(Z,$,Y,Q,W){if(Q==="m")throw new TypeError("Private method is not writable");if(Q==="a"&&!W)throw new TypeError("Private accessor was defined without a setter");if(typeof $==="function"?Z!==$||!W:!$.has(Z))throw new TypeError("Cannot write private member to an object whose class did not declare it");return Q==="a"?W.call(Z,Y):W?W.value=Y:$.set(Z,Y),Y},m=function(Z,$,Y,Q){if(Y==="a"&&!Q)throw new TypeError("Private accessor was defined without a getter");if(typeof $==="function"?Z!==$||!Q:!$.has(Z))throw new TypeError("Cannot read private member from an object whose class did not declare it");return Y==="m"?Q:Y==="a"?Q.call(Z):Q?Q.value:$.get(Z)},I0,s0,R8,L8,i1,n1,C8,a1,c0,o1,T8,O8,L1,j4,Y$,E4,_4,x4,h4,Q$,W$="__json_buf";class r1{constructor(){I0.add(this),this.messages=[],this.receivedMessages=[],s0.set(this,void 0),this.controller=new AbortController,R8.set(this,void 0),L8.set(this,()=>{}),i1.set(this,()=>{}),n1.set(this,void 0),C8.set(this,()=>{}),a1.set(this,()=>{}),c0.set(this,{}),o1.set(this,!1),T8.set(this,!1),O8.set(this,!1),L1.set(this,!1),E4.set(this,(Z)=>{if(U0(this,T8,!0,"f"),Z instanceof Error&&Z.name==="AbortError")Z=new l0;if(Z instanceof l0)return U0(this,O8,!0,"f"),this._emit("abort",Z);if(Z instanceof o)return this._emit("error",Z);if(Z instanceof Error){const $=new o(Z.message);return $.cause=Z,this._emit("error",$)}return this._emit("error",new o(String(Z)))}),U0(this,R8,new Promise((Z,$)=>{U0(this,L8,Z,"f"),U0(this,i1,$,"f")}),"f"),U0(this,n1,new Promise((Z,$)=>{U0(this,C8,Z,"f"),U0(this,a1,$,"f")}),"f"),m(this,R8,"f").catch(()=>{}),m(this,n1,"f").catch(()=>{})}static fromReadableStream(Z){const $=new r1;return $._run(()=>$._fromReadableStream(Z)),$}static createMessage(Z,$,Y){const Q=new r1;for(let W of $.messages)Q._addMessageParam(W);return Q._run(()=>Q._createMessage(Z,{...$,stream:!0},{...Y,headers:{...Y?.headers,"X-Stainless-Helper-Method":"stream"}})),Q}_run(Z){Z().then(()=>{this._emitFinal(),this._emit("end")},m(this,E4,"f"))}_addMessageParam(Z){this.messages.push(Z)}_addMessage(Z,$=!0){if(this.receivedMessages.push(Z),$)this._emit("message",Z)}async _createMessage(Z,$,Y){const Q=Y?.signal;if(Q){if(Q.aborted)this.controller.abort();Q.addEventListener("abort",()=>this.controller.abort())}m(this,I0,"m",_4).call(this);const W=await Z.create({...$,stream:!0},{...Y,signal:this.controller.signal});this._connected();for await(let V of W)m(this,I0,"m",x4).call(this,V);if(W.controller.signal?.aborted)throw new l0;m(this,I0,"m",h4).call(this)}_connected(){if(this.ended)return;m(this,L8,"f").call(this),this._emit("connect")}get ended(){return m(this,o1,"f")}get errored(){return m(this,T8,"f")}get aborted(){return m(this,O8,"f")}abort(){this.controller.abort()}on(Z,$){return(m(this,c0,"f")[Z]||(m(this,c0,"f")[Z]=[])).push({listener:$}),this}off(Z,$){const Y=m(this,c0,"f")[Z];if(!Y)return this;const Q=Y.findIndex((W)=>W.listener===$);if(Q>=0)Y.splice(Q,1);return this}once(Z,$){return(m(this,c0,"f")[Z]||(m(this,c0,"f")[Z]=[])).push({listener:$,once:!0}),this}emitted(Z){return new Promise(($,Y)=>{if(U0(this,L1,!0,"f"),Z!=="error")this.once("error",Y);this.once(Z,$)})}async done(){U0(this,L1,!0,"f"),await m(this,n1,"f")}get currentMessage(){return m(this,s0,"f")}async finalMessage(){return await this.done(),m(this,I0,"m",j4).call(this)}async finalText(){return await this.done(),m(this,I0,"m",Y$).call(this)}_emit(Z,...$){if(m(this,o1,"f"))return;if(Z==="end")U0(this,o1,!0,"f"),m(this,C8,"f").call(this);const Y=m(this,c0,"f")[Z];if(Y)m(this,c0,"f")[Z]=Y.filter((Q)=>!Q.once),Y.forEach(({listener:Q})=>Q(...$));if(Z==="abort"){const Q=$[0];if(!m(this,L1,"f")&&!Y?.length)Promise.reject(Q);m(this,i1,"f").call(this,Q),m(this,a1,"f").call(this,Q),this._emit("end");return}if(Z==="error"){const Q=$[0];if(!m(this,L1,"f")&&!Y?.length)Promise.reject(Q);m(this,i1,"f").call(this,Q),m(this,a1,"f").call(this,Q),this._emit("end")}}_emitFinal(){if(this.receivedMessages.at(-1))this._emit("finalMessage",m(this,I0,"m",j4).call(this))}async _fromReadableStream(Z,$){const Y=$?.signal;if(Y){if(Y.aborted)this.controller.abort();Y.addEventListener("abort",()=>this.controller.abort())}m(this,I0,"m",_4).call(this),this._connected();const Q=h0.fromReadableStream(Z,this.controller);for await(let W of Q)m(this,I0,"m",x4).call(this,W);if(Q.controller.signal?.aborted)throw new l0;m(this,I0,"m",h4).call(this)}[(s0=new WeakMap,R8=new WeakMap,L8=new WeakMap,i1=new WeakMap,n1=new WeakMap,C8=new WeakMap,a1=new WeakMap,c0=new WeakMap,o1=new WeakMap,T8=new WeakMap,O8=new WeakMap,L1=new WeakMap,E4=new WeakMap,I0=new WeakSet,j4=function Z(){if(this.receivedMessages.length===0)throw new o("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},Y$=function Z(){if(this.receivedMessages.length===0)throw new o("stream ended without producing a Message with role=assistant");const $=this.receivedMessages.at(-1).content.filter((Y)=>Y.type==="text").map((Y)=>Y.text);if($.length===0)throw new o("stream ended without producing a content block with type=text");return $.join(" ")},_4=function Z(){if(this.ended)return;U0(this,s0,void 0,"f")},x4=function Z($){if(this.ended)return;const Y=m(this,I0,"m",Q$).call(this,$);switch(this._emit("streamEvent",$,Y),$.type){case"content_block_delta":{const Q=Y.content.at(-1);if($.delta.type==="text_delta"&&Q.type==="text")this._emit("text",$.delta.text,Q.text||"");else if($.delta.type==="input_json_delta"&&Q.type==="tool_use"){if(Q.input)this._emit("inputJson",$.delta.partial_json,Q.input)}break}case"message_stop":{this._addMessageParam(Y),this._addMessage(Y,!0);break}case"content_block_stop":{this._emit("contentBlock",Y.content.at(-1));break}case"message_start":{U0(this,s0,Y,"f");break}case"content_block_start":case"message_delta":break}},h4=function Z(){if(this.ended)throw new o("stream has ended, this shouldn't happen");const $=m(this,s0,"f");if(!$)throw new o("request ended without sending any chunks");return U0(this,s0,void 0,"f"),$},Q$=function Z($){let Y=m(this,s0,"f");if($.type==="message_start"){if(Y)throw new o(`Unexpected event order, got ${$.type} before receiving "message_stop"`);return $.message}if(!Y)throw new o(`Unexpected event order, got ${$.type} before "message_start"`);switch($.type){case"message_stop":return Y;case"message_delta":return Y.stop_reason=$.delta.stop_reason,Y.stop_sequence=$.delta.stop_sequence,Y.usage.output_tokens=$.usage.output_tokens,Y;case"content_block_start":return Y.content.push($.content_block),Y;case"content_block_delta":{const Q=Y.content.at($.index);if(Q?.type==="text"&&$.delta.type==="text_delta")Q.text+=$.delta.text;else if(Q?.type==="tool_use"&&$.delta.type==="input_json_delta"){let W=Q[W$]||"";if(W+=$.delta.partial_json,Object.defineProperty(Q,W$,{value:W,enumerable:!1,writable:!0}),W)Q.input=$$(W)}return Y}case"content_block_stop":return Y}},Symbol.asyncIterator)](){const Z=[],$=[];let Y=!1;return this.on("streamEvent",(Q)=>{const W=$.shift();if(W)W.resolve(Q);else Z.push(Q)}),this.on("end",()=>{Y=!0;for(let Q of $)Q.resolve(void 0);$.length=0}),this.on("abort",(Q)=>{Y=!0;for(let W of $)W.reject(Q);$.length=0}),this.on("error",(Q)=>{Y=!0;for(let W of $)W.reject(Q);$.length=0}),{next:async()=>{if(!Z.length){if(Y)return{value:void 0,done:!0};return new Promise((W,V)=>$.push({resolve:W,reject:V})).then((W)=>W?{value:W,done:!1}:{value:void 0,done:!0})}return{value:Z.shift(),done:!1}},return:async()=>{return this.abort(),{value:void 0,done:!0}}}}toReadableStream(){return new h0(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}class C1 extends A4{create(Z,$){return this._client.post("/v1/messages",{body:Z,timeout:this._client._options.timeout??600000,...$,stream:Z.stream??!1})}stream(Z,$){return r1.createMessage(this,Z,$)}}(function(Z){})(C1||(C1={}));var sW=YV(tW(),1),ZH="vertex-2023-10-16";class w4 extends P4{constructor({baseURL:Z=I8("ANTHROPIC_VERTEX_BASE_URL"),region:$=I8("CLOUD_ML_REGION")??null,projectId:Y=I8("ANTHROPIC_VERTEX_PROJECT_ID")??null,...Q}={}){if(!$)throw new Error("No region was given. The client should be instantiated with the `region` option or the `CLOUD_ML_REGION` environment variable should be set.");const W={...Q,baseURL:Z||`https://${$}-aiplatform.googleapis.com/v1`};super({baseURL:W.baseURL,timeout:W.timeout??600000,httpAgent:W.httpAgent,maxRetries:W.maxRetries,fetch:W.fetch});this.messages=new C1(this),this._options=W,this.region=$,this.projectId=Y,this.accessToken=W.accessToken??null,this._auth=W.googleAuth??new sW.GoogleAuth({scopes:"https://www.googleapis.com/auth/cloud-platform"}),this._authClientPromise=this._auth.getClient()}defaultQuery(){return this._options.defaultQuery}defaultHeaders(Z){return{...super.defaultHeaders(Z),...this._options.defaultHeaders}}async prepareOptions(Z){const $=await this._authClientPromise,Y=await $.getRequestHeaders(),Q=$.projectId??Y["x-goog-user-project"];if(!this.projectId&&Q)this.projectId=Q;Z.headers={...Y,...Z.headers}}buildRequest(Z){if(B4(Z.body)){if(!Z.body.anthropic_version)Z.body.anthropic_version=ZH}if(Z.path==="/v1/messages"&&Z.method==="post"){if(!this.projectId)throw new Error("No projectId was given and it could not be resolved from credentials. The client should be instantiated with the `projectId` option or the `ANTHROPIC_VERTEX_PROJECT_ID` environment variable should be set.");if(!B4(Z.body))throw new Error("Expected request body to be an object for post /v1/messages");const $=Z.body.model;Z.body.model=void 0;const Q=Z.body.stream??!1?"streamRawPredict":"rawPredict";Z.path=`/projects/${this.projectId}/locations/${this.region}/publishers/anthropic/models/${$}:${Q}`}return super.buildRequest(Z)}}async function WH(){const Z=await QH.messages.create({model:"claude-3-5-sonnet@20240620",max_tokens:100,messages:[{role:"user",content:"Hey Claude!"}]});console.log(JSON.stringify(Z,null,2))}var $H="inspired-goal-431506-b4",YH="europe-west1",QH=new w4({projectId:$H,region:YH});WH();
